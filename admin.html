<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… | Xbloom Admin</title>
<link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700;900&display=swap" rel="stylesheet">
<script src="https://cdn.sheetjs.com/xlsx-0.20.1/package/dist/xlsx.full.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
<style>
*{margin:0;padding:0;box-sizing:border-box}
:root{--gr:linear-gradient(135deg,#00A896,#4A90E2);--bg:#0A0A0A;--card:#1A1A1A;--up:#252525;--br:#2A2A2A;--t1:#fff;--t2:#A0A0A0;--ta:#00A896;--red:linear-gradient(135deg,#f093fb,#f5576c);--green:linear-gradient(135deg,#43e97b,#38f9d7);--orange:linear-gradient(135deg,#ffd89b,#ff9a56);--purple:linear-gradient(135deg,#667eea,#764ba2)}
body{font-family:'Cairo',sans-serif;background:var(--bg);color:var(--t1);min-height:100vh}

/* LOGIN */
#loginScreen{display:flex;align-items:center;justify-content:center;min-height:100vh;padding:20px}
.lbox{background:var(--card);border-radius:18px;border:1px solid var(--br);padding:36px;text-align:center;width:100%;max-width:400px;position:relative;overflow:hidden}
.lbox::before{content:'';position:absolute;top:0;left:0;right:0;height:3px;background:var(--gr)}
.lbox h1{font-size:2em;font-weight:900;background:var(--gr);-webkit-background-clip:text;-webkit-text-fill-color:transparent;margin-bottom:4px}
.lbox p{color:var(--t2);font-size:.85em;margin-bottom:24px}
.lerr{color:#f5576c;font-size:.82em;margin-bottom:10px;min-height:18px;font-weight:700}

/* BUTTONS */
.btn{padding:9px 18px;border-radius:10px;border:none;font-size:13px;font-weight:700;cursor:pointer;font-family:inherit;transition:.2s;display:inline-flex;align-items:center;gap:5px;text-decoration:none;white-space:nowrap}
.btn:active{transform:scale(.95)}
.bp{background:var(--gr);color:#fff}
.bp-full{background:var(--gr);color:#fff;width:100%;justify-content:center;padding:14px;font-size:15px}
.bd{background:var(--red);color:#fff}
.bg{background:var(--green);color:#000}
.bw{background:var(--orange);color:#000}
.bpu{background:var(--purple);color:#fff}
.bsm{padding:7px 12px;font-size:12px}
.bbl{width:100%;justify-content:center}
.bgray{background:var(--up);border:1px solid var(--br);color:var(--t2)}
.btn:disabled{opacity:.5;cursor:not-allowed}

/* ADMIN */
#adminPanel{display:none;min-height:100vh;padding:16px}
.apwrap{max-width:1300px;margin:0 auto}
.aheader{background:var(--card);border-radius:14px;border:1px solid var(--br);padding:16px 22px;margin-bottom:16px;display:flex;align-items:center;justify-content:space-between;gap:12px;flex-wrap:wrap;position:relative;overflow:hidden}
.aheader::before{content:'';position:absolute;top:0;left:0;right:0;height:3px;background:var(--gr)}
.aheader h1{font-size:1.2em;font-weight:900;background:var(--gr);-webkit-background-clip:text;-webkit-text-fill-color:transparent}
.fb-dot{width:9px;height:9px;border-radius:50%;background:#555;display:inline-block;margin-left:6px}
.fb-dot.ok{background:#43e97b;box-shadow:0 0 8px #43e97b}
.fb-dot.err{background:#f5576c}
.fb-dot.loading{background:#ffd700;animation:pulse 1s infinite}
@keyframes pulse{0%,100%{opacity:1}50%{opacity:.3}}
.fb-lbl{font-size:.78em;color:var(--t2)}

/* TABS */
.atabs{display:flex;gap:5px;flex-wrap:wrap;margin-bottom:16px;background:var(--card);padding:10px;border-radius:12px;border:1px solid var(--br)}
.atb{padding:9px 14px;border-radius:8px;background:transparent;border:none;color:var(--t2);font-size:12px;font-weight:700;cursor:pointer;font-family:inherit;transition:.2s;position:relative}
.atb.on{background:var(--gr);color:#fff}
.atb:hover:not(.on){background:var(--up);color:var(--t1)}
.badge-tab{position:absolute;top:-4px;right:-4px;background:#f5576c;color:#fff;border-radius:50%;width:16px;height:16px;font-size:9px;display:flex;align-items:center;justify-content:center;display:none}
.badge-tab.show{display:flex}
.acard{background:var(--card);border-radius:12px;border:1px solid var(--br);padding:20px;margin-bottom:14px;display:none}
.acard.open{display:block;animation:slideIn .25s ease}
@keyframes slideIn{from{opacity:0;transform:translateY(8px)}to{opacity:1;transform:translateY(0)}}

/* STATS */
.sg{display:grid;grid-template-columns:repeat(auto-fill,minmax(120px,1fr));gap:10px;margin-bottom:16px}
.sc{background:var(--up);border-radius:10px;padding:16px;text-align:center;border:1px solid var(--br)}
.sc.s-green{border-top:3px solid #43e97b}
.sc.s-blue{border-top:3px solid #4A90E2}
.sc.s-red{border-top:3px solid #f5576c}
.sc.s-yellow{border-top:3px solid #ffd565}
.sc.s-purple{border-top:3px solid #a78bfa}
.sc.s-teal{border-top:3px solid #00A896}
.sv{font-size:1.8em;font-weight:900;background:var(--gr);-webkit-background-clip:text;-webkit-text-fill-color:transparent;line-height:1.2}
.sl{font-size:.72em;color:var(--t2);margin-top:4px}

/* TABLE */
.tw{overflow-x:auto;margin-top:12px}
.tbl{width:100%;border-collapse:collapse;min-width:600px}
.tbl th,.tbl td{padding:9px 11px;text-align:right;border-bottom:1px solid var(--br);font-size:.82em}
.tbl th{background:var(--up);font-weight:700;color:var(--t2);position:sticky;top:0;z-index:1}
.tbl tr:hover td{background:rgba(255,255,255,.02)}
.tbl a{color:var(--ta);text-decoration:none}
.tblacts{display:flex;gap:4px;justify-content:flex-end;flex-wrap:wrap}
.badge-fb{padding:2px 8px;border-radius:6px;font-size:.68em;font-weight:700;background:linear-gradient(135deg,#00A896,#4A90E2);color:#fff}
.badge-init{padding:2px 8px;border-radius:6px;font-size:.68em;font-weight:700;background:var(--up);color:var(--t2);border:1px solid var(--br)}
.badge-pend{padding:2px 8px;border-radius:6px;font-size:.68em;font-weight:700;background:linear-gradient(135deg,#ffd89b,#ff9a56);color:#000}
.badge-feat{padding:2px 8px;border-radius:6px;font-size:.68em;font-weight:700;background:linear-gradient(135deg,#667eea,#764ba2);color:#fff}
.badge-hidden{padding:2px 8px;border-radius:6px;font-size:.68em;font-weight:700;background:rgba(245,87,108,.2);color:#f5576c;border:1px solid #f5576c}
.badge-approved{padding:2px 8px;border-radius:6px;font-size:.68em;font-weight:700;background:rgba(67,233,123,.2);color:#43e97b;border:1px solid #43e97b}
.badge-sponsored{padding:2px 8px;border-radius:6px;font-size:.68em;font-weight:700;background:linear-gradient(135deg,#ffd700,#ff9500);color:#000}

/* FORM */
.fg{display:flex;flex-direction:column;gap:5px;margin-bottom:12px}
.fg label{font-size:.82em;color:var(--t2);font-weight:700}
.fi{padding:11px 13px;background:var(--up);border:2px solid var(--br);border-radius:9px;color:var(--t1);font-size:14px;font-family:inherit;width:100%;transition:.2s}
.fi:focus{outline:none;border-color:var(--ta)}
textarea.fi{resize:vertical;min-height:80px}
.fr2{display:grid;grid-template-columns:1fr 1fr;gap:12px}
.fr3{display:grid;grid-template-columns:1fr 1fr 1fr;gap:12px}
.topt{padding:11px 14px;border-radius:9px;border:2px solid var(--br);cursor:pointer;display:flex;align-items:center;gap:9px;font-size:.9em;transition:.2s;margin-bottom:6px}
.topt:has(input:checked){border-color:var(--ta);background:rgba(0,168,150,.08)}
.topt input[type=radio]{accent-color:var(--ta);width:16px;height:16px}

/* TOGGLE SWITCH */
.tog-wrap{display:flex;align-items:center;justify-content:space-between;padding:14px 16px;background:var(--up);border-radius:10px;margin-bottom:10px;border:1px solid var(--br)}
.tog-info{flex:1}
.tog-title{font-size:.9em;font-weight:700}
.tog-desc{font-size:.75em;color:var(--t2);margin-top:2px}
.tog{position:relative;width:44px;height:24px;flex-shrink:0}
.tog input{opacity:0;width:0;height:0}
.tog-slider{position:absolute;cursor:pointer;inset:0;background:#333;border-radius:24px;transition:.3s}
.tog-slider:before{content:'';position:absolute;height:18px;width:18px;right:3px;top:3px;background:#fff;border-radius:50%;transition:.3s}
.tog input:checked + .tog-slider{background:var(--ta)}
.tog input:checked + .tog-slider:before{transform:translateX(-20px)}

/* RATING */
.rcard{background:var(--up);border-radius:10px;padding:14px 16px;display:flex;justify-content:space-between;align-items:center;gap:10px;border:1px solid var(--br);flex-wrap:wrap;margin-bottom:8px}
.rcard-name{font-size:.88em;font-weight:700;flex:1}
.rcard-stars{color:#ffd700;font-size:1em}
.rcard-info{font-size:.75em;color:var(--t2)}

/* COMMENT */
.cmt{background:var(--up);border-radius:10px;padding:14px 16px;margin-bottom:8px;border:1px solid var(--br)}
.cmt.pinned{border-color:#ffd700;background:rgba(255,215,0,.05)}
.cmt-head{display:flex;justify-content:space-between;align-items:center;margin-bottom:8px;flex-wrap:wrap;gap:8px}
.cmt-author{font-weight:700;font-size:.9em}
.cmt-ts{font-size:.72em;color:var(--t2)}
.cmt-body{font-size:.88em;line-height:1.6;color:var(--t1);margin-bottom:8px}
.cmt-reply{background:rgba(0,168,150,.1);border-right:3px solid var(--ta);padding:10px 12px;border-radius:8px;margin-top:8px;font-size:.83em}
.cmt-reply-lbl{font-size:.72em;color:var(--ta);font-weight:700;margin-bottom:4px}
.cmt-acts{display:flex;gap:5px;flex-wrap:wrap}

/* IMPORT */
.upl{border:2px dashed var(--br);border-radius:10px;padding:28px;text-align:center;cursor:pointer;transition:.2s;margin-bottom:12px}
.upl:hover{border-color:var(--ta);background:rgba(0,168,150,.04)}

/* ACTIVITY LOG */
.act-item{display:flex;align-items:flex-start;gap:10px;padding:10px 12px;border-bottom:1px solid var(--br);font-size:.83em}
.act-icon{width:30px;height:30px;border-radius:8px;display:flex;align-items:center;justify-content:center;font-size:14px;flex-shrink:0}
.act-add{background:rgba(67,233,123,.15);color:#43e97b}
.act-del{background:rgba(245,87,108,.15);color:#f5576c}
.act-edit{background:rgba(74,144,226,.15);color:#4A90E2}
.act-login{background:rgba(0,168,150,.15);color:#00A896}
.act-setting{background:rgba(102,126,234,.15);color:#a78bfa}
.act-approve{background:rgba(255,216,155,.15);color:#ffd89b}
.act-text{flex:1}
.act-ts{font-size:.75em;color:var(--t2);white-space:nowrap}

/* PROMO CODES */
.promo-card{background:var(--up);border-radius:10px;padding:14px 16px;margin-bottom:8px;border:1px solid var(--br);display:flex;justify-content:space-between;align-items:center;flex-wrap:wrap;gap:8px}
.promo-code{font-family:monospace;font-size:1.1em;font-weight:900;color:#ffd700;letter-spacing:2px}
.promo-info{font-size:.78em;color:var(--t2)}

/* AFFILIATE */
.aff-card{background:var(--up);border-radius:10px;padding:14px 16px;margin-bottom:8px;border:1px solid var(--br)}
.aff-title{font-weight:700;font-size:.9em;margin-bottom:4px}
.aff-url{font-size:.75em;color:var(--ta);word-break:break-all}
.aff-price{font-size:.82em;color:#43e97b;font-weight:700}

/* CHART */
.chart-wrap{background:var(--up);border-radius:10px;padding:16px;border:1px solid var(--br)}
.chart-title{font-size:.85em;color:var(--t2);font-weight:700;margin-bottom:12px}

/* TOAST */
.toast{position:fixed;bottom:20px;left:50%;transform:translateX(-50%) translateY(120px);background:var(--card);padding:13px 20px;border-radius:10px;border:1px solid var(--br);z-index:3000;opacity:0;transition:.3s;max-width:88%;font-size:13px;text-align:center;pointer-events:none;font-weight:700}
.toast.show{opacity:1;transform:translateX(-50%) translateY(0)}
.tok{border-color:#43e97b;color:#43e97b}
.terr{border-color:#f5576c;color:#f5576c}
.twin{border-color:#ffd565;color:#ffd565}

/* CONFIRM MODAL */
.ov{position:fixed;inset:0;background:rgba(0,0,0,.8);z-index:2000;display:none;align-items:center;justify-content:center;padding:16px;overflow-y:auto}
.ov.open{display:flex}
.cmod{background:var(--card);border-radius:14px;border:1px solid var(--br);padding:28px;max-width:420px;width:100%;text-align:center}
.cmod h3{font-size:1.1em;margin-bottom:8px}
.cmod p{color:var(--t2);font-size:.88em;margin-bottom:20px;line-height:1.5}
.cmod-acts{display:flex;gap:10px;justify-content:center}

/* ALERT */
.alert{padding:12px 16px;border-radius:10px;margin-bottom:14px;font-size:.85em;line-height:1.6;display:none}
.alert.show{display:block}
.alert-warn{background:rgba(255,213,101,.12);border:1px solid rgba(255,213,101,.4);color:#ffd565}
.alert-err{background:rgba(245,87,108,.12);border:1px solid rgba(245,87,108,.4);color:#f5576c}
.alert-info{background:rgba(0,168,150,.12);border:1px solid rgba(0,168,150,.3);color:#00A896}
.alert code{background:rgba(255,255,255,.1);padding:1px 6px;border-radius:4px;font-family:monospace}

/* SECTION HEADER */
.sec-head{display:flex;justify-content:space-between;align-items:center;flex-wrap:wrap;gap:10px;margin-bottom:14px}
.sec-head h3{font-size:1em;font-weight:700}
.sec-head .acts{display:flex;gap:6px;flex-wrap:wrap}

/* LINK HEALTH */
.lh-item{display:flex;align-items:center;gap:10px;padding:10px;border-radius:8px;margin-bottom:6px;font-size:.83em}
.lh-ok{background:rgba(67,233,123,.1);border:1px solid rgba(67,233,123,.3)}
.lh-err{background:rgba(245,87,108,.1);border:1px solid rgba(245,87,108,.3)}
.lh-status{width:50px;font-weight:700;text-align:center;flex-shrink:0}

/* BULK BAR */
.bulk-bar{display:none;position:sticky;bottom:10px;background:var(--card);border:1px solid #4A90E2;border-radius:10px;padding:12px 16px;justify-content:space-between;align-items:center;gap:10px;flex-wrap:wrap;z-index:100;margin-top:10px;box-shadow:0 4px 20px rgba(74,144,226,.2)}
.bulk-bar.show{display:flex}

/* DANGER ZONE */
.danger-zone{border:1px solid rgba(245,87,108,.4);border-radius:10px;padding:16px;margin-top:16px}
.danger-zone h4{color:#f5576c;font-size:.9em;margin-bottom:12px}
.danger-actions{display:flex;flex-direction:column;gap:8px}

/* ANALYTICS */
.brew-item{display:flex;align-items:center;gap:10px;padding:10px 12px;background:var(--up);border-radius:8px;margin-bottom:6px}
.brew-bar-wrap{flex:1;height:8px;background:var(--br);border-radius:4px;overflow:hidden}
.brew-bar{height:100%;background:var(--gr);border-radius:4px;transition:width .5s}
.brew-count{font-weight:700;font-size:.85em;color:#00A896;min-width:50px;text-align:left}

/* MOBILE */
@media(max-width:768px){
  #adminPanel{padding:10px}
  .fr2,.fr3{grid-template-columns:1fr}
  .atabs{gap:4px}
  .atb{padding:8px 10px;font-size:11px}
}
</style>
</head>
<body>

<!-- â•â•â•â• LOGIN â•â•â•â• -->
<div id="loginScreen">
  <div class="lbox">
    <h1>â˜• Xbloom</h1>
    <p>Ù„ÙˆØ­Ø© ØªØ­ÙƒÙ… Ø§Ù„Ù…Ø´Ø±Ù Ø§Ù„Ù…ØªÙ‚Ø¯Ù…Ø©</p>
    <input class="fi" type="text" id="lu" placeholder="Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…" autocomplete="username">
    <div style="height:10px"></div>
    <input class="fi" type="password" id="lp" placeholder="ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±" autocomplete="current-password">
    <div class="lerr" id="lerr"></div>
    <button class="btn bp-full" onclick="doLogin()">ğŸ” Ø¯Ø®ÙˆÙ„ Ø¢Ù…Ù†</button>
    <p style="margin-top:8px;font-size:.72em;color:var(--t2)">ğŸ”’ ÙŠØ³ØªØ®Ø¯Ù… ØªØ´ÙÙŠØ± SHA-256</p>
    <p style="margin-top:14px;font-size:.8em"><a href="/" style="color:var(--ta)">â† Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„Ù…ÙˆÙ‚Ø¹</a></p>
  </div>
</div>

<!-- â•â•â•â• ADMIN PANEL â•â•â•â• -->
<div id="adminPanel">
<div class="apwrap">

  <!-- Header -->
  <div class="aheader">
    <div style="display:flex;align-items:center;gap:12px">
      <div class="fb-dot loading" id="fbDot"></div>
      <div>
        <h1>ğŸ“Š Ù„ÙˆØ­Ø© ØªØ­ÙƒÙ… Xbloom Ø§Ù„Ù…ØªÙ‚Ø¯Ù…Ø©</h1>
        <div class="fb-lbl" id="fbLbl">Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø§ØªØµØ§Ù„...</div>
      </div>
    </div>
    <div style="display:flex;gap:6px;flex-wrap:wrap;align-items:center">
      <a href="/" class="btn bgray bsm" target="_blank">ğŸŒ Ø§Ù„Ù…ÙˆÙ‚Ø¹</a>
      <button class="btn bsm bgray" onclick="switchTab(document.querySelector('.atb[data-tab=tSecurity]'),'tSecurity')">ğŸ”’ Ø§Ù„Ø£Ù…Ø§Ù†</button>
      <button class="btn bd bsm" onclick="doLogout()">ğŸšª Ø®Ø±ÙˆØ¬</button>
    </div>
  </div>

  <!-- Firebase Error Alert -->
  <div class="alert alert-err" id="fbAlert">
    âš ï¸ <strong>ØªØ¹Ø°Ù‘Ø± Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ù€ Firebase</strong> â€” Ø§ÙØªØ­
    <a href="https://console.firebase.google.com/project/xbloom-recipes-hub/database/xbloom-recipes-hub-default-rtdb/rules" target="_blank" style="color:#f5576c;font-weight:700">Firebase Console â†’ Rules</a>
    ÙˆØªØ£ÙƒØ¯ Ù…Ù† ØµØ­Ø© Ø§Ù„Ù‚ÙˆØ§Ø¹Ø¯.
  </div>

  <!-- Tabs -->
  <div class="atabs">
    <button class="atb on" data-tab="tDash"    onclick="switchTab(this,'tDash')">ğŸ“Š Ø¯Ø§Ø´Ø¨ÙˆØ±Ø¯</button>
    <button class="atb"    data-tab="tPending"  onclick="switchTab(this,'tPending')">â³ Ù…Ø±Ø§Ø¬Ø¹Ø©<span class="badge-tab" id="pendBadge">0</span></button>
    <button class="atb"    data-tab="tRec"      onclick="switchTab(this,'tRec')">ğŸ“ Ø§Ù„ÙˆØµÙØ§Øª</button>
    <button class="atb"    data-tab="tComments" onclick="switchTab(this,'tComments')">ğŸ’¬ Ø§Ù„ØªØ¹Ù„ÙŠÙ‚Ø§Øª<span class="badge-tab" id="cmtBadge">0</span></button>
    <button class="atb"    data-tab="tRatings"  onclick="switchTab(this,'tRatings')">â­ Ø§Ù„ØªÙ‚ÙŠÙŠÙ…Ø§Øª</button>
    <button class="atb"    data-tab="tAnalytics" onclick="switchTab(this,'tAnalytics')">ğŸ“ˆ ØªØ­Ù„ÙŠÙ„Ø§Øª</button>
    <button class="atb"    data-tab="tBanner"   onclick="switchTab(this,'tBanner')">ğŸ“¢ Ø¥Ø´Ø¹Ø§Ø±Ø§Øª</button>
    <button class="atb"    data-tab="tMoney"    onclick="switchTab(this,'tMoney')">ğŸ’° Ø¥ÙŠØ±Ø§Ø¯Ø§Øª</button>
    <button class="atb"    data-tab="tSettings" onclick="switchTab(this,'tSettings')">âš™ï¸ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª</button>
    <button class="atb"    data-tab="tSecurity" onclick="switchTab(this,'tSecurity')">ğŸ”’ Ø§Ù„Ø£Ù…Ø§Ù†</button>
    <button class="atb"    data-tab="tTools"    onclick="switchTab(this,'tTools')">ğŸ”§ Ø£Ø¯ÙˆØ§Øª</button>
    <button class="atb"    data-tab="tAdd"      onclick="switchTab(this,'tAdd')">â• Ø¥Ø¶Ø§ÙØ©</button>
  </div>

  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â• DASHBOARD â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <div id="tDash" class="acard open">
    <div class="sec-head">
      <h3>ğŸ“Š Ù„Ù…Ø­Ø© Ø¹Ø§Ù…Ø©</h3>
      <span class="fb-lbl" id="lastSync">â€”</span>
    </div>
    <div class="sg" id="dashStats"></div>
    <div class="fr2" style="gap:14px;margin-top:14px">
      <div class="chart-wrap">
        <div class="chart-title">ğŸ“‚ ØªÙˆØ²ÙŠØ¹ Ø§Ù„ÙØ¦Ø§Øª</div>
        <canvas id="catChart" height="200"></canvas>
      </div>
      <div class="chart-wrap">
        <div class="chart-title">â˜• ØªÙˆØ²ÙŠØ¹ Ø§Ù„Ù…Ø­Ø¶Ù‘Ø±Ø§Øª</div>
        <canvas id="brewChart" height="200"></canvas>
      </div>
    </div>
    <div style="margin-top:14px" class="fr2">
      <div>
        <h4 style="margin-bottom:10px;font-size:.85em;color:var(--t2)">ğŸ† Ø£Ø¹Ù„Ù‰ 5 ØªÙ‚ÙŠÙŠÙ…Ø§Ù‹</h4>
        <div id="topRated"></div>
      </div>
      <div>
        <h4 style="margin-bottom:10px;font-size:.85em;color:var(--t2)">ğŸ“‹ Ø¢Ø®Ø± Ø§Ù„Ù†Ø´Ø§Ø·Ø§Øª</h4>
        <div id="recentActs"></div>
      </div>
    </div>
  </div>

  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â• PENDING â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <div id="tPending" class="acard">
    <div class="sec-head">
      <h3>â³ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©</h3>
      <div class="acts">
        <button class="btn bsm bd" onclick="rejectAllPending()">ğŸ—‘ï¸ Ø±ÙØ¶ Ø§Ù„ÙƒÙ„</button>
        <button class="btn bsm bg" onclick="approveAllPending()">âœ… Ù‚Ø¨ÙˆÙ„ Ø§Ù„ÙƒÙ„</button>
      </div>
    </div>
    <div id="pendingList"></div>
  </div>

  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â• RECIPES â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <div id="tRec" class="acard">
    <div style="display:flex;gap:8px;flex-wrap:wrap;margin-bottom:14px;align-items:center">
      <input class="fi" style="flex:1;min-width:160px" id="aQ" placeholder="ğŸ” Ø¨Ø­Ø«..." oninput="renderTable()">
      <select class="fi" style="width:120px" id="aBr" onchange="renderTable()">
        <option value="all">ÙƒÙ„ Ø§Ù„Ù…Ø­Ø¶Ù‘Ø±Ø§Øª</option>
        <option value="Omni">Omni</option>
        <option value="xPod">xPod</option>
        <option value="Other">Other</option>
      </select>
      <select class="fi" style="width:110px" id="aCat" onchange="renderTable()">
        <option value="all">ÙƒÙ„ Ø§Ù„Ø£Ù†ÙˆØ§Ø¹</option>
        <option value="hot">ğŸ”¥ Ø­Ø§Ø±</option>
        <option value="cold">ğŸ§Š Ø¨Ø§Ø±Ø¯</option>
        <option value="server">âš™ï¸ Ø³ÙŠØ±ÙØ±</option>
      </select>
      <select class="fi" style="width:120px" id="aSrc" onchange="renderTable()">
        <option value="all">ÙƒÙ„ Ø§Ù„Ù…ØµØ§Ø¯Ø±</option>
        <option value="fb">â˜ï¸ Firebase</option>
        <option value="init">ğŸ“ INIT</option>
      </select>
    </div>
    <div style="display:flex;gap:8px;align-items:center;margin-bottom:10px;flex-wrap:wrap">
      <div id="tableCount" style="font-size:.82em;color:var(--t2);flex:1"></div>
      <label style="display:flex;align-items:center;gap:6px;font-size:.82em;cursor:pointer;color:var(--t2)">
        <input type="checkbox" id="selAll" onchange="toggleSelectAll(this)" style="width:14px;height:14px"> ØªØ­Ø¯ÙŠØ¯ Ø§Ù„ÙƒÙ„
      </label>
    </div>
    <div class="tw">
      <table class="tbl">
        <thead><tr><th style="width:30px"></th><th>#</th><th>Ø§Ù„Ø§Ø³Ù…</th><th>Ø§Ù„Ù…Ø¤Ù„Ù</th><th>Ø§Ù„Ù…Ø­Ø¶Ù‘Ø±</th><th>Ø§Ù„Ù†ÙˆØ¹</th><th>Ø§Ù„Ù…ØµØ¯Ø±</th><th>Ø§Ù„ØªÙ‚ÙŠÙŠÙ…</th><th>Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª</th></tr></thead>
        <tbody id="aTbody"></tbody>
      </table>
    </div>
    <div class="bulk-bar" id="bulkBar">
      <span id="bulkCount" style="font-size:.85em;font-weight:700"></span>
      <div style="display:flex;gap:6px;flex-wrap:wrap">
        <button class="btn bsm bd" onclick="bulkDelete()">ğŸ—‘ï¸ Ø­Ø°Ù Ø§Ù„Ù…Ø­Ø¯Ø¯</button>
        <button class="btn bsm bpu" onclick="bulkFeature(true)">ğŸ“Œ ØªÙ…ÙŠÙŠØ² Ø§Ù„Ù…Ø­Ø¯Ø¯</button>
        <button class="btn bsm bgray" onclick="bulkFeature(false)">ğŸ“ Ø¥Ù„ØºØ§Ø¡ Ø§Ù„ØªÙ…ÙŠÙŠØ²</button>
        <button class="btn bsm bgray" onclick="clearSelection()">âœ• Ø¥Ù„ØºØ§Ø¡</button>
      </div>
    </div>
  </div>

  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â• COMMENTS â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <div id="tComments" class="acard">
    <div class="sec-head">
      <h3>ğŸ’¬ Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„ØªØ¹Ù„ÙŠÙ‚Ø§Øª</h3>
      <div class="acts">
        <select class="fi bsm" id="cmtFilter" onchange="renderComments()" style="width:150px">
          <option value="pending">â³ ÙÙŠ Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø±</option>
          <option value="approved">âœ… Ù…Ù‚Ø¨ÙˆÙ„Ø©</option>
          <option value="all">Ø§Ù„ÙƒÙ„</option>
        </select>
        <button class="btn bsm bg" onclick="approveAllComments()">âœ… Ù‚Ø¨ÙˆÙ„ Ø§Ù„ÙƒÙ„ Ø§Ù„Ù…Ø¹Ù„Ù‚</button>
      </div>
    </div>
    <div id="commentsList"></div>
  </div>

  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â• RATINGS â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <div id="tRatings" class="acard">
    <div class="sec-head">
      <h3>â­ Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„ØªÙ‚ÙŠÙŠÙ…Ø§Øª</h3>
      <button class="btn bd bsm" onclick="resetAllRatings()">ğŸ—‘ï¸ ØªØµÙÙŠØ± Ø§Ù„ÙƒÙ„</button>
    </div>
    <div class="sg" id="ratingsStats" style="margin-bottom:16px"></div>
    <div id="ratingsList" style="max-height:500px;overflow-y:auto"></div>
  </div>

  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â• ANALYTICS â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <div id="tAnalytics" class="acard">
    <div class="sec-head">
      <h3>ğŸ“ˆ ØªØ­Ù„ÙŠÙ„Ø§Øª Ø§Ù„ØªØ­Ø¶ÙŠØ±</h3>
      <button class="btn bsm bgray" onclick="loadAnalytics()">ğŸ”„ ØªØ­Ø¯ÙŠØ«</button>
    </div>
    <p style="font-size:.82em;color:var(--t2);margin-bottom:14px">Ø¹Ø¯Ø¯ Ù…Ø±Ø§Øª ÙØªØ­ Ø§Ù„ÙˆØµÙØ© ÙÙŠ ØªØ·Ø¨ÙŠÙ‚ xBloom</p>
    <div id="analyticsChart" style="max-height:400px;overflow-y:auto"></div>
  </div>

  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â• BANNER / PROMO â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <div id="tBanner" class="acard">
    <!-- ANNOUNCEMENT -->
    <div style="margin-bottom:24px">
      <h3 style="margin-bottom:14px">ğŸ“¢ Ø´Ø±ÙŠØ· Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†Ø§Øª</h3>
      <div class="fg"><label>Ù†Øµ Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†</label><textarea class="fi" id="banText" placeholder="Ø£ÙƒØªØ¨ Ø¥Ø¹Ù„Ø§Ù†Ùƒ Ù‡Ù†Ø§..." rows="3"></textarea></div>
      <div class="fg"><label>Ù†ÙˆØ¹ Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†</label>
        <select class="fi" id="banType">
          <option value="info">â„¹ï¸ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª (Ø£Ø²Ø±Ù‚)</option>
          <option value="warn">âš ï¸ ØªØ­Ø°ÙŠØ± (Ø£ØµÙØ±)</option>
          <option value="success">âœ… Ù†Ø¬Ø§Ø­ (Ø£Ø®Ø¶Ø±)</option>
          <option value="error">ğŸš¨ Ø®Ø·Ø£ (Ø£Ø­Ù…Ø±)</option>
        </select>
      </div>
      <div id="banPreview" style="margin-bottom:12px"></div>
      <div style="display:flex;gap:8px">
        <button class="btn bp" onclick="publishBanner()">ğŸ“¢ Ù†Ø´Ø± Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†</button>
        <button class="btn bd" onclick="removeBanner()">âœ• Ø¥Ù„ØºØ§Ø¡</button>
      </div>
      <div id="banStatus" style="margin-top:10px;font-size:.82em;color:var(--t2)"></div>
    </div>

    <!-- PROMO CODES -->
    <h3 style="margin-bottom:14px">ğŸ·ï¸ Ø£ÙƒÙˆØ§Ø¯ Ø§Ù„Ø®ØµÙ…</h3>
    <div class="fr2" style="margin-bottom:12px">
      <div class="fg"><label>Ø§Ù„ÙƒÙˆØ¯ *</label><input class="fi" id="promoCode" placeholder="COFFEE20" style="font-family:monospace;text-transform:uppercase"></div>
      <div class="fg"><label>Ø§Ù„Ù…Ø­Ù…ØµØ©</label><input class="fi" id="promoRoastery" placeholder="Ø§Ø³Ù… Ø§Ù„Ù…Ø­Ù…ØµØ©"></div>
    </div>
    <div class="fr2" style="margin-bottom:12px">
      <div class="fg"><label>Ø§Ù„ÙˆØµÙ</label><input class="fi" id="promoDesc" placeholder="Ø®ØµÙ… 20% Ø¹Ù„Ù‰ Ø§Ù„Ø·Ù„Ø¨Ø§Øª"></div>
      <div class="fg"><label>ØªØ§Ø±ÙŠØ® Ø§Ù„Ø§Ù†ØªÙ‡Ø§Ø¡</label><input class="fi" type="date" id="promoExpiry"></div>
    </div>
    <button class="btn bg bbl" onclick="addPromo()" style="margin-bottom:14px">â• Ø¥Ø¶Ø§ÙØ© ÙƒÙˆØ¯</button>
    <div id="promoList"></div>
  </div>

  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â• MONETIZATION â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <div id="tMoney" class="acard">
    <!-- ADS -->
    <div style="margin-bottom:24px">
      <h3 style="margin-bottom:12px">ğŸ“º Ù†Ø¸Ø§Ù… Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†Ø§Øª (AdSense)</h3>
      <div class="fg"><label>ÙƒÙˆØ¯ AdSense Ù„Ù„Ø­Ù‚Ù† ÙÙŠ Ø§Ù„Ù…ÙˆÙ‚Ø¹</label>
        <textarea class="fi" id="adsCode" placeholder="Ø£Ù†Ø³Ø® ÙƒÙˆØ¯ Ø§Ù„Ø¥Ø¹Ù„Ø§Ù† Ù…Ù† Google AdSense Ù‡Ù†Ø§..." rows="5"></textarea>
      </div>
      <div style="display:flex;gap:8px">
        <button class="btn bp" onclick="saveAdsCode()">ğŸ’¾ Ø­ÙØ¸ ÙƒÙˆØ¯ Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†</button>
        <button class="btn bd" onclick="clearAdsCode()">âœ• Ø­Ø°Ù Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†</button>
      </div>
    </div>

    <!-- TIP JAR -->
    <div style="margin-bottom:24px">
      <h3 style="margin-bottom:12px">â˜• Ø±Ø§Ø¨Ø· Ø§Ù„Ø¯Ø¹Ù… (Buy Me a Coffee)</h3>
      <div class="fg"><label>Ø±Ø§Ø¨Ø· Ø§Ù„Ø¯Ø¹Ù…</label>
        <input class="fi" id="tipJarUrl" placeholder="https://www.buymeacoffee.com/username">
      </div>
      <button class="btn bp" onclick="saveTipJar()">ğŸ’¾ Ø­ÙØ¸ Ø§Ù„Ø±Ø§Ø¨Ø·</button>
    </div>

    <!-- AFFILIATE -->
    <div style="margin-bottom:24px">
      <h3 style="margin-bottom:12px">ğŸ”— Ø±ÙˆØ§Ø¨Ø· Ø§Ù„Ø´Ø±Ø§Ø¡ Ø§Ù„ØªØ§Ø¨Ø¹Ø© (Affiliate)</h3>
      <div class="fr2" style="margin-bottom:8px">
        <div class="fg"><label>Ø±Ø§Ø¨Ø· Ø§Ù„ÙˆØµÙØ© (Ù„Ù„Ø±Ø¨Ø·)</label>
          <select class="fi" id="affRecipe">
            <option value="">Ø§Ø®ØªØ± Ø§Ù„ÙˆØµÙØ© (Firebase)</option>
          </select>
        </div>
        <div class="fg"><label>Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ù…Ù†ØªØ¬</label><input class="fi" id="affTitle" placeholder="Ù‚Ù‡ÙˆØ© Ø§Ø«ÙŠÙˆØ¨ÙŠØ© - Ø£Ù…Ø§Ø²ÙˆÙ†"></div>
      </div>
      <div class="fr2" style="margin-bottom:8px">
        <div class="fg"><label>Ø±Ø§Ø¨Ø· Ø§Ù„Ø´Ø±Ø§Ø¡</label><input class="fi" id="affUrl" placeholder="https://amazon.sa/..."></div>
        <div class="fg"><label>Ø§Ù„Ø³Ø¹Ø± (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)</label><input class="fi" id="affPrice" placeholder="120 Ø±ÙŠØ§Ù„"></div>
      </div>
      <button class="btn bg bbl" onclick="saveAffiliate()" style="margin-bottom:14px">ğŸ’¾ Ø­ÙØ¸ Ø§Ù„Ø±Ø§Ø¨Ø· Ø§Ù„ØªØ§Ø¨Ø¹</button>
      <div id="affiliateList"></div>
    </div>

    <!-- FEATURED TODAY -->
    <div>
      <h3 style="margin-bottom:12px">â­ ÙˆØµÙØ© Ø§Ù„ÙŠÙˆÙ…</h3>
      <div class="fr2">
        <div class="fg"><label>Ø§Ø®ØªØ± ÙˆØµÙØ© Ø§Ù„ÙŠÙˆÙ…</label>
          <select class="fi" id="featTodaySelect">
            <option value="">Ø¨Ù„Ø§ Ø§Ø®ØªÙŠØ§Ø±</option>
          </select>
        </div>
        <div style="display:flex;flex-direction:column;justify-content:flex-end;gap:8px;padding-bottom:12px">
          <button class="btn bp" onclick="setFeaturedToday()">â­ ØªØ¹ÙŠÙŠÙ† ÙˆØµÙØ© Ø§Ù„ÙŠÙˆÙ…</button>
          <button class="btn bd bsm" onclick="clearFeaturedToday()">âœ• Ø¥Ù„ØºØ§Ø¡ ÙˆØµÙØ© Ø§Ù„ÙŠÙˆÙ…</button>
        </div>
      </div>
      <div id="featTodayStatus" style="font-size:.82em;color:var(--t2)"></div>
    </div>
  </div>

  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â• SETTINGS â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <div id="tSettings" class="acard">
    <!-- SITE CONTROLS -->
    <h3 style="margin-bottom:14px">ğŸ›ï¸ Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ù…ÙˆÙ‚Ø¹</h3>
    <div id="settingToggles">
      <div class="tog-wrap">
        <div class="tog-info"><div class="tog-title">ğŸ”§ ÙˆØ¶Ø¹ Ø§Ù„ØµÙŠØ§Ù†Ø©</div><div class="tog-desc">Ø¥Ø®ÙØ§Ø¡ Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ø¹Ù† Ø§Ù„Ø²ÙˆØ§Ø± ÙˆØ¹Ø±Ø¶ ØµÙØ­Ø© ØµÙŠØ§Ù†Ø©</div></div>
        <label class="tog"><input type="checkbox" id="tog-maintenance" onchange="saveSetting('maintenance.enabled',this.checked)"><span class="tog-slider"></span></label>
      </div>
      <div class="tog-wrap">
        <div class="tog-info"><div class="tog-title">ğŸ“¤ Ø§Ù„Ø³Ù…Ø§Ø­ Ø¨Ù…Ø´Ø§Ø±ÙƒØ© Ø§Ù„ÙˆØµÙØ§Øª</div><div class="tog-desc">ØªÙØ¹ÙŠÙ„/ØªØ¹Ø·ÙŠÙ„ Ø²Ø± "Ø´Ø§Ø±Ùƒ ÙˆØµÙØªÙƒ"</div></div>
        <label class="tog"><input type="checkbox" id="tog-submissions" onchange="saveSetting('submissions_enabled',this.checked)"><span class="tog-slider"></span></label>
      </div>
      <div class="tog-wrap">
        <div class="tog-info"><div class="tog-title">âœ… Ø·Ù„Ø¨ Ø§Ù„Ù…ÙˆØ§ÙÙ‚Ø© Ù‚Ø¨Ù„ Ø§Ù„Ù†Ø´Ø±</div><div class="tog-desc">Ø§Ù„ÙˆØµÙØ§Øª Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø© ØªØ°Ù‡Ø¨ Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©</div></div>
        <label class="tog"><input type="checkbox" id="tog-approval" onchange="saveSetting('require_approval',this.checked)"><span class="tog-slider"></span></label>
      </div>
      <div class="tog-wrap">
        <div class="tog-info"><div class="tog-title">â­ Ù†Ø¸Ø§Ù… Ø§Ù„ØªÙ‚ÙŠÙŠÙ…Ø§Øª</div><div class="tog-desc">ØªÙØ¹ÙŠÙ„/ØªØ¹Ø·ÙŠÙ„ Ù†Ø¬ÙˆÙ… Ø§Ù„ØªÙ‚ÙŠÙŠÙ…</div></div>
        <label class="tog"><input type="checkbox" id="tog-ratings" onchange="saveSetting('ratings_enabled',this.checked)"><span class="tog-slider"></span></label>
      </div>
      <div class="tog-wrap">
        <div class="tog-info"><div class="tog-title">ğŸ’¬ Ù†Ø¸Ø§Ù… Ø§Ù„ØªØ¹Ù„ÙŠÙ‚Ø§Øª</div><div class="tog-desc">Ø§Ù„Ø³Ù…Ø§Ø­ Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† Ø¨ÙƒØªØ§Ø¨Ø© ØªØ¹Ù„ÙŠÙ‚Ø§Øª</div></div>
        <label class="tog"><input type="checkbox" id="tog-comments" onchange="saveSetting('comments_enabled',this.checked)"><span class="tog-slider"></span></label>
      </div>
      <div class="tog-wrap">
        <div class="tog-info"><div class="tog-title">ğŸ”— Ø²Ø± Ø§Ù„Ù…Ø´Ø§Ø±ÙƒØ©</div><div class="tog-desc">ØªÙØ¹ÙŠÙ„/ØªØ¹Ø·ÙŠÙ„ Ø²Ø± Ù†Ø³Ø® Ø±Ø§Ø¨Ø· Ø§Ù„ÙˆØµÙØ©</div></div>
        <label class="tog"><input type="checkbox" id="tog-share" onchange="saveSetting('share_enabled',this.checked)"><span class="tog-slider"></span></label>
      </div>
    </div>

    <!-- GLOBAL CONSTANTS -->
    <h3 style="margin-top:20px;margin-bottom:14px">âœï¸ Ø«ÙˆØ§Ø¨Øª Ø§Ù„Ù…ÙˆÙ‚Ø¹ (Ø¨Ø¯ÙˆÙ† Ù„Ù…Ø³ Ø§Ù„ÙƒÙˆØ¯)</h3>
    <div class="fr2">
      <div class="fg"><label>Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ù…ÙˆÙ‚Ø¹</label><input class="fi" id="siteTitle" placeholder="Xbloom Recipes | ÙˆØµÙØ§Øª Ø§ÙƒØ³ Ø¨Ù„ÙˆÙ…"></div>
      <div class="fg"><label>Ù†Øµ Ø§Ù„Ù€ Footer</label><input class="fi" id="footerText" placeholder="Ø¬Ù…ÙŠØ¹ Ø­Ù‚ÙˆÙ‚ Ø§Ù„ÙˆØµÙØ§Øª Ù…Ø­ÙÙˆØ¸Ø©..."></div>
    </div>
    <div class="fr2">
      <div class="fg"><label>Ù†Øµ Ø­Ù‚ÙˆÙ‚ Ø§Ù„Ù†Ø´Ø±</label><input class="fi" id="copyText" placeholder="Â© 2026 Xbloom Recipes"></div>
      <div class="fg"><label>Ø±Ø³Ø§Ù„Ø© ØµÙØ­Ø© Ø§Ù„ØµÙŠØ§Ù†Ø©</label><input class="fi" id="maintMsg" placeholder="Ø§Ù„Ù…ÙˆÙ‚Ø¹ ØªØ­Øª Ø§Ù„ØµÙŠØ§Ù†Ø©..."></div>
    </div>
    <button class="btn bp" onclick="saveConstants()" style="margin-bottom:20px">ğŸ’¾ Ø­ÙØ¸ Ø§Ù„Ø«ÙˆØ§Ø¨Øª</button>

    <!-- DYNAMIC BREW TYPES -->
    <h3 style="margin-bottom:14px">â˜• Ø£Ù†ÙˆØ§Ø¹ Ø§Ù„Ù…Ø­Ø¶Ù‘Ø±Ø§Øª Ø§Ù„Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠØ©</h3>
    <div id="brewTypesList" style="margin-bottom:12px"></div>
    <div style="display:flex;gap:8px">
      <input class="fi" id="newBrewType" placeholder="Ø§Ø³Ù… Ø§Ù„Ù…Ø­Ø¶Ù‘Ø± Ø§Ù„Ø¬Ø¯ÙŠØ¯ (Ù…Ø«Ù„: xBloom 2)" style="flex:1">
      <button class="btn bg" onclick="addBrewType()">â• Ø¥Ø¶Ø§ÙØ©</button>
    </div>

    <div class="danger-zone">
      <h4>âš ï¸ Ù…Ù†Ø·Ù‚Ø© Ø§Ù„Ø®Ø·Ø±</h4>
      <div class="danger-actions">
        <button class="btn bd" onclick="dangerDeleteAll()">ğŸ—‘ï¸ Ø­Ø°Ù Ø¬Ù…ÙŠØ¹ ÙˆØµÙØ§Øª Firebase</button>
        <button class="btn bd" onclick="dangerClearPending()">ğŸ—‘ï¸ Ù…Ø³Ø­ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©</button>
        <button class="btn bd" onclick="resetAllRatings()">ğŸ—‘ï¸ ØªØµÙÙŠØ± Ø¬Ù…ÙŠØ¹ Ø§Ù„ØªÙ‚ÙŠÙŠÙ…Ø§Øª</button>
        <button class="btn bd" onclick="dangerClearComments()">ğŸ—‘ï¸ Ø­Ø°Ù Ø¬Ù…ÙŠØ¹ Ø§Ù„ØªØ¹Ù„ÙŠÙ‚Ø§Øª</button>
      </div>
    </div>
  </div>

  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â• SECURITY â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <div id="tSecurity" class="acard">
    <!-- PASSWORD ROTATOR -->
    <div style="margin-bottom:24px">
      <h3 style="margin-bottom:14px">ğŸ”‘ ØªØºÙŠÙŠØ± ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±</h3>
      <div class="alert alert-warn show">âš ï¸ ØªØºÙŠÙŠØ± ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ù„Ø§ ÙŠØ¤Ø«Ø± Ø¹Ù„Ù‰ Ø§Ù„ÙƒÙˆØ¯ Ø§Ù„Ø«Ø§Ø¨Øª. Ø³ÙŠØªÙ… Ø­ÙØ¸ Ø§Ù„Ù‡Ø§Ø´ Ø§Ù„Ø¬Ø¯ÙŠØ¯ ÙÙŠ Firebase ÙˆØ³ØªØ³ØªØ®Ø¯Ù…Ù‡ Ø§Ù„Ø¬Ù„Ø³Ø§Øª Ø§Ù„Ù‚Ø§Ø¯Ù…Ø©.</div>
      <div class="fg"><label>ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©</label><input class="fi" type="password" id="newPass" placeholder="Ø£Ø¯Ø®Ù„ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©"></div>
      <div class="fg"><label>ØªØ£ÙƒÙŠØ¯ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±</label><input class="fi" type="password" id="confPass" placeholder="Ø£Ø¹Ø¯ Ø¥Ø¯Ø®Ø§Ù„ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±"></div>
      <button class="btn bp" onclick="rotatePassword()">ğŸ” ØªØ­Ø¯ÙŠØ« ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±</button>
    </div>

    <!-- FIREBASE RULES -->
    <div style="margin-bottom:24px">
      <h3 style="margin-bottom:12px">ğŸ“‹ Ù‚ÙˆØ§Ø¹Ø¯ Firebase Ø§Ù„Ù…ÙˆØµÙ‰ Ø¨Ù‡Ø§</h3>
      <div class="alert alert-info show">Ø§Ù†Ø³Ø® Ù‡Ø°Ù‡ Ø§Ù„Ù‚ÙˆØ§Ø¹Ø¯ ÙˆØ¶Ø¹Ù‡Ø§ ÙÙŠ Firebase Console â†’ Realtime Database â†’ Rules</div>
      <pre style="background:var(--up);padding:16px;border-radius:10px;border:1px solid var(--br);font-size:.82em;overflow-x:auto;color:#43e97b;margin-top:10px">{
  "rules": {
    "recipes": {
      ".read": true,
      ".write": "auth != null || root.child('settings/adminSession').val() == true"
    },
    "pending": {
      ".read": "root.child('settings/adminSession').val() == true",
      ".write": true
    },
    "ratings": { ".read": true, ".write": true },
    "comments": {
      ".read": true,
      ".write": true
    },
    "settings": {
      ".read": true,
      ".write": "root.child('settings/adminSession').val() == true"
    },
    "activity": {
      ".read": "root.child('settings/adminSession').val() == true",
      ".write": true
    },
    "analytics": { ".read": true, ".write": true },
    "promo_codes": { ".read": true, ".write": true },
    "affiliate": { ".read": true, ".write": true }
  }
}</pre>
      <p style="font-size:.75em;color:var(--t2);margin-top:8px">Ù…Ù„Ø§Ø­Ø¸Ø©: Ù„Ù„Ø¨ÙŠØ¦Ø© Ø§Ù„Ø¥Ù†ØªØ§Ø¬ÙŠØ© Ø§Ù„Ù…Ø«Ù„Ù‰ØŒ Ø§Ø³ØªØ®Ø¯Ù… Firebase Authentication Ù„Ù„Ø£Ù…Ø§Ù† Ø§Ù„ÙƒØ§Ù…Ù„.</p>
    </div>

    <!-- AUDIT LOG -->
    <div>
      <div class="sec-head">
        <h3>ğŸ“‹ Ø³Ø¬Ù„ Ø§Ù„ØªØ¯Ù‚ÙŠÙ‚ (Audit Log)</h3>
        <button class="btn bsm bd" onclick="clearActivityLog()">ğŸ—‘ï¸ Ù…Ø³Ø­ Ø§Ù„Ø³Ø¬Ù„</button>
      </div>
      <div id="activityLog" style="max-height:400px;overflow-y:auto;border:1px solid var(--br);border-radius:10px"></div>
    </div>
  </div>

  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â• TOOLS â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <div id="tTools" class="acard">
    <!-- LINK HEALTH CHECK -->
    <div style="margin-bottom:24px">
      <div class="sec-head">
        <h3>ğŸ”— ÙØ­Øµ ØµØ­Ø© Ø§Ù„Ø±ÙˆØ§Ø¨Ø·</h3>
        <button class="btn bp bsm" onclick="runLinkCheck()">ğŸ” ÙØ­Øµ Ø§Ù„Ø¢Ù†</button>
      </div>
      <p style="font-size:.82em;color:var(--t2);margin-bottom:12px">ÙŠÙØ­Øµ Ø±ÙˆØ§Ø¨Ø· xBloom ÙÙŠ ÙˆØµÙØ§Øª Firebase ÙˆÙŠÙƒØªØ´Ù Ø§Ù„Ø±ÙˆØ§Ø¨Ø· Ø§Ù„Ù…Ø¹Ø·ÙˆØ¨Ø©</p>
      <div id="linkCheckStatus" style="font-size:.85em;margin-bottom:10px"></div>
      <div id="linkCheckResults" style="max-height:350px;overflow-y:auto"></div>
    </div>

    <!-- DATA VALIDATOR -->
    <div style="margin-bottom:24px">
      <h3 style="margin-bottom:12px">ğŸ›¡ï¸ Ù…Ø¯Ù‚Ù‚ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</h3>
      <div class="fr2">
        <div class="fg"><label>Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ù‚ØµÙ‰ Ù„Ø­Ø¬Ù… Ø§Ù„ÙˆØµÙØ© (Ø¨Ø§ÙŠØª)</label>
          <input class="fi" type="number" id="maxSize" value="5000" min="100" max="50000">
        </div>
        <div style="display:flex;flex-direction:column;justify-content:flex-end;padding-bottom:12px">
          <button class="btn bp" onclick="runValidator()">ğŸ” ØªØ­Ù‚Ù‚</button>
        </div>
      </div>
      <div id="validatorResults"></div>
    </div>

    <!-- CLEANUP TOOL -->
    <div style="margin-bottom:24px">
      <h3 style="margin-bottom:12px">ğŸ§¹ Ø£Ø¯Ø§Ø© Ø§Ù„ØªÙ†Ø¸ÙŠÙ</h3>
      <div style="display:flex;flex-direction:column;gap:8px">
        <button class="btn bd" onclick="cleanupOldPending()">ğŸ—‘ï¸ Ø­Ø°Ù ÙˆØµÙØ§Øª Ù…Ø±Ø§Ø¬Ø¹Ø© Ù‚Ø¯ÙŠÙ…Ø© (Ø£ÙƒØ«Ø± Ù…Ù† 30 ÙŠÙˆÙ…)</button>
        <button class="btn bd" onclick="cleanupHiddenRecipes()">ğŸ—‘ï¸ Ø­Ø°Ù Ø§Ù„ÙˆØµÙØ§Øª Ø§Ù„Ù…Ø®ÙÙŠØ©</button>
        <button class="btn bw" onclick="cleanupDuplicates()">ğŸ”„ ÙØ­Øµ ÙˆØ­Ø°Ù Ø§Ù„ØªÙƒØ±Ø§Ø±Ø§Øª</button>
      </div>
      <div id="cleanupResults" style="margin-top:10px"></div>
    </div>

    <!-- IMPORT -->
    <div style="margin-bottom:24px">
      <h3 style="margin-bottom:14px">ğŸ“¤ Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ù…Ù† Excel</h3>
      <div class="upl" onclick="document.getElementById('xlsIn').click()">
        <div style="font-size:2.5em;margin-bottom:8px">ğŸ“</div>
        <h4>Ø§Ø³Ø­Ø¨ Ù…Ù„Ù Excel Ø£Ùˆ Ø§Ø¶ØºØ· Ù„Ù„Ø§Ø®ØªÙŠØ§Ø±</h4>
        <p style="color:var(--t2);margin-top:6px;font-size:.82em">.xlsx | .xls</p>
      </div>
      <input type="file" id="xlsIn" accept=".xlsx,.xls" style="display:none" onchange="doImport(event)">
      <button class="btn bg bbl" onclick="dlTemplate()">ğŸ“¥ ØªØ­Ù…ÙŠÙ„ Ù†Ù…ÙˆØ°Ø¬ Excel</button>
    </div>

    <!-- EXPORT -->
    <div>
      <h3 style="margin-bottom:14px">ğŸ“¥ ØªØµØ¯ÙŠØ± Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</h3>
      <div style="display:flex;flex-direction:column;gap:8px">
        <button class="btn bp bbl" onclick="expXLS()">ğŸ“Š ØªØµØ¯ÙŠØ± Firebase â†’ Excel</button>
        <button class="btn bg bbl" onclick="expAllXLS()">ğŸ“Š ØªØµØ¯ÙŠØ± Ø§Ù„ÙƒÙ„ (FB + INIT) â†’ Excel</button>
        <button class="btn bpu bbl" onclick="expJSON()">ğŸ“„ ØªØµØ¯ÙŠØ± JSON</button>
        <button class="btn bw bbl" onclick="expBackup()">ğŸ’¾ Ù†Ø³Ø®Ø© Ø§Ø­ØªÙŠØ§Ø·ÙŠØ© Ø´Ø§Ù…Ù„Ø©</button>
      </div>
    </div>
  </div>

  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â• ADD/EDIT â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <div id="tAdd" class="acard">
    <h3 id="addFormTitle" style="margin-bottom:16px">â• Ø¥Ø¶Ø§ÙØ© ÙˆØµÙØ© Ø¬Ø¯ÙŠØ¯Ø©</h3>
    <form id="addForm" onsubmit="saveRec(event)">
      <input type="hidden" id="rFbKey">
      <div class="fr2">
        <div class="fg"><label>Ø§Ù„Ø§Ø³Ù… *</label><input class="fi" id="rN" required placeholder="Ø§Ø³Ù… Ø§Ù„ÙˆØµÙØ©"></div>
        <div class="fg"><label>Ø§Ù„Ù…Ø¤Ù„Ù</label><input class="fi" id="rA" placeholder="Ø§Ø³Ù… Ø§Ù„Ù…Ø¤Ù„Ù"></div>
      </div>
      <div class="fr2">
        <div class="fg"><label>Ø§Ù„Ù…Ø­Ø¶Ù‘Ø± *</label>
          <select class="fi" id="rBr" required>
            <option value="">Ø§Ø®ØªØ±</option>
            <option value="Omni">Omni</option>
            <option value="xPod">xPod</option>
            <option value="Other">Other</option>
          </select>
        </div>
        <div class="fg"><label>Ø§Ù„Ø¬Ø±Ø¹Ø© *</label><input class="fi" id="rD" required placeholder="15g"></div>
      </div>
      <div class="fr2">
        <div class="fg"><label>Ø§Ù„Ù†Ø³Ø¨Ø©</label><input class="fi" id="rR" placeholder="1:16"></div>
        <div class="fg"><label>Ø±Ø§Ø¨Ø· Ø§Ù„ÙˆØµÙØ© *</label><input type="url" class="fi" id="rL" required placeholder="https://share-h5.xbloom.com/?id=..."></div>
      </div>
      <div class="fg"><label>Ù†ÙˆØ¹ Ø§Ù„ØªØ­Ø¶ÙŠØ± *</label>
        <div>
          <div class="topt"><input type="radio" name="rc" id="rHot" value="hot" required><label for="rHot">ğŸ”¥ ÙˆØµÙØ© Ø­Ø§Ø±</label></div>
          <div class="topt"><input type="radio" name="rc" id="rCold" value="cold"><label for="rCold">ğŸ§Š ÙˆØµÙØ© Ø¨Ø§Ø±Ø¯</label></div>
          <div class="topt"><input type="radio" name="rc" id="rSrv" value="server"><label for="rSrv">âš™ï¸ ØºØ³ÙŠÙ„ ÙˆØªØ±Ø·ÙŠØ¨ Ø³ÙŠØ±ÙØ±</label></div>
        </div>
      </div>
      <div class="fr2" style="margin-bottom:12px">
        <label style="display:flex;align-items:center;gap:8px;cursor:pointer;padding:10px;background:var(--up);border-radius:9px;border:1px solid var(--br)">
          <input type="checkbox" id="rFeat" style="width:16px;height:16px;accent-color:var(--ta)">
          <span style="font-size:.88em">ğŸ“Œ ÙˆØµÙØ© Ù…Ù…ÙŠØ²Ø© (Ù…Ø«Ø¨ØªØ© ÙÙŠ Ø§Ù„Ø£Ø¹Ù„Ù‰)</span>
        </label>
        <label style="display:flex;align-items:center;gap:8px;cursor:pointer;padding:10px;background:var(--up);border-radius:9px;border:1px solid var(--br)">
          <input type="checkbox" id="rSponsored" style="width:16px;height:16px;accent-color:#ffd700">
          <span style="font-size:.88em">ğŸŒŸ ÙˆØµÙØ© Ù…Ø¯ÙÙˆØ¹Ø© (Sponsored)</span>
        </label>
      </div>
      <div style="display:flex;gap:8px;flex-wrap:wrap">
        <button type="submit" class="btn bp" style="flex:1;justify-content:center" id="saveBtn">ğŸ’¾ Ø­ÙØ¸</button>
        <button type="button" class="btn bgray" onclick="resetForm()">ğŸ”„ Ù…Ø³Ø­</button>
      </div>
    </form>
  </div>

</div>
</div>

<!-- Confirm Modal -->
<div class="ov" id="confirmOv">
  <div class="cmod">
    <h3 id="confirmTitle">ØªØ£ÙƒÙŠØ¯</h3>
    <p id="confirmMsg"></p>
    <div class="cmod-acts">
      <button class="btn bd" id="confirmOk">ØªØ£ÙƒÙŠØ¯</button>
      <button class="btn bgray" onclick="document.getElementById('confirmOv').classList.remove('open')">Ø¥Ù„ØºØ§Ø¡</button>
    </div>
  </div>
</div>

<!-- Admin Reply Modal -->
<div class="ov" id="replyOv">
  <div class="cmod" style="max-width:500px">
    <h3>â†©ï¸ Ø±Ø¯ Ø§Ù„Ù…Ø·ÙˆØ±</h3>
    <textarea class="fi" id="replyText" rows="4" placeholder="Ø§ÙƒØªØ¨ Ø±Ø¯Ùƒ Ù‡Ù†Ø§..." style="margin:12px 0"></textarea>
    <div class="cmod-acts">
      <button class="btn bp" id="replyOk">Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø±Ø¯</button>
      <button class="btn bgray" onclick="document.getElementById('replyOv').classList.remove('open')">Ø¥Ù„ØºØ§Ø¡</button>
    </div>
  </div>
</div>

<div class="toast" id="toast"></div>

<script type="module">
import { initializeApp }                                                from "https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js";
import { getDatabase, ref, onValue, push, set, remove, get, update }   from "https://www.gstatic.com/firebasejs/10.12.0/firebase-database.js";

// â•â•â•â• CONFIG â•â•â•â•
const PASS_HASH  = "f4769037706d860d4b966601f016e78a631f4a9743c748c0817c7d4e3e3b3970";
const USER_HASH  = "8c6976e5b5410415bde908bd4dee15dfb167a9c873fc4bb8a81f6f2ab448a918";
const FB_CFG = {
  apiKey:      "AIzaSyDq370Yy4W-TfbyFL5rt4y3h3ngajJVIrE",
  databaseURL: "https://xbloom-recipes-hub-default-rtdb.europe-west1.firebasedatabase.app",
  projectId:   "xbloom-recipes-hub"
};

const INIT = [{"name": "ÙˆØµÙØ© Ø¨Ø§Ø±Ø¯Ù‡ 24 Ø¬Ø±Ø§Ù… Ù‚Ù‡ÙˆØ©", "author": "mf", "brewer": "Other", "dose": "24g", "ratio": "1:7", "link": "https://share-h5.xbloom.com/?id=ZZxY4cY1PPjQ2M3HyuQQkg%3D%3D", "temperature": "cold", "category": "cold"}, {"name": "Abla | Colombia 20G", "author": "Abdulrahman alnasser", "brewer": "Other", "dose": "20g", "ratio": "1:15", "link": "https://share-h5.xbloom.com/?id=Zv1nKEbBLN%2BB309uAYN9xg%3D%3D", "temperature": "hot", "category": "hot"}, {"name": "AboZee 25g", "author": "AboZee", "brewer": "Omni", "dose": "15g", "ratio": "1:25", "link": "https://share-h5.xbloom.com/?id=ztElW2DfyC6D2Ft%2FEdYZ7Q%3D%3D", "temperature": "hot", "category": "hot"}, {"name": "Ø¯ÙŠ ÙƒØ§Ù Ø¨Ù„Ø§Ùƒ Ù†Ø§ÙŠØª", "author": "Majed", "brewer": "Other", "dose": "20g", "ratio": "1:15", "link": "https://share-h5.xbloom.com/?id=Zs%2BDXkRFyUkoUJVLZ8wCrw%3D%3D", "temperature": "hot", "category": "hot"}, {"name": "Arriyadh Sidamo Natural", "author": "Arriyadh", "brewer": "xPod", "dose": "15g", "ratio": "1:16", "link": "https://share-h5.xbloom.com/?id=ZrYi4IY%2BOcoI%2BQ3RBifZUw%3D%3D", "temperature": "hot", "category": "hot"}, {"name": "Pepperpot Tea Hibiscus Berry Iced", "author": "", "brewer": "Omni", "dose": "5g", "ratio": "~240ml", "link": "https://share-h5.xbloom.com/?id=ZOEKEzL3WtTTfSIrfUPMyA%3D%3D", "temperature": "cold", "category": "cold"}, {"name": "ice 100g", "author": "M", "brewer": "Other", "dose": "20g", "ratio": "1:7", "link": "https://share-h5.xbloom.com/?id=zIuOeVvubuydUfN%2Befj1Sg%3D%3D", "temperature": "cold", "category": "cold"}, {"name": "cold150", "author": "Jazaa", "brewer": "Omni", "dose": "18g", "ratio": "1:8", "link": "https://share-h5.xbloom.com/?id=ZHNDm7R1vKaAVpS2f7cPqg%3D%3D", "temperature": "cold", "category": "cold"}, {"name": "ÙˆØµÙØ© 15 Ø¬Ø±Ø§Ù… Ø§Ø«ÙŠÙˆØ¨ÙŠ", "author": "Abdullah", "brewer": "Omni", "dose": "15g", "ratio": "1:15", "link": "https://share-h5.xbloom.com/?id=ZHdgDqVThoshjr7eZN4QJw%3D%3D", "temperature": "hot", "category": "hot"}, {"name": "Ø£Ø¨Ùˆ Ø±Ø§Ø³", "author": "Ghadah", "brewer": "Other", "dose": "22g", "ratio": "1:16", "link": "https://share-h5.xbloom.com/?id=ZDEw2sIKBGvY7OIrBbyimQ%3D%3D", "temperature": "hot", "category": "hot"}, {"name": "ÙÙŠØµÙ„ ÙŠÙˆÙ†Ø³ - ØµØºÙŠØ±", "author": "MF", "brewer": "Other", "dose": "15g", "ratio": "1:16", "link": "https://share-h5.xbloom.com/?id=Z8M5K%2BUcr9pksOjL9MckxQ%3D%3D", "temperature": "hot", "category": "hot"}, {"name": "Ø§Ù†Ø§Ù†Ø§Ø³ Ø¨Ù„Ø§Ùƒ Ù†Ø§ÙŠØª Ø¨Ø§Ø±Ø¯", "author": "Ø§Ø¨Ùˆ ÙˆØ³Ù†", "brewer": "Other", "dose": "23g", "ratio": "1:7", "link": "https://share-h5.xbloom.com/?id=z2aZem4GJiagl%2F0Ai2mS8Q%3D%3D", "temperature": "cold", "category": "cold"}, {"name": "Ø´Ø§ÙŠ Ø§Ù„ÙˆØ²Ø©", "author": "Essa", "brewer": "Omni", "dose": "3g", "ratio": "~360ml", "link": "https://share-h5.xbloom.com/?id=YZ6maOZHWqVVSH6uHebgmQ%3D%3D", "temperature": "hot", "category": "hot"}, {"name": "ÙˆÙŠÙ„Ø§", "author": "ABDULAZIZ", "brewer": "Other", "dose": "20g", "ratio": "1:15", "link": "https://share-h5.xbloom.com/?id=ywtZFka1zAfA2RAqbWvsfw%3D%3D", "temperature": "hot", "category": "hot"}, {"name": "Iced Coffee", "author": "", "brewer": "xPod", "dose": "15g", "ratio": "1:10", "link": "https://share-h5.xbloom.com/?id=yFRPu9hIS4y6IjuDAirNMQ%3D%3D", "temperature": "cold", "category": "cold"}, {"name": "COLD BRO", "author": "XBLOOM Adel Badwilan", "brewer": "xPod", "dose": "15g", "ratio": "1:10", "link": "https://share-h5.xbloom.com/?id=YDoSObYqp5HFjnFJHkvydQ%3D%3D", "temperature": "cold", "category": "cold"}, {"name": "Brew over 150 ICE", "author": "Hrs", "brewer": "Omni", "dose": "15g", "ratio": "1:10", "link": "https://share-h5.xbloom.com/?id=Ycj1mFbeWOMUWFi8f6eUAQ%3D%3D", "temperature": "cold", "category": "cold"}, {"name": "Ø¨Ø§Ø±Ø¯ ğŸ§Š", "author": "Ø¹Ø§Ø¦Ø¶ Ø§Ù„Ø¹ØªÙŠØ¨ÙŠ", "brewer": "Other", "dose": "20g", "ratio": "1:7", "link": "https://share-h5.xbloom.com/?id=Y7kxrFLXHmkJAsj7JrrCgA%3D%3D", "temperature": "cold", "category": "cold"}, {"name": "fzz_81 - UGANDA", "author": "Fuad Al Zahrani", "brewer": "Omni", "dose": "15g", "ratio": "1:16", "link": "https://share-h5.xbloom.com/?id=Y3XWHFSyqt1BtBVVVS7NZQ%3D%3D", "temperature": "hot", "category": "hot"}, {"name": "20g Colombia with grind|Aseel", "author": "abdulla alqarni", "brewer": "Other", "dose": "20g", "ratio": "1:15", "link": "https://share-h5.xbloom.com/?id=Y1jcHo1jeu4jMskNWnc2xg%3D%3D", "temperature": "hot", "category": "hot"}, {"name": "Ø§ÙˆØºÙ†Ø¯ÙŠ ÙˆÙŠÙ†Ø¯ Ø¬Ø¯ÙŠØ¯", "author": "Emad", "brewer": "Omni", "dose": "15g", "ratio": "1:15", "link": "https://share-h5.xbloom.com/?id=XyLGiloGRIRxDWJMlwn5UA%3D%3D", "temperature": "hot", "category": "hot"}, {"name": "20g Colombia with grind|Aseel", "author": "Hadeel", "brewer": "Other", "dose": "20g", "ratio": "1:15", "link": "https://share-h5.xbloom.com/?id=xXsrNAdUzELj1dCMB31L9g%3D%3D", "temperature": "hot", "category": "hot"}, {"name": "Nj | Kasuya 20g", "author": "Najla", "brewer": "Other", "dose": "20g", "ratio": "1:15", "link": "https://share-h5.xbloom.com/?id=xxCCzvg1KWUW8I7ER3ulyQ%3D%3D", "temperature": "hot", "category": "hot"}, {"name": "surge ice Ø§Ù„Ø«Ù„Ø¬ 150", "author": "puresoul.ma", "brewer": "Other", "dose": "20g", "ratio": "1:10", "link": "https://share-h5.xbloom.com/?id=Xu5LoRZQpNa4jpjV1MzWJQ%3D%3D", "temperature": "cold", "category": "cold"}, {"name": "Ø¨Ø§Ø±Ø¯", "author": "Bader", "brewer": "Omni", "dose": "18g", "ratio": "1:7", "link": "https://share-h5.xbloom.com/?id=xSi8xAYQA4atCP8Asd6AuA%3D%3D", "temperature": "cold", "category": "cold"}, {"name": "Ethiopia ice", "author": "Gasim Hakami", "brewer": "Omni", "dose": "15g", "ratio": "1:10", "link": "https://share-h5.xbloom.com/?id=Xn2ODVjt5LS%2B6Q7LiY8pnA%3D%3D", "temperature": "cold", "category": "cold"}, {"name": "Cold", "author": "Najla", "brewer": "Omni", "dose": "18g", "ratio": "1:9", "link": "https://share-h5.xbloom.com/?id=xl9kwADxKDKMHf%2F5Jb7LJw%3D%3D", "temperature": "cold", "category": "cold"}, {"name": "orea Classic 20g", "author": "RAED", "brewer": "Other", "dose": "20g", "ratio": "1:15", "link": "https://share-h5.xbloom.com/?id=xiz4JJhiyIZ%2BZHaA1IZ%2Fdw%3D%3D", "temperature": "hot", "category": "hot"}, {"name": "NJ COLD | ÙƒÙ…ÙŠØ© Ø§Ù„Ø«Ù„Ø¬ Ù¡Ù¥Ù  Ø¬Ø±Ø§Ù…", "author": "Abdallh Al-Sultan", "brewer": "Other", "dose": "20g", "ratio": "1:7", "link": "https://share-h5.xbloom.com/?id=Xhef9RIOPNSVZyPCEOtonQ%3D%3D", "temperature": "cold", "category": "cold"}, {"name": "SOIL GUJI", "author": "", "brewer": "xPod", "dose": "15g", "ratio": "1:15", "link": "https://share-h5.xbloom.com/?id=XgzAZWMAV5y4PjgFyhA1TA%3D%3D", "temperature": "hot", "category": "hot"}, {"name": "Ethiopia Biloya", "author": "Bassam", "brewer": "Other", "dose": "20g", "ratio": "1:15", "link": "https://share-h5.xbloom.com/?id=xEj5EG6QjqUiOM3Z7X8dbA%3D%3D", "temperature": "hot", "category": "hot"}, {"name": "ØªØ¬Ø±Ø¨Ù‡ 2 Ø¨Ø§Ø±Ø¯", "author": "Gasim Hakami", "brewer": "Other", "dose": "20g", "ratio": "1:7", "link": "https://share-h5.xbloom.com/?id=xe8UTT37KCuxI4y5gz%2Bt9Q%3D%3D", "temperature": "cold", "category": "cold"}, {"name": "Colombia Washed Light", "author": "", "brewer": "xPod", "dose": "15g", "ratio": "1:17", "link": "https://share-h5.xbloom.com/?id=XdNuOm5mA0kZP0JWSwSoIg%3D%3D", "temperature": "hot", "category": "hot"}, {"name": "Ù¢Ù  Ø¬Ø±Ø§Ù… Ø§ÙˆÙ…Ù†ÙŠ", "author": "Ali", "brewer": "Other", "dose": "20g", "ratio": "1:15", "link": "https://share-h5.xbloom.com/?id=X5nxWI5U7FWBhfZU961TiA%3D%3D", "temperature": "hot", "category": "hot"}, {"name": "ice drip recipe", "author": "Authentic", "brewer": "Other", "dose": "20g", "ratio": "1:8", "link": "https://share-h5.xbloom.com/?id=x3M8vrGKocxmRt1ZS97sgA%3D%3D", "temperature": "cold", "category": "cold"}, {"name": "ÙˆØµÙØ© Ø§Ø¨Ùˆ Ø§ØµÙŠÙ„ Ø­Ø§Ø±", "author": "Faisal", "brewer": "Omni", "dose": "18g", "ratio": "1:16", "link": "https://share-h5.xbloom.com/?id=WybicM2lKEYTHmzWTfN%2B%2Bg%3D%3D", "temperature": "hot", "category": "hot"}, {"name": "High Sweetness ğŸ¯", "author": "Mohamd", "brewer": "Other", "dose": "20g", "ratio": "1:7", "link": "https://share-h5.xbloom.com/?id=wQmY93Qh3stVj0p3rXwDRg%3D%3D", "temperature": "hot", "category": "hot"}, {"name": "Ù‚ÙŠØ¯Ø¨ Ù…ØµÙ†Ø¹ Ø§Ù„Ù‚Ù‡ÙˆØ©", "author": "Abdullah", "brewer": "Omni", "dose": "15g", "ratio": "1:15", "link": "https://share-h5.xbloom.com/?id=wBODV6u50yVDgx0DIIAQkw%3D%3D", "temperature": "hot", "category": "hot"}, {"name": "Orea 15 gram Ø§Ù„Ø£Ø³Ø§Ø³", "author": "Sultan", "brewer": "Other", "dose": "15g", "ratio": "1:16", "link": "https://share-h5.xbloom.com/?id=wbIItzIgVTda1YhjUFQJ6g%3D%3D", "temperature": "hot", "category": "hot"}, {"name": "Ø§Ù†Ø§Ù†Ø§Ø³", "author": "Ø£Ø¨ÙˆØ¹Ø¨Ø¯Ø§Ù„Ø±Ø­Ù…Ù†", "brewer": "Other", "dose": "20g", "ratio": "1:16", "link": "https://share-h5.xbloom.com/?id=W9gZa0eGAEvmGQBJZsNSbA%3D%3D", "temperature": "hot", "category": "hot"}, {"name": "ÙƒÙˆØ¨ Ø«Ù‚ÙŠÙ„", "author": "Abdallh Al-Sultan", "brewer": "Other", "dose": "20g", "ratio": "1:7", "link": "https://share-h5.xbloom.com/?id=VYCp0pG9Rk%2FKcx1LLFRUHA%3D%3D", "temperature": "hot", "category": "hot"}, {"name": "faisal younis Xpods 6T", "author": "Abdulrahman alnasser", "brewer": "xPod", "dose": "15g", "ratio": "1:15", "link": "https://share-h5.xbloom.com/?id=VsnipSCO9SPag6Fc5e2%2FkA%3D%3D", "temperature": "hot", "category": "hot"}, {"name": "Filter Rinse", "author": "SHADDAD", "brewer": "Other", "dose": "10g", "ratio": "1:7", "link": "https://share-h5.xbloom.com/?id=vqSQON%2FLhNbHwqsa8USrsw%3D%3D", "temperature": "hot", "category": "hot"}, {"name": "60ml - 20g 1:15 ratio", "author": "Shabib", "brewer": "Other", "dose": "20g", "ratio": "1:15", "link": "https://share-h5.xbloom.com/?id=vqoWL%2FhpGg17USllk8KJdg%3D%3D", "temperature": "hot", "category": "hot"}, {"name": "MHğŸ§Šâ˜•ï¸", "author": "MH", "brewer": "Other", "dose": "20g", "ratio": "1:7", "link": "https://share-h5.xbloom.com/?id=VlNhaY4iek%2Fk7GKRJGndGw%3D%3D", "temperature": "cold", "category": "cold"}, {"name": "Cold Recipe 150 Ø«Ù„Ø¬", "author": "Abdullah alshalawi", "brewer": "Other", "dose": "20g", "ratio": "1:7", "link": "https://share-h5.xbloom.com/?id=vciDPAlWu7P03xCPc0UYAA%3D%3D", "temperature": "cold", "category": "cold"}, {"name": "A.Almassari / 25g", "author": "Muneera", "brewer": "Other", "dose": "25g", "ratio": "1:15", "link": "https://share-h5.xbloom.com/?id=V9OSolM1fdsrfEz8FHwXsw%3D%3D", "temperature": "hot", "category": "hot"}, {"name": "ÙˆØµÙØ© Ø§Ù„Ø¨Ø§Ø±Ø¯", "author": "ADEL SPACE", "brewer": "Omni", "dose": "17g", "ratio": "1:7", "link": "https://share-h5.xbloom.com/?id=V9eqQyyaSfuxowGSgEJeFQ%3D%3D", "temperature": "cold", "category": "cold"}, {"name": 15, "author": "Muneera", "brewer": "Omni", "dose": "15g", "ratio": "1:15", "link": "https://share-h5.xbloom.com/?id=UY4Y%2BSkLErm%2FifnzkgNLoA%3D%3D", "temperature": "hot", "category": "hot"}, {"name": "v60 25 g", "author": "Hussain", "brewer": "Other", "dose": "25g", "ratio": "1:16", "link": "https://share-h5.xbloom.com/?id=uX6NLJlh3wd3Yj5CST%2Fdbw%3D%3D", "temperature": "hot", "category": "hot"}, {"name": "ÙƒÙˆØ³ØªØ±ÙŠÙƒÙŠ Ø¨Ù„ÙˆÙ…", "author": "Emad", "brewer": "xPod", "dose": "15g", "ratio": "1:12", "link": "https://share-h5.xbloom.com/?id=uTuyB8bn7uVsEHQSS2XngA%3D%3D", "temperature": "hot", "category": "hot"}, {"name": "NğŸ§ŠğŸ’œ", "author": "Noha", "brewer": "Omni", "dose": "18g", "ratio": "1:10", "link": "https://share-h5.xbloom.com/?id=urudC1Wq9v5Y%2Byjh%2FaoD1w%3D%3D", "temperature": "cold", "category": "cold"}, {"name": "ØºØ³ÙŠÙ„ Ø§Ù„ÙÙ„ØªØ± ÙˆØªØ³Ø®ÙŠÙ† Ø§Ù„Ø³ÙŠØ±ÙØ± ÙÙ‚Ø·", "author": "Naif", "brewer": "Omni", "dose": "8g", "ratio": "1:5", "link": "https://share-h5.xbloom.com/?id=UGbuMoV9DGzaNMEyHIuL1Q%3D%3D", "temperature": "hot", "category": "server"}, {"name": "AboAseeL 20g | Ethiopia", "author": "Ø£Ø¨ÙˆØ¹Ø¨Ø¯Ø§Ù„Ø±Ø­Ù…Ù†", "brewer": "Other", "dose": "20g", "ratio": "1:15", "link": "https://share-h5.xbloom.com/?id=UG5%2FcjagDwuq47g0mrHKLg%3D%3D", "temperature": "hot", "category": "hot"}, {"name": "ØºØ³ÙŠÙ„ Ø§Ù„ÙÙ„ØªØ± ÙˆØªØ³Ø®ÙŠÙ† Ø§Ù„Ø³ÙŠØ±ÙØ± ÙÙ‚Ø·", "author": "ABDULLAH", "brewer": "Other", "dose": "12g", "ratio": "1:5", "link": "https://share-h5.xbloom.com/?id=Ufjl2IJPb9XpYCNjyvqtyQ%3D%3D", "temperature": "hot", "category": "server"}, {"name": "Ø¨ÙˆØ´Ø§Ù†20Ù‚Ø±Ø§Ù…", "author": "Ø£Ø¨ÙˆØ¹Ø¨Ø¯Ø§Ù„Ø±Ø­Ù…Ù†", "brewer": "Other", "dose": "20g", "ratio": "1:15", "link": "https://share-h5.xbloom.com/?id=uBbHZvLSbDzmEaeeINV%2FQw%3D%3D", "temperature": "hot", "category": "hot"}, {"name": "ÙˆØµÙØ© 15 ØºØ±Ø§Ù… Ø¨Ø§Ø±Ø¯", "author": "ÙŠÙˆØ³Ù Ø§Ù„Ø¹Ù…ÙŠØ±ÙŠ", "brewer": "Omni", "dose": "15g", "ratio": "1:10", "link": "https://share-h5.xbloom.com/?id=UAQm6m2c6ZBH20admXIqbg%3D%3D", "temperature": "cold", "category": "cold"}, {"name": "Ù…Ø§Ø¯Ù‡ÙŠÙ„ÙŠÙ†Ù‚ ØªØ±ÙŠÙØ§Ù„ÙŠ", "author": "Ø¹Ø§Ø¦Ø¶ Ø§Ù„Ø¹ØªÙŠØ¨ÙŠ", "brewer": "Other", "dose": "20g", "ratio": "1:14", "link": "https://share-h5.xbloom.com/?id=uAl2AaCa4xnRWVIBu3geyw%3D%3D", "temperature": "hot", "category": "hot"}, {"name": "Curve Excelso", "author": "", "brewer": "xPod", "dose": "15g", "ratio": "1:17", "link": "https://share-h5.xbloom.com/?id=u%2B1MvUtUjg9VZe4O4nIgag%3D%3D", "temperature": "hot", "category": "hot"}, {"name": "Ø±ÙˆÙÙŠØ±Ø§ Ø¨Ø§Ø±Ø¯ Ø§Ù„Ø«Ù„Ø¬ 130 Ù…Ù„", "author": "Riza", "brewer": "Omni", "dose": "18g", "ratio": "1:10", "link": "https://share-h5.xbloom.com/?id=tsjs3M8TVnZ6DJtSti3KEg%3D%3D", "temperature": "cold", "category": "cold"}, {"name": "ØµÙˆØ§Ø¹- Ù‡ÙˆÙŠÙ„Ø§ (Ø­Ø§Ø±) 2:38", "author": "Ibrahim", "brewer": "xPod", "dose": "15g", "ratio": "1:15", "link": "https://share-h5.xbloom.com/?id=tRXq5usokk1tzU2IFE4iZw%3D%3D", "temperature": "hot", "category": "hot"}, {"name": "Ø¨Ø§Ø±Ù‚ Ø¬Ø¯ÙŠØ¯", "author": "Emad", "brewer": "xPod", "dose": "15g", "ratio": "1:15", "link": "https://share-h5.xbloom.com/?id=TQXWjvO%2F3bCAhgN6PTiBPA%3D%3D", "temperature": "hot", "category": "hot"}, {"name": "16 - 90", "author": "Muneera", "brewer": "Omni", "dose": "16g", "ratio": "1:15", "link": "https://share-h5.xbloom.com/?id=TP7yhokZxklUO5aIBUrpYA%3D%3D", "temperature": "hot", "category": "hot"}, {"name": "16;", "author": "Muneera", "brewer": "Omni", "dose": "16g", "ratio": "1:15", "link": "https://share-h5.xbloom.com/?id=TjJpiPL2ChiOf9dVlPderA%3D%3D", "temperature": "hot", "category": "hot"}, {"name": "Ø§Ø«ÙŠÙˆØ¨ÙŠ Ù„Ø§Ù‡ÙˆØ§Ø¦ÙŠ - fzz_81", "author": "Fuad Al Zahrani", "brewer": "Other", "dose": "20g", "ratio": "1:16", "link": "https://share-h5.xbloom.com/?id=TgBHZ8EAVgRyGXfcalqP5A%3D%3D", "temperature": "hot", "category": "hot"}, {"name": "Competition Style", "author": "Mohammed", "brewer": "Omni", "dose": "15g", "ratio": "1:16", "link": "https://share-h5.xbloom.com/?id=TfwI1%2FWL4ZWeo5AwnqW%2BAw%3D%3D", "temperature": "hot", "category": "hot"}, {"name": "OREA", "author": "XBLOOM Adel Badwilan", "brewer": "Omni", "dose": "15g", "ratio": "1:15", "link": "https://share-h5.xbloom.com/?id=Temmj%2FloRVzTyTC4kllPwg%3D%3D", "temperature": "hot", "category": "hot"}, {"name": "Adham - Black Knight", "author": "Khalid Alzeer", "brewer": "xPod", "dose": "15g", "ratio": "1:15", "link": "https://share-h5.xbloom.com/?id=tCrNDPCiRZ16J617YJ%2BBmg%3D%3D", "temperature": "hot", "category": "hot"}, {"name": "Ø¹Ø§Ù„Ù… Ø§Ù„Ù†Ø±Ø¬Ø³", "author": "Anas", "brewer": "Omni", "dose": "15g", "ratio": "1:17", "link": "https://share-h5.xbloom.com/?id=TbLAhkOBCwBzWUPLQZxN%2FQ%3D%3D", "temperature": "hot", "category": "hot"}, {"name": "Ø­Ù…Ø¶ÙŠØ© Ø§ÙƒØ«Ø±", "author": "Ù…Ø­Ù…Ø¯", "brewer": "Other", "dose": "20g", "ratio": "1:6", "link": "https://share-h5.xbloom.com/?id=tbGPB%2B%2BBJ%2FahPjlKdhZTTg%3D%3D", "temperature": "hot", "category": "hot"}, {"name": "ICE RESIPE DRIPPER", "author": "AMR", "brewer": "Other", "dose": "20g", "ratio": "1:7", "link": "https://share-h5.xbloom.com/?id=Tb4BSC2hFxjDLy0vt0ko6A%3D%3D", "temperature": "cold", "category": "cold"}, {"name": "ØªØ¬Ø±Ø¨Ø© Ø´ÙŠØ® Ø§Ù„Ø¨Ø§Ø±Ø¯Ø©", "author": "Wssan", "brewer": "Omni", "dose": "15g", "ratio": "1:11", "link": "https://share-h5.xbloom.com/?id=TA2%2Bvsh1l2WViez8vcSRhQ%3D%3D", "temperature": "cold", "category": "cold"}, {"name": "Ethiopia Colombia Various", "author": "Obaid", "brewer": "Omni", "dose": "15g", "ratio": "1:15", "link": "https://share-h5.xbloom.com/?id=t9CEXxiwTP%2BrBmAAgjz8kg%3D%3D", "temperature": "hot", "category": "hot"}, {"name": "ÙˆØµÙÙ‡ Ù…Ø¹ØªÙ…Ø¯Ø© ğŸ¤", "author": "ÙŠÙˆØ³Ù Ø§Ù„Ø¹Ù…ÙŠØ±ÙŠ", "brewer": "Other", "dose": "15g", "ratio": "1:16", "link": "https://share-h5.xbloom.com/?id=t8QOd3BEu12ZFrQcW9TwhQ%3D%3D", "temperature": "hot", "category": "hot"}, {"name": "Gadeb - ORO", "author": "Khalid Alzeer", "brewer": "Other", "dose": "20g", "ratio": "1:15", "link": "https://share-h5.xbloom.com/?id=szOJ4VoXSiMOuHLzjZ0qqQ%3D%3D", "temperature": "hot", "category": "hot"}, {"name": "FIKRI - BUNAH ğŸ§Š", "author": "Khaled", "brewer": "Omni", "dose": "15g", "ratio": "1:8", "link": "https://share-h5.xbloom.com/?id=SyHQH%2Fcu5k3UzDj79%2BGNxQ%3D%3D", "temperature": "cold", "category": "cold"}, {"name": "ÙˆØµÙÙ‡ ÙŠØ§Ø¨Ø§Ù†ÙŠÙ‡", "author": "Ù£Ù£", "brewer": "xPod", "dose": "15g", "ratio": "1:10", "link": "https://share-h5.xbloom.com/?id=sxRqqKBXHzZ%2B3dI9XrWNnw%3D%3D", "temperature": "hot", "category": "hot"}, {"name": "ÙˆØµÙØ© Ø­Ø§Ø± Ù¡Ù¥", "author": "ADEL SPACE", "brewer": "Omni", "dose": "15g", "ratio": "1:15", "link": "https://share-h5.xbloom.com/?id=swEQnkHq3CBMcaQuoN8epA%3D%3D", "temperature": "hot", "category": "hot"}, {"name": "ØºØ³ÙŠÙ„ Ø§Ù„ÙÙ„ØªØ± ÙˆØªØ³Ø®ÙŠÙ† Ø§Ù„Ø³ÙŠØ±ÙØ± ÙÙ‚Ø·", "author": "Abo A7mad", "brewer": "Other", "dose": "6g", "ratio": "1:5", "link": "https://share-h5.xbloom.com/?id=SqhDigZQvqdzDLZHX%2B55dw%3D%3D", "temperature": "hot", "category": "server"}, {"name": 16, "author": "Muneera", "brewer": "Omni", "dose": "16g", "ratio": "1:15", "link": "https://share-h5.xbloom.com/?id=sosC1hIlAIVOSPAOVRzYdA%3D%3D", "temperature": "hot", "category": "hot"}, {"name": "ÙŠÙ…Ù†ÙŠ Ø­Ø§Ø±", "author": "Ø£Ø¨ÙˆØ¹Ø¨Ø¯Ø§Ù„Ø±Ø­Ù…Ù†", "brewer": "Omni", "dose": "18g", "ratio": "1:16", "link": "https://share-h5.xbloom.com/?id=sLEYnAQ0q8tx6rehosfQHA%3D%3D", "temperature": "hot", "category": "hot"}, {"name": "surge ice Ø§Ù„Ø«Ù„Ø¬ 150", "author": "puresoul.ma", "brewer": "Other", "dose": "20g", "ratio": "1:10", "link": "https://share-h5.xbloom.com/?id=sjyJ%2B43wG%2BHPBIjwTb4%2BPA%3D%3D", "temperature": "cold", "category": "cold"}, {"name": "Ø§ÙŠØ³ Ø¯Ø±ÙŠØ¨/ Ø«Ù„Ø¬ 120", "author": "Muneera", "brewer": "Other", "dose": "25g", "ratio": "1:7", "link": "https://share-h5.xbloom.com/?id=s8WtsKcuyrJQI5PIY%2B111w%3D%3D", "temperature": "cold", "category": "cold"}, {"name": "ÙƒÙˆØ³ØªØ±ÙŠÙƒÙŠ Ù…Ø§Ø²", "author": "Emad", "brewer": "Omni", "dose": "15g", "ratio": "1:15", "link": "https://share-h5.xbloom.com/?id=S4l0boQO5zorMo3dcNRjoA%3D%3D", "temperature": "hot", "category": "hot"}, {"name": "A.Almassari / 21g", "author": "soso", "brewer": "Other", "dose": "21g", "ratio": "1:16", "link": "https://share-h5.xbloom.com/?id=S3ELwgw4kdxR2VdMCrXLWA%3D%3D", "temperature": "hot", "category": "hot"}, {"name": "salem | Kit Kat", "author": "Turky", "brewer": "Other", "dose": "23g", "ratio": "1:7", "link": "https://share-h5.xbloom.com/?id=RY07DCdhTuI5c6WmNylrDQ%3D%3D", "temperature": "hot", "category": "hot"}, {"name": "ØºØ³ÙŠÙ„ Ø§Ù„ÙÙ„ØªØ± ÙˆØªØ³Ø®ÙŠÙ† Ø§Ù„Ø³ÙŠØ±ÙØ± ÙÙ‚Ø·", "author": "Mohammed", "brewer": "Other", "dose": "12g", "ratio": "1:5", "link": "https://share-h5.xbloom.com/?id=rxI5iCfD40W2nGGRT2Bveg%3D%3D", "temperature": "hot", "category": "server"}, {"name": "15GØ³Ø¹Ø¯", "author": "Ø£Ø¨ÙˆØ¹Ø¨Ø¯Ø§Ù„Ø±Ø­Ù…Ù†", "brewer": "Omni", "dose": "15g", "ratio": "1:15", "link": "https://share-h5.xbloom.com/?id=RseBEJ1SPqNCYtRc42A2aQ%3D%3D", "temperature": "hot", "category": "hot"}, {"name": "Ø§ÙŠØ³ Ø¯Ø±Ø¨ Ø§Ù„Ù…Ø¹ÙŠÙˆÙˆÙˆÙˆÙ", "author": "Abdullah", "brewer": "Other", "dose": "25g", "ratio": "1:7", "link": "https://share-h5.xbloom.com/?id=rrVVHC9fNZta1OALynKvwQ%3D%3D", "temperature": "cold", "category": "cold"}, {"name": "20 -", "author": "Muneera", "brewer": "Other", "dose": "20g", "ratio": "1:15", "link": "https://share-h5.xbloom.com/?id=Ro4gBFqRFQj7AJa8b8IIXA%3D%3D", "temperature": "hot", "category": "hot"}, {"name": "15G", "author": "Muneera", "brewer": "Omni", "dose": "15g", "ratio": "1:15", "link": "https://share-h5.xbloom.com/?id=RO0kBSTUMPTra1FPw8C9oQ%3D%3D", "temperature": "hot", "category": "hot"}, {"name": "mod2", "author": "mod", "brewer": "Other", "dose": "22g", "ratio": "1:8", "link": "https://share-h5.xbloom.com/?id=RnYjWJnqTVg29%2BpoVbTcBw%3D%3D", "temperature": "hot", "category": "hot"}, {"name": "ÙƒÙˆÙ„Ù…Ø¨ÙŠ Ù…Ø§Ø±ÙŠÙ†Ø² Ù¨Ù¨â€¢", "author": "Emad", "brewer": "xPod", "dose": "15g", "ratio": "1:13", "link": "https://share-h5.xbloom.com/?id=rM2J0Ae7UAo%2Bj64QiIaI8Q%3D%3D", "temperature": "hot", "category": "hot"}, {"name": "ÙˆØµÙØ© 15 Ø¬Ø±Ø§Ù… Ø§Ø«ÙŠÙˆØ¨ÙŠ", "author": "Ø£Ø¨ÙˆØ¹Ø¨Ø¯Ø§Ù„Ø±Ø­Ù…Ù†", "brewer": "Omni", "dose": "15g", "ratio": "1:15", "link": "https://share-h5.xbloom.com/?id=rkxIuPLkuqxs4hp5qA5wMg%3D%3D", "temperature": "hot", "category": "hot"}, {"name": "AboAseeL 20g | ice coffee", "author": "AbuAljawhara", "brewer": "Other", "dose": "20g", "ratio": "1:7", "link": "https://share-h5.xbloom.com/?id=rK27Q5wjkZhMPZphyTU0KQ%3D%3D", "temperature": "cold", "category": "cold"}, {"name": "ÙƒÙˆØ³ØªØ±ÙŠÙƒØ§", "author": "mf", "brewer": "Other", "dose": "20g", "ratio": "1:14", "link": "https://share-h5.xbloom.com/?id=rcHwLHPS%2FOj810jNZJaI3g%3D%3D", "temperature": "hot", "category": "hot"}, {"name": "Gadeb - ORO", "author": "Aziz", "brewer": "xPod", "dose": "15g", "ratio": "1:15", "link": "https://share-h5.xbloom.com/?id=RC9IGAQY%2Fd77eT13iqmelg%3D%3D", "temperature": "hot", "category": "hot"}, {"name": "Ø§ÙƒØ³ÙŠÙ„Ø³Ùˆ 20", "author": "Ø£Ø¨ÙˆØ¹Ø¨Ø¯Ø§Ù„Ø±Ø­Ù…Ù†", "brewer": "Other", "dose": "20g", "ratio": "1:15", "link": "https://share-h5.xbloom.com/?id=R8EDgdY4dnkaJYszzNthIA%3D%3D", "temperature": "hot", "category": "hot"}, {"name": "ØºØ³ÙŠÙ„ Ø§Ù„ÙÙ„ØªØ±", "author": "AMR", "brewer": "Other", "dose": "7g", "ratio": "1:5", "link": "https://share-h5.xbloom.com/?id=r%2BoRJ6zzfCIm9crPBRGl3A%3D%3D", "temperature": "hot", "category": "server"}, {"name": "ice ( test )", "author": "Faisal", "brewer": "Omni", "dose": "15g", "ratio": "1:10", "link": "https://share-h5.xbloom.com/?id=qw8P0CQoGte%2F9EtZwADvAA%3D%3D", "temperature": "cold", "category": "cold"}, {"name": "Ø¹ØªØ§Ø±Ø© | Ø§Ù„ÙŠÙ…Ù† Ù…Ø­Ù…ØµØ© Ø³Ù„ÙˆØ¨", "author": "Abdullah", "brewer": "Other", "dose": "15g", "ratio": "1:15", "link": "https://share-h5.xbloom.com/?id=qroTtQRUKiXCrIyJoT8UzA%3D%3D", "temperature": "hot", "category": "hot"}, {"name": "Kiffa Roastery", "author": "", "brewer": "xPod", "dose": "15g", "ratio": "1:15", "link": "https://share-h5.xbloom.com/?id=qR140y%2BXxyQASeS3DZXImQ%3D%3D", "temperature": "hot", "category": "hot"}, {"name": "surge ice Ø§Ù„Ø«Ù„Ø¬ 150", "author": "Omar", "brewer": "Other", "dose": "15g", "ratio": "1:7", "link": "https://share-h5.xbloom.com/?id=QnD4NfBVSqio5gZZP7HqEA%3D%3D", "temperature": "cold", "category": "cold"}, {"name": "Ø¯ÙŠ ÙƒØ§Ù Ø¨Ù„Ø§Ùƒ Ù†Ø§ÙŠØª", "author": "ABDULLAH", "brewer": "Omni", "dose": "18g", "ratio": "1:15", "link": "https://share-h5.xbloom.com/?id=QK638U0p%2BSsZ3nKptAVdPw%3D%3D", "temperature": "hot", "category": "hot"}, {"name": "Arriyadh AlShumaisi", "author": "", "brewer": "xPod", "dose": "15g", "ratio": "1:16", "link": "https://share-h5.xbloom.com/?id=qJpIulp30YY0ntE4BDVYVw%3D%3D", "temperature": "hot", "category": "hot"}, {"name": "20g Colombia with grind|Aseel", "author": "faisal", "brewer": "Other", "dose": "20g", "ratio": "1:15", "link": "https://share-h5.xbloom.com/?id=Qgrt5AXA6GgZAI%2BvjSVb7A%3D%3D", "temperature": "hot", "category": "hot"}, {"name": "classic", "author": "Abdul", "brewer": "Other", "dose": "20g", "ratio": "1:15", "link": "https://share-h5.xbloom.com/?id=qEuveC5bkKTtpOwc8Xyepg%3D%3D", "temperature": "hot", "category": "hot"}, {"name": "AboAseeL 20g | Ethiopia", "author": "Abdullah", "brewer": "Other", "dose": "20g", "ratio": "1:15", "link": "https://share-h5.xbloom.com/?id=q9WFWqNq3qmQ3E6BfdlE4w%3D%3D", "temperature": "hot", "category": "hot"}, {"name": "shindawa 20g.2", "author": "Turki", "brewer": "Other", "dose": "20g", "ratio": "1:15", "link": "https://share-h5.xbloom.com/?id=Q1JUbEcEc%2Fn6f6Xfrvzmtg%3D%3D", "temperature": "hot", "category": "hot"}, {"name": "Black Knight - Adham", "author": "Abdullah", "brewer": "xPod", "dose": "15g", "ratio": "1:15", "link": "https://share-h5.xbloom.com/?id=PQ0OFVXJxVQgkhEZevTQlg%3D%3D", "temperature": "hot", "category": "hot"}, {"name": "ÙˆØµÙØ© 25", "author": "Muneera", "brewer": "Other", "dose": "25g", "ratio": "1:15", "link": "https://share-h5.xbloom.com/?id=pp7q1iN1FY%2FTYnkC2taRbg%3D%3D", "temperature": "hot", "category": "hot"}, {"name": "4 Pour ice", "author": "Qvsai", "brewer": "Other", "dose": "25g", "ratio": "1:8", "link": "https://share-h5.xbloom.com/?id=PmUeaaFFpGzTzimTVnnA%2Bg%3D%3D", "temperature": "cold", "category": "cold"}, {"name": "Ø´Ù…Ø§Ù… ÙƒÙˆÙ„ÙˆÙ…Ø¨ÙŠ - Ø­Ø§Ø±", "author": "Turky", "brewer": "Other", "dose": "20g", "ratio": "1:15", "link": "https://share-h5.xbloom.com/?id=pkSB6xkhBKOCbDgTF7lGdw%3D%3D", "temperature": "hot", "category": "hot"}, {"name": "Bait Hameed 25G | Yemen", "author": "Hadeel", "brewer": "Other", "dose": "25g", "ratio": "1:15", "link": "https://share-h5.xbloom.com/?id=p3G6OpLof7tIpptZ89h1Ew%3D%3D", "temperature": "hot", "category": "hot"}, {"name": "High Sweetness ğŸ¯", "author": "Mohammed Ali", "brewer": "Other", "dose": "20g", "ratio": "1:15", "link": "https://share-h5.xbloom.com/?id=P2Cbld7rtCLmDSFWX4sBhA%3D%3D", "temperature": "hot", "category": "hot"}, {"name": "ØªÙŠØ§Ù†Ù…Ùˆ Ø§ÙˆÙ„Ø§Ù„Ø§ Ø§Ù„ØµÙŠÙ† Ù„Ø§Ù‡ÙˆØ§Ø¦ÙŠ", "author": "Abdullah", "brewer": "Omni", "dose": "15g", "ratio": "1:15", "link": "https://share-h5.xbloom.com/?id=OXjZlsQONUc7mzpTpFjwkw%3D%3D", "temperature": "hot", "category": "hot"}, {"name": "IDMI Cost Arica Hacienda", "author": "Bassam", "brewer": "Other", "dose": "20g", "ratio": "1:15", "link": "https://share-h5.xbloom.com/?id=oqPw7EGBc12G1Zs0ySSaYw%3D%3D", "temperature": "hot", "category": "hot"}, {"name": "Suwaa - Huila", "author": "", "brewer": "xPod", "dose": "15g", "ratio": "1:15", "link": "https://share-h5.xbloom.com/?id=oq2fF8MvpSGGcQL3TegrNA%3D%3D", "temperature": "hot", "category": "hot"}, {"name": "Ø­ØµÙ† Ø°Ø±ÙˆØ§Ù† | Dhurwan Fort", "author": "BK", "brewer": "Omni", "dose": "18g", "ratio": "1:15", "link": "https://share-h5.xbloom.com/?id=OpDGSeJmcIiE8bWoksPhJw%3D%3D", "temperature": "hot", "category": "hot"}, {"name": "A.Almassari / 21g", "author": "A.Almassari", "brewer": "Other", "dose": "21g", "ratio": "1:16", "link": "https://share-h5.xbloom.com/?id=ojzjuIVwQ%2BbnbssroaBa%2BQ%3D%3D", "temperature": "hot", "category": "hot"}, {"name": "ÙƒÙˆÙ„Ø¯ Ø¨Ø±Ùˆ", "author": "Ali", "brewer": "Other", "dose": "20g", "ratio": "1:7", "link": "https://share-h5.xbloom.com/?id=OIgZS%2FMQJCieDEl%2FYq3Qgw%3D%3D", "temperature": "hot", "category": "hot"}, {"name": "Ù¢Ù  Ø¬Ø±Ø§Ù… Ø§ÙˆÙ…Ù†ÙŠ", "author": "Ø£Ø¨ÙˆØ¹Ø¨Ø¯Ø§Ù„Ø±Ø­Ù…Ù†", "brewer": "Other", "dose": "20g", "ratio": "1:15", "link": "https://share-h5.xbloom.com/?id=OfGxwsORs%2Fs23Y%2F3tXXZSA%3D%3D", "temperature": "hot", "category": "hot"}, {"name": "ØºØ³ÙŠÙ„ Ø§Ù„ÙÙ„ØªØ± ÙˆØªØ³Ø®ÙŠÙ† Ø§Ù„Ø³ÙŠØ±ÙØ± ÙÙ‚Ø·", "author": "ABH", "brewer": "Other", "dose": "6g", "ratio": "1:5", "link": "https://share-h5.xbloom.com/?id=oa4SpZfbZUzHIc7As9qGSQ%3D%3D", "temperature": "hot", "category": "server"}, {"name": "15g creative recipe", "author": "Khalid Alzeer", "brewer": "xPod", "dose": "15g", "ratio": "1:15", "link": "https://share-h5.xbloom.com/?id=O6%2FCxhQAho08imQcgMACDQ%3D%3D", "temperature": "hot", "category": "hot"}, {"name": "soil guji harmony", "author": "Ù…Ø´Ø§Ø±ÙŠ", "brewer": "Other", "dose": "18g", "ratio": "1:15", "link": "https://share-h5.xbloom.com/?id=O11JHNsWS%2BbPAA%2Fwg63lsA%3D%3D", "temperature": "hot", "category": "hot"}, {"name": "abusara7 N", "author": "Abusara7", "brewer": "Other", "dose": "21g", "ratio": "1:15", "link": "https://share-h5.xbloom.com/?id=O%2F9r83o%2BLWqhigz2nMkeOw%3D%3D", "temperature": "hot", "category": "hot"}, {"name": "Sulalat - Chelechle", "author": "Specialty Hub", "brewer": "xPod", "dose": "15g", "ratio": "1:10", "link": "https://share-h5.xbloom.com/?id=o%2BmPCOTenSNMF4JVd0YcWA%3D%3D", "temperature": "hot", "category": "hot"}, {"name": "Ù…Ø°Ù‡Ù„Ø© Ù…Ø­Ù…ØµØ© OYW", "author": "Abdullah", "brewer": "Omni", "dose": "15g", "ratio": "1:15", "link": "https://share-h5.xbloom.com/?id=nZwxyoka%2B08oF2YsQ7rCmw%3D%3D", "temperature": "hot", "category": "hot"}, {"name": "Ø±ÙˆÙ†Ø§Ù„Ø¯Ùˆ | Ronaldo", "author": "BK", "brewer": "Omni", "dose": "18g", "ratio": "1:15", "link": "https://share-h5.xbloom.com/?id=nqRsA7a6SG0u1ETyz%2B9sTw%3D%3D", "temperature": "hot", "category": "hot"}, {"name": "AboAseeL 20g | Ethiopia", "author": "AbuAljawhara", "brewer": "Other", "dose": "20g", "ratio": "1:15", "link": "https://share-h5.xbloom.com/?id=nmxMQ8KkAOBzAOXlrIzttw%3D%3D", "temperature": "hot", "category": "hot"}, {"name": "Ø§Ù„ÙŠÙ…Ù† Ø­Ø±Ø§Ø² Ù…ØµÙ†Ø¹ Ø§Ù„Ù‚Ù‡ÙˆØ© 20g", "author": "ABDULHMEAD", "brewer": "Other", "dose": "20g", "ratio": "1:15", "link": "https://share-h5.xbloom.com/?id=NkxEVNpF348Np7Xmt6t77A%3D%3D", "temperature": "hot", "category": "hot"}, {"name": "12G", "author": "Muneera", "brewer": "Omni", "dose": "12g", "ratio": "1:15", "link": "https://share-h5.xbloom.com/?id=NGgyLAMLhPkojpCCKFWS6w%3D%3D", "temperature": "hot", "category": "hot"}, {"name": "ÙƒÙˆØ³ØªØ§Ø±ÙŠÙƒØ§ Ù…Ø§Ø±ÙŠØ§Ø§ Ù…Ø¬ÙÙ", "author": "Fuad Al Zahrani", "brewer": "Omni", "dose": "15g", "ratio": "1:16", "link": "https://share-h5.xbloom.com/?id=nAOckMAjfez7hg2gKaKmHw%3D%3D", "temperature": "hot", "category": "hot"}, {"name": "ÙˆØµÙØ© 18gØŒ Ù…Ø­Ø§ØµÙŠÙ„ Ø³Ø¹ÙˆØ¯ÙŠØ©ØŒÙŠÙ…Ù†ÙŠØ©", "author": "Fndesign", "brewer": "Omni", "dose": "18g", "ratio": "1:15", "link": "https://share-h5.xbloom.com/?id=MZCo%2B1i1BWok20gfIk09iw%3D%3D", "temperature": "hot", "category": "hot"}, {"name": "ice 150 ,ğŸ¤”", "author": "Suroor", "brewer": "Other", "dose": "20g", "ratio": "1:7", "link": "https://share-h5.xbloom.com/?id=muoUlB7TBi0126jDex2Q8g%3D%3D", "temperature": "cold", "category": "cold"}, {"name": "18G..", "author": "Muneera", "brewer": "Omni", "dose": "18g", "ratio": "1:15", "link": "https://share-h5.xbloom.com/?id=ms75ZXmJd%2F1aAX22MXUc8g%3D%3D", "temperature": "hot", "category": "hot"}, {"name": "abusara7 N", "author": "Abdullah", "brewer": "Omni", "dose": "15g", "ratio": "1:15", "link": "https://share-h5.xbloom.com/?id=MrDp8A6r05H%2Filcq9ULUqQ%3D%3D", "temperature": "hot", "category": "hot"}, {"name": "Ø³Ù„ÙØ¯ÙˆØ± ØªØ´Ø§Ø±Ø¬", "author": "Emad", "brewer": "Omni", "dose": "15g", "ratio": "1:15", "link": "https://share-h5.xbloom.com/?id=MOzdHIzgBjXUC9PH3mDt%2Fw%3D%3D", "temperature": "hot", "category": "hot"}, {"name": "Ice Drip25", "author": "ABH", "brewer": "Other", "dose": "20g", "ratio": "1:8", "link": "https://share-h5.xbloom.com/?id=MLQuyuC47BcmoF0TETd%2FRg%3D%3D", "temperature": "cold", "category": "cold"}, {"name": "16g..", "author": "Muneera", "brewer": "Omni", "dose": "16g", "ratio": "1:15", "link": "https://share-h5.xbloom.com/?id=MJvMMfjOKW2rnN9Vp9ePag%3D%3D", "temperature": "hot", "category": "hot"}, {"name": "Ø§Ø«ÙŠÙˆØ¨ÙŠ Ù…Ø§Ø²", "author": "Khaled", "brewer": "xPod", "dose": "15g", "ratio": "1:14", "link": "https://share-h5.xbloom.com/?id=MiUvxFcQpofP1QuSy%2FOG%2FA%3D%3D", "temperature": "hot", "category": "hot"}, {"name": "Ø´ÙŠÙ„Ø³Ù„ÙŠ Ø³Ù„Ø§Ù„Ø§Øª Ù¡Ù¥ Ø¬", "author": "ÙŠÙˆØ³Ù Ø§Ù„Ø¹Ù…ÙŠØ±ÙŠ", "brewer": "Other", "dose": "15g", "ratio": "1:15", "link": "https://share-h5.xbloom.com/?id=mIGxr%2FiFpnlnp3ZHfIm8sw%3D%3D", "temperature": "hot", "category": "hot"}, {"name": "A", "author": "Ali", "brewer": "Other", "dose": "20g", "ratio": "1:15", "link": "https://share-h5.xbloom.com/?id=Ma%2F16weQvbNEYspvJnUP8Q%3D%3D", "temperature": "hot", "category": "hot"}, {"name": "ÙØ±Ø§ÙˆÙ„Ø© Ø±ÙˆÙ„ Ø¨Ø§Ø±Ø¯Ù¡Ù¥Ø¬ Ù…ØµÙ†Ø¹ Ø§Ù„Ù‚Ù‡ÙˆØ©", "author": "ABDULHMEAD", "brewer": "Omni", "dose": "15g", "ratio": "1:11", "link": "https://share-h5.xbloom.com/?id=m5sehtkocFgl%2BDDSPpzV4g%3D%3D", "temperature": "cold", "category": "cold"}, {"name": "Soil - Guji", "author": "Specialty Hub", "brewer": "xPod", "dose": "15g", "ratio": "1:10", "link": "https://share-h5.xbloom.com/?id=m5m39U5SDhRF%2FjdM3KSS9w%3D%3D", "temperature": "hot", "category": "hot"}, {"name": "natural fermentation beansğŸ§Š", "author": "SA", "brewer": "Omni", "dose": "15g", "ratio": "1:8", "link": "https://share-h5.xbloom.com/?id=m58xceXg5UrJsyNVPWyW4w%3D%3D", "temperature": "cold", "category": "cold"}, {"name": "The big barista", "author": "Omar", "brewer": "Omni", "dose": "18g", "ratio": "1:14", "link": "https://share-h5.xbloom.com/?id=M0uoZlDb%2FzGllFJIW7l1dg%3D%3D", "temperature": "hot", "category": "hot"}, {"name": "slope", "author": "Muneera", "brewer": "Other", "dose": "20g", "ratio": "1:15", "link": "https://share-h5.xbloom.com/?id=LYYQlew9ndISEZf8wRs8Jw%3D%3D", "temperature": "hot", "category": "hot"}, {"name": "Ù…Ø§Ù†Ø§Ù†Ø§Ø³ÙŠ Oro", "author": "Ali", "brewer": "Omni", "dose": "18g", "ratio": "1:15", "link": "https://share-h5.xbloom.com/?id=luleqEawHeVg7e7Ux16gtQ%3D%3D", "temperature": "hot", "category": "hot"}, {"name": "SOIL. GUJI", "author": "soil", "brewer": "xPod", "dose": "15g", "ratio": "1:15", "link": "https://share-h5.xbloom.com/?id=lqY24uVRMPoqTVpgsFwQAg%3D%3D", "temperature": "hot", "category": "hot"}, {"name": "BlackSip Watermelon Cold", "author": "ahmad", "brewer": "Other", "dose": "20g", "ratio": "1:8", "link": "https://share-h5.xbloom.com/?id=lpPQuDvmXkvJIGQzB%2B5T3w%3D%3D", "temperature": "cold", "category": "cold"}, {"name": "ØºØ³ÙŠÙ„", "author": "Turky", "brewer": "Other", "dose": "10g", "ratio": "1:7", "link": "https://share-h5.xbloom.com/?id=lpDriV6DNu6Ohf4tT1Dl6g%3D%3D", "temperature": "hot", "category": "server"}, {"name": "ÙˆØµÙÙ‡ 15 ØºØ±Ø§Ù…", "author": "Ghazi", "brewer": "Omni", "dose": "15g", "ratio": "1:16", "link": "https://share-h5.xbloom.com/?id=LDyP1OcWT3hZcCX12nrUuQ%3D%3D", "temperature": "hot", "category": "hot"}, {"name": "20g Colombia 180 ice", "author": "M", "brewer": "Other", "dose": "20g", "ratio": "1:9", "link": "https://share-h5.xbloom.com/?id=lDMV3jgrCYmJ%2FgsTy4gkxg%3D%3D", "temperature": "cold", "category": "cold"}, {"name": "KAMAL 9x", "author": "KAMAL ALRAWHANI", "brewer": "Omni", "dose": "18g", "ratio": "1:15", "link": "https://share-h5.xbloom.com/?id=L0eCSa9l5EqPjPCjIYPhsQ%3D%3D", "temperature": "hot", "category": "hot"}, {"name": "ØªØ¬Ø±Ø¨Ø© Ø´ÙŠØ® Ø§Ù„Ø¨Ø§Ø±Ø¯Ø©", "author": "Hider Ali", "brewer": "Omni", "dose": "15g", "ratio": "1:11", "link": "https://share-h5.xbloom.com/?id=KZXMjL2SZE9yixHcUBvwyw%3D%3D", "temperature": "cold", "category": "cold"}, {"name": "Ù¤ ØµØ¨Ø§Øª Ø·Ø­Ù† Ø³ÙˆÙŠÙ„ Ø´ÙŠÙ„Ø´Ù„ÙŠ 15 Ø¬", "author": "Abdullah", "brewer": "Other", "dose": "15g", "ratio": "1:15", "link": "https://share-h5.xbloom.com/?id=kzABcLIfs1ctHatV%2F%2BiBHg%3D%3D", "temperature": "hot", "category": "hot"}, {"name": "faisal younis Xpods 6T", "author": "SHADDAD", "brewer": "xPod", "dose": "15g", "ratio": "1:15", "link": "https://share-h5.xbloom.com/?id=KycHhRpushnbcgYMMJZ88Q%3D%3D", "temperature": "hot", "category": "hot"}, {"name": "ice coffee", "author": "Ali", "brewer": "Other", "dose": "20g", "ratio": "1:7", "link": "https://share-h5.xbloom.com/?id=krOsQGpAjwfHTFmefJwwdg%3D%3D", "temperature": "cold", "category": "cold"}, {"name": "AboAseeL 20g | ice coffee", "author": "faisal", "brewer": "Other", "dose": "20g", "ratio": "1:7", "link": "https://share-h5.xbloom.com/?id=kqQR5FxHNFb4MdWjxcFA3w%3D%3D", "temperature": "cold", "category": "cold"}, {"name": "M.15", "author": "Muneera", "brewer": "Omni", "dose": "15g", "ratio": "1:15", "link": "https://share-h5.xbloom.com/?id=kOmewFPhoLTkrtXW7N6MMQ%3D%3D", "temperature": "hot", "category": "hot"}, {"name": "15g - Fruit", "author": "Abdulaziz", "brewer": "Omni", "dose": "15g", "ratio": "1:17", "link": "https://share-h5.xbloom.com/?id=kMQtPOJa%2FTrz7eZkIYxwRQ%3D%3D", "temperature": "hot", "category": "hot"}, {"name": "22;", "author": "Muneera", "brewer": "Other", "dose": "22g", "ratio": "1:15", "link": "https://share-h5.xbloom.com/?id=Kj2JFoQUy1608RbhmPyTow%3D%3D", "temperature": "hot", "category": "hot"}, {"name": "GPT - Al-Shumaisi 15g", "author": "Abdullah", "brewer": "Omni", "dose": "15g", "ratio": "1:16", "link": "https://share-h5.xbloom.com/?id=kESyUeduhUKXITEVUV5cjA%3D%3D", "temperature": "hot", "category": "hot"}, {"name": "18G", "author": "Muneera", "brewer": "Omni", "dose": "18g", "ratio": "1:15", "link": "https://share-h5.xbloom.com/?id=kdAQr03Tk1s0ecmNa16KIg%3D%3D", "temperature": "hot", "category": "hot"}, {"name": "AboAseeL 20g | Ethiopia", "author": "Hadeel", "brewer": "Other", "dose": "20g", "ratio": "1:15", "link": "https://share-h5.xbloom.com/?id=kC8lnveKhEf5FpwsQ4OF5g%3D%3D", "temperature": "hot", "category": "hot"}, {"name": "ØªÙŠØ§Ù†Ù…Ùˆ Ø§ÙˆÙ„Ø§Ù„Ø§ 15g Ø¨Ø§Ø±Ø¯", "author": "Abdullah", "brewer": "Omni", "dose": "15g", "ratio": "1:10", "link": "https://share-h5.xbloom.com/?id=kBRNMiiYtKl8KCZUiwfrNw%3D%3D", "temperature": "cold", "category": "cold"}, {"name": "ÙˆØµÙØ© Ù…Ø¹ØªÙ…Ø¯Ø© 15 ğŸ’›ğŸ’›", "author": "ÙŠÙˆØ³Ù Ø§Ù„Ø¹Ù…ÙŠØ±ÙŠ", "brewer": "Other", "dose": "15g", "ratio": "1:16", "link": "https://share-h5.xbloom.com/?id=K3Kib2OPjfUUQU1npdCeKg%3D%3D", "temperature": "hot", "category": "hot"}, {"name": "Classic Ice Drip", "author": "Abdul", "brewer": "Other", "dose": "20g", "ratio": "1:9", "link": "https://share-h5.xbloom.com/?id=K1rdIPRbzYcvqtRm4YmZdw%3D%3D", "temperature": "cold", "category": "cold"}, {"name": "Seen 19g ğŸ’³ Ø§Ø«ÙŠÙˆØ¨ÙŠ", "author": "khaled", "brewer": "Omni", "dose": "15g", "ratio": "1:15", "link": "https://share-h5.xbloom.com/?id=jzeV0rmlZfrWP8A5OU14JQ%3D%3D", "temperature": "hot", "category": "hot"}, {"name": "Ø¯ÙŠØ§Ø±", "author": "Emad", "brewer": "xPod", "dose": "15g", "ratio": "1:15", "link": "https://share-h5.xbloom.com/?id=jXAKonLop3xpfWyYnjy8og%3D%3D", "temperature": "hot", "category": "hot"}, {"name": "Black Night", "author": "Turky", "brewer": "Omni", "dose": "15g", "ratio": "1:16", "link": "https://share-h5.xbloom.com/?id=JPuE66m4y%2FDnIeLuR%2FnDJw%3D%3D", "temperature": "hot", "category": "hot"}, {"name": "A", "author": "Waleed Alotaibi", "brewer": "Other", "dose": "20g", "ratio": "1:15", "link": "https://share-h5.xbloom.com/?id=JnZLkfjbHXo2uNv0ei5QKg%3D%3D", "temperature": "hot", "category": "hot"}, {"name": "15GØ³Ø¹Ø¯", "author": "Ù…Ø­Ù…Ø¯", "brewer": "Omni", "dose": "15g", "ratio": "1:15", "link": "https://share-h5.xbloom.com/?id=jg9yDcT52MJUBloUF8fwRw%3D%3D", "temperature": "hot", "category": "hot"}, {"name": "AboAseeL 20g | ice coffee", "author": "Mohammad", "brewer": "Other", "dose": "20g", "ratio": "1:7", "link": "https://share-h5.xbloom.com/?id=JFrvKOFkK0JeNEdL%2FwPRAw%3D%3D", "temperature": "cold", "category": "cold"}, {"name": "Ø¨Ù„Ø§Ùƒ Ù†Ø§ÙŠØª Ø®ÙˆØ® 170 Ù‚Ø±Ø§Ù… Ø«Ù„Ø¬", "author": "sloom", "brewer": "Other", "dose": "25g", "ratio": "1:7", "link": "https://share-h5.xbloom.com/?id=Jesju4Jr%2F3ZKEP2OII6vlw%3D%3D", "temperature": "cold", "category": "cold"}, {"name": "iesss", "author": "Abdulmailk", "brewer": "Omni", "dose": "18g", "ratio": "1:10", "link": "https://share-h5.xbloom.com/?id=JegxlZmzRaFtBkWCpfCGSQ%3D%3D", "temperature": "hot", "category": "hot"}, {"name": "ÙˆØµÙØªÙŠ Ø§Ù„Ø®Ø§ØµÙ‡ Ø±Ù‚Ù… 2", "author": "Bader", "brewer": "Omni", "dose": "18g", "ratio": "1:15", "link": "https://share-h5.xbloom.com/?id=jdQZImafA%2B5R7npRet3RjQ%3D%3D", "temperature": "hot", "category": "hot"}, {"name": "Ø§Ù„Ø¥ÙŠØ­Ø§Ø¡Ø§Øª", "author": "abdullah aqil", "brewer": "Omni", "dose": "15g", "ratio": "1:17", "link": "https://share-h5.xbloom.com/?id=JC%2BL0uxKaHadpm4yI%2BNE1Q%3D%3D", "temperature": "hot", "category": "hot"}, {"name": "ÙÙŠØµÙ„ ÙŠÙˆÙ†Ø³ - ÙƒØ¨ÙŠØ±", "author": "MF", "brewer": "Other", "dose": "22g", "ratio": "1:16", "link": "https://share-h5.xbloom.com/?id=jA5ZTA%2FZAXQE2Le3OTrP9Q%3D%3D", "temperature": "hot", "category": "hot"}, {"name": "ÙˆØµÙÙ‡ 15 ØºØ±Ø§Ù…", "author": "Ali", "brewer": "Omni", "dose": "15g", "ratio": "1:16", "link": "https://share-h5.xbloom.com/?id=j%2BvT14%2F%2Blm4V%2FG4KFDODjA%3D%3D", "temperature": "hot", "category": "hot"}, {"name": "Ø¨Ø§Ø±Ø¯ Ù¡Ù¥Ù  Ø«Ù„Ø¬ Ù¢Ù  Ø¬", "author": "Majed", "brewer": "Other", "dose": "20g", "ratio": "1:6", "link": "https://share-h5.xbloom.com/?id=iZk4tg1P9vfTHdiipcD%2BxQ%3D%3D", "temperature": "cold", "category": "cold"}, {"name": "RICARDO . trivali , Ice 20g", "author": "Ø¹Ø§Ø¦Ø¶ Ø§Ù„Ø¹ØªÙŠØ¨ÙŠ", "brewer": "Other", "dose": "21g", "ratio": "1:7", "link": "https://share-h5.xbloom.com/?id=IwAkBhJcWbAtfjn61iOzAQ%3D%3D", "temperature": "cold", "category": "cold"}, {"name": "Arriyadh - AlShumaisi", "author": "Specialty Hub", "brewer": "xPod", "dose": "15g", "ratio": "1:16", "link": "https://share-h5.xbloom.com/?id=iQXZKyfZZWZ3qJ9%2B21K%2FVw%3D%3D", "temperature": "hot", "category": "hot"}, {"name": "ice drip - Ø§Ù„Ø«Ù„Ø¬ 100 Ù‚Ø±Ø§Ù…", "author": "Muneera", "brewer": "Other", "dose": "20g", "ratio": "1:7", "link": "https://share-h5.xbloom.com/?id=ILsCz3GN6Htr1DFtSzNCZg%3D%3D", "temperature": "cold", "category": "cold"}, {"name": "Abla Roastery 20g Ethiopia4", "author": "Hadeel", "brewer": "Other", "dose": "20g", "ratio": "1:15", "link": "https://share-h5.xbloom.com/?id=iKDcCuViwydHfN%2FIqtYQmA%3D%3D", "temperature": "hot", "category": "hot"}, {"name": "ice Yameine", "author": "Aziz's", "brewer": "Omni", "dose": "18g", "ratio": "1:8", "link": "https://share-h5.xbloom.com/?id=ij3jO13xQqrFgA3bCI%2FBPA%3D%3D", "temperature": "cold", "category": "cold"}, {"name": "ğŸ˜´ğŸ˜´", "author": "Khalifa", "brewer": "Omni", "dose": "15g", "ratio": "1:17", "link": "https://share-h5.xbloom.com/?id=IHjPVu5J%2B01j3fzeQOVyCQ%3D%3D", "temperature": "hot", "category": "hot"}, {"name": "ice drip 17g", "author": "Reem", "brewer": "Omni", "dose": "17g", "ratio": "1:9", "link": "https://share-h5.xbloom.com/?id=IAGy8o8CWc5qNNgU4gOscA%3D%3D", "temperature": "cold", "category": "cold"}, {"name": "117 Ø«Ù„Ø¬", "author": "Bandar", "brewer": "Other", "dose": "18g", "ratio": "1:6", "link": "https://share-h5.xbloom.com/?id=I0sRNKzn1nKNnpz5%2BjYmNg%3D%3D", "temperature": "cold", "category": "cold"}, {"name": "El Silvador Norah", "author": "Abdullah", "brewer": "Omni", "dose": "18g", "ratio": "1:15", "link": "https://share-h5.xbloom.com/?id=I%2FzKG70N%2Fedg9D2sfIopxQ%3D%3D", "temperature": "hot", "category": "hot"}, {"name": "Ù‚ÙˆØªÙ‡ Ø³Ù„ÙØ§Ø¯ÙˆØ± ØªÙˆØ±ÙˆÙ„Ø§ Ù…ØºØ³ÙˆÙ„ Ø­Ø§Ø±", "author": "Yousef Alharbi", "brewer": "Other", "dose": "20g", "ratio": "1:15", "link": "https://share-h5.xbloom.com/?id=HPMYy0G1q4y2cTjKm6Hplw%3D%3D", "temperature": "hot", "category": "hot"}, {"name": "Coffee of The Day", "author": "", "brewer": "xPod", "dose": "15g", "ratio": "1:15", "link": "https://share-h5.xbloom.com/?id=HpMXbY5K4tGRV39vvAIJMw%3D%3D", "temperature": "hot", "category": "hot"}, {"name": "ÙˆØµÙØ© Ù„Ø§Ù…Ø§ - Ø«Ù„Ø¬ 100", "author": "Muneera", "brewer": "Other", "dose": "15g", "ratio": "1:7", "link": "https://share-h5.xbloom.com/?id=Hn3COMgKN9n5Ic1alSNleQ%3D%3D", "temperature": "cold", "category": "cold"}, {"name": "kiffa", "author": "Khalid Alzeer", "brewer": "xPod", "dose": "15g", "ratio": "1:15", "link": "https://share-h5.xbloom.com/?id=HLVun57Owy9mIGO8xKYJ0A%3D%3D", "temperature": "hot", "category": "hot"}, {"name": "iced qayel ali - Ø®Ø§Ù„Ø¯", "author": "KHALED", "brewer": "Omni", "dose": "18g", "ratio": "1:10", "link": "https://share-h5.xbloom.com/?id=HIHXWqBzA45ruB7f0B%2FzBA%3D%3D", "temperature": "cold", "category": "cold"}, {"name": "30 Ù‚Ø±Ø§Ù…", "author": "Muneera", "brewer": "Other", "dose": "25g", "ratio": "1:18", "link": "https://share-h5.xbloom.com/?id=h2jb7hWx9N6HUsaCAVf5jQ%3D%3D", "temperature": "hot", "category": "hot"}, {"name": "15pod", "author": "Muneera", "brewer": "xPod", "dose": "15g", "ratio": "1:15", "link": "https://share-h5.xbloom.com/?id=GsjfvzgF8eWPdtEjfWBjsw%3D%3D", "temperature": "hot", "category": "hot"}, {"name": "GADEB ORO BY Noura.ja", "author": "Nourah", "brewer": "Other", "dose": "20g", "ratio": "1:15", "link": "https://share-h5.xbloom.com/?id=GkOQiqyJTmUls1v1XNDZjg%3D%3D", "temperature": "hot", "category": "hot"}, {"name": "25grams", "author": "Muneera", "brewer": "Other", "dose": "25g", "ratio": "1:16", "link": "https://share-h5.xbloom.com/?id=gJAP695CaWbNxZxkMcLQGA%3D%3D", "temperature": "hot", "category": "hot"}];

const CKW = ['Ø¨Ø§Ø±Ø¯','Ø«Ù„Ø¬','ice','ğŸ§Š','iced','Ø§Ù„Ø«Ù„Ø¬','cold','Ø¨Ø§Ø±Ø¯Ø©','Ù…Ø«Ù„Ø¬','Ø¨Ø§Ø±Ø¯Ù‡','Ù…Ø«Ù„Ø¬Ø©','Ù…Ø«Ù„Ø¬Ù‡'];
const SKW = ['ØºØ³ÙŠÙ„','ØªØ±Ø·ÙŠØ¨','Ø³ÙŠØ±ÙØ±','ØºØ³Ù„','server','cleaning','wash'];

// â•â•â•â• STATE â•â•â•â•
let app, db;
let FB_RECIPES = [], ALL_RECIPES = [];
let FB_RATINGS = {}, FB_SETTINGS = {}, FB_ACTIVITY = [];
let PENDING = [], ALL_COMMENTS = [];
let PROMO_CODES = {}, AFFILIATE = {};
let ANALYTICS = {};
let editingKey = null, selectedKeys = new Set();

// â•â•â•â• SHA-256 â•â•â•â•
async function sha256(str) {
  const buf = await crypto.subtle.digest('SHA-256', new TextEncoder().encode(str));
  return [...new Uint8Array(buf)].map(b=>b.toString(16).padStart(2,'0')).join('');
}

// â•â•â•â• HELPERS â•â•â•â•
function toast(msg, cls='tok') {
  const t=document.getElementById('toast');
  t.textContent=msg; t.className='toast '+cls+' show';
  setTimeout(()=>t.classList.remove('show'),3200);
}
function setEl(id,v){ const el=document.getElementById(id); if(el) el.textContent=v; }
function str(v){ return v==null?'':String(v); }
function esc(s){ return String(s).replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;').replace(/"/g,'&quot;'); }
function ensureCat(r){
  if(!r.category){const t=(str(r.name)+' '+str(r.author)).toLowerCase();r.category=SKW.some(k=>t.includes(k))?'server':CKW.some(k=>t.includes(k))?'cold':'hot';}
  return r;
}
function ratingKey(link){
  try{return btoa(unescape(encodeURIComponent(link))).replace(/\+/g,'-').replace(/\//g,'_').replace(/=/g,'');}
  catch(e){return 'k'+Math.abs([...link].reduce((a,c)=>a*31+c.charCodeAt(0)|0,0));}
}
function relTime(ts){
  const d=Date.now()-ts, m=60000,h=3600000,day=86400000;
  if(d<m) return 'Ø§Ù„Ø¢Ù†';
  if(d<h) return Math.floor(d/m)+' Ø¯Ù‚ÙŠÙ‚Ø© Ù…Ø¶Øª';
  if(d<day) return Math.floor(d/h)+' Ø³Ø§Ø¹Ø© Ù…Ø¶Øª';
  return new Date(ts).toLocaleDateString('ar-SA');
}
function confirm2(title,msg,cb){
  setEl('confirmTitle',title); setEl('confirmMsg',msg);
  document.getElementById('confirmOv').classList.add('open');
  document.getElementById('confirmOk').onclick=()=>{document.getElementById('confirmOv').classList.remove('open'); cb();} ;
}
function setFbStatus(state,msg){
  const dot=document.getElementById('fbDot'); dot.className='fb-dot '+state;
  setEl('fbLbl',msg);
  document.getElementById('fbAlert').classList.toggle('show',state==='err');
}

// â•â•â•â• TABS â•â•â•â•
window.switchTab=function(btn,id){
  document.querySelectorAll('.atb').forEach(b=>b.classList.remove('on'));
  document.querySelectorAll('.acard').forEach(c=>c.classList.remove('open'));
  btn.classList.add('on'); document.getElementById(id).classList.add('open');
};

// â•â•â•â• AUTH â•â•â•â•
window.doLogin=async function(){
  const u=document.getElementById('lu').value.trim();
  const p=document.getElementById('lp').value.trim();
  const [uh,ph]=await Promise.all([sha256(u),sha256(p)]);
  // Check Firebase stored hash first
  const storedHash=FB_SETTINGS?.authHash;
  const passOk=ph===PASS_HASH||(storedHash&&ph===storedHash);
  const userOk=uh===USER_HASH;
  if(userOk&&passOk){
    sessionStorage.setItem('xba','1');
    document.getElementById('loginScreen').style.display='none';
    document.getElementById('adminPanel').style.display='block';
    initFirebase(); await logActivity('login','ğŸ” ØªØ³Ø¬ÙŠÙ„ Ø¯Ø®ÙˆÙ„ Ø§Ù„Ø£Ø¯Ù…Ù†');
  } else {
    document.getElementById('lerr').textContent='Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¯Ø®ÙˆÙ„ ØºÙŠØ± ØµØ­ÙŠØ­Ø© âŒ';
    setTimeout(()=>setEl('lerr',''),3000);
  }
};
window.doLogout=function(){ sessionStorage.removeItem('xba'); location.reload(); };
['lu','lp'].forEach(id=>{document.getElementById(id).addEventListener('keydown',e=>{if(e.key==='Enter')window.doLogin();});});
if(sessionStorage.getItem('xba')==='1'){
  document.getElementById('loginScreen').style.display='none';
  document.getElementById('adminPanel').style.display='block';
  initFirebase();
}

// â•â•â•â• FIREBASE INIT â•â•â•â•
function initFirebase(){
  setFbStatus('loading','Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø§ØªØµØ§Ù„...');
  try{app=initializeApp(FB_CFG);db=getDatabase(app);}
  catch(e){setFbStatus('err','Ø®Ø·Ø£: '+e.message);return;}

  // RECIPES
  onValue(ref(db,'recipes'),snap=>{
    FB_RECIPES=[];
    snap.forEach(child=>{const r=child.val();r._fbKey=child.key;r._src='fb';ensureCat(r);FB_RECIPES.push(r);});
    const fbLinks=new Set(FB_RECIPES.map(r=>r.link));
    const initClone=JSON.parse(JSON.stringify(INIT)).filter(r=>!fbLinks.has(r.link));
    initClone.forEach(r=>{r._src='init';ensureCat(r);});
    ALL_RECIPES=FB_RECIPES.concat(initClone);
    setFbStatus('ok','âœ… Ù…ØªØµÙ„ â€” '+FB_RECIPES.length+' Firebase + '+initClone.length+' INIT');
    setEl('lastSync','Ø¢Ø®Ø± ØªØ­Ø¯ÙŠØ«: '+new Date().toLocaleTimeString('ar-SA'));
    updateDashboard(); renderTable();
    populateSelects();
  },err=>setFbStatus('err','ÙØ´Ù„ â€” '+err.message));

  // RATINGS
  onValue(ref(db,'ratings'),snap=>{
    FB_RATINGS={};
    snap.forEach(child=>{FB_RATINGS[child.key]=child.val();});
    renderRatings(); updateDashboard();
  },()=>{});

  // SETTINGS
  onValue(ref(db,'settings'),snap=>{
    FB_SETTINGS=snap.val()||{};
    applySettings();
  },()=>{});

  // PENDING
  onValue(ref(db,'pending'),snap=>{
    PENDING=[];
    snap.forEach(child=>{const r=child.val();r._fbKey=child.key;PENDING.push(r);});
    renderPending();
    const badge=document.getElementById('pendBadge');
    badge.textContent=PENDING.length;
    badge.classList.toggle('show',PENDING.length>0);
  },()=>{});

  // ACTIVITY
  onValue(ref(db,'activity'),snap=>{
    FA_ACTIVITY=[];
    snap.forEach(child=>{FA_ACTIVITY.push({...child.val(),_key:child.key});});
    FA_ACTIVITY.sort((a,b)=>b.ts-a.ts);
    renderActivity();
  },()=>{});

  // COMMENTS
  onValue(ref(db,'comments'),snap=>{
    ALL_COMMENTS=[];
    snap.forEach(recipeSnap=>{
      recipeSnap.forEach(cmtSnap=>{
        ALL_COMMENTS.push({...cmtSnap.val(),_key:cmtSnap.key,_recipeKey:recipeSnap.key});
      });
    });
    ALL_COMMENTS.sort((a,b)=>b.ts-a.ts);
    renderComments();
    const pending=ALL_COMMENTS.filter(c=>!c.approved);
    const badge=document.getElementById('cmtBadge');
    badge.textContent=pending.length;
    badge.classList.toggle('show',pending.length>0);
  },()=>{});

  // PROMO
  onValue(ref(db,'promo_codes'),snap=>{
    PROMO_CODES={};
    snap.forEach(child=>{PROMO_CODES[child.key]=child.val();});
    renderPromos();
  },()=>{});

  // AFFILIATE
  onValue(ref(db,'affiliate'),snap=>{
    AFFILIATE={};
    snap.forEach(child=>{AFFILIATE[child.key]=child.val();});
    renderAffiliates();
  },()=>{});

  // ANALYTICS
  onValue(ref(db,'analytics/brew'),snap=>{
    ANALYTICS={};
    snap.forEach(child=>{ANALYTICS[child.key]=child.val();});
    renderAnalytics();
  },()=>{});
}

let FA_ACTIVITY = [];

// â•â•â•â• ACTIVITY LOGGER â•â•â•â•
async function logActivity(type,text){
  if(!db) return;
  try{await push(ref(db,'activity'),{type,text,ts:Date.now()});}catch(e){}
}

// â•â•â•â• DASHBOARD â•â•â•â•
function updateDashboard(){
  let h=0,c=0,s=0,o=0,x=0,ot=0,feat=0,hidden=0;
  ALL_RECIPES.forEach(r=>{
    const cat=r.category||'hot',b=r.brewer||'';
    if(cat==='hot')h++;else if(cat==='cold')c++;else s++;
    if(b==='Omni')o++;else if(b==='xPod')x++;else ot++;
    if(r.featured)feat++;if(r.hidden)hidden++;
  });
  const rated=Object.keys(FB_RATINGS).length;
  document.getElementById('dashStats').innerHTML=`
    <div class="sc s-teal"><div class="sv">${ALL_RECIPES.length}</div><div class="sl">ğŸ“‹ Ø§Ù„ÙƒÙ„</div></div>
    <div class="sc s-blue"><div class="sv">${FB_RECIPES.length}</div><div class="sl">â˜ï¸ Firebase</div></div>
    <div class="sc s-red"><div class="sv">${PENDING.length}</div><div class="sl">â³ Ù…Ø±Ø§Ø¬Ø¹Ø©</div></div>
    <div class="sc s-green"><div class="sv">${rated}</div><div class="sl">â­ Ù…Ù‚ÙŠÙ‘Ù…Ø©</div></div>
    <div class="sc s-purple"><div class="sv">${feat}</div><div class="sl">ğŸ“Œ Ù…Ù…ÙŠØ²Ø©</div></div>
    <div class="sc s-yellow"><div class="sv">${hidden}</div><div class="sl">ğŸ™ˆ Ù…Ø®ÙÙŠØ©</div></div>
    <div class="sc"><div class="sv">${h}</div><div class="sl">ğŸ”¥ Ø­Ø§Ø±Ø©</div></div>
    <div class="sc"><div class="sv">${c}</div><div class="sl">ğŸ§Š Ø¨Ø§Ø±Ø¯Ø©</div></div>
    <div class="sc"><div class="sv">${s}</div><div class="sl">âš™ï¸ Ø³ÙŠØ±ÙØ±</div></div>
  `;
  renderDashCharts(h,c,s,o,x,ot);
  renderTopRated();
  renderRecentActivity();
}

let catChartObj=null, brewChartObj=null;
function renderDashCharts(h,c,s,o,x,ot){
  const catCtx=document.getElementById('catChart');
  const brewCtx=document.getElementById('brewChart');
  if(!catCtx||!brewCtx) return;
  const opts={responsive:true,plugins:{legend:{position:'bottom',labels:{color:'#A0A0A0',font:{family:'Cairo'}}}}};
  if(catChartObj) catChartObj.destroy();
  if(brewChartObj) brewChartObj.destroy();
  catChartObj=new Chart(catCtx,{type:'doughnut',data:{labels:['ğŸ”¥ Ø­Ø§Ø±','ğŸ§Š Ø¨Ø§Ø±Ø¯','âš™ï¸ Ø³ÙŠØ±ÙØ±'],datasets:[{data:[h,c,s],backgroundColor:['#f5576c','#4facfe','#a78bfa'],borderColor:'#1A1A1A',borderWidth:2}]},options:opts});
  brewChartObj=new Chart(brewCtx,{type:'doughnut',data:{labels:['Omni','xPod','Other'],datasets:[{data:[o,x,ot],backgroundColor:['#00A896','#4A90E2','#ffd89b'],borderColor:'#1A1A1A',borderWidth:2}]},options:opts});
}

function renderTopRated(){
  const el=document.getElementById('topRated'); if(!el) return;
  const sorted=Object.entries(FB_RATINGS).map(([k,v])=>{
    const avg=v.count>0?v.total/v.count:0;
    const recipe=ALL_RECIPES.find(r=>{try{return ratingKey(r.link)===k;}catch{return false;}});
    return {avg,count:v.count,name:recipe?str(recipe.name):'ÙˆØµÙØ© ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙØ©'};
  }).sort((a,b)=>b.avg-a.avg).slice(0,5);
  if(!sorted.length){el.innerHTML='<p style="color:var(--t2);font-size:.82em">Ù„Ø§ ØªÙˆØ¬Ø¯ ØªÙ‚ÙŠÙŠÙ…Ø§Øª Ø¨Ø¹Ø¯</p>';return;}
  el.innerHTML=sorted.map((r,i)=>{
    const medal=i===0?'ğŸ¥‡':i===1?'ğŸ¥ˆ':i===2?'ğŸ¥‰':'';
    return `<div style="display:flex;justify-content:space-between;align-items:center;padding:8px 10px;background:var(--up);border-radius:8px;margin-bottom:6px;font-size:.83em">
      <span>${medal} ${esc(r.name)}</span>
      <span style="color:#ffd700;font-weight:700">${r.avg.toFixed(1)}â­ (${r.count})</span>
    </div>`;
  }).join('');
}

function renderRecentActivity(){
  const el=document.getElementById('recentActs'); if(!el) return;
  const recent=FA_ACTIVITY.slice(0,5);
  if(!recent.length){el.innerHTML='<p style="color:var(--t2);font-size:.82em">Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ù†Ø´Ø§Ø· Ø¨Ø¹Ø¯</p>';return;}
  el.innerHTML=recent.map(a=>{
    const icons={add:'â•',del:'ğŸ—‘ï¸',edit:'âœï¸',login:'ğŸ”',setting:'âš™ï¸',approve:'âœ…',reject:'âŒ'};
    return `<div style="display:flex;gap:8px;align-items:center;padding:8px 10px;background:var(--up);border-radius:8px;margin-bottom:6px;font-size:.82em">
      <span>${icons[a.type]||'â€¢'}</span>
      <span style="flex:1">${esc(a.text)}</span>
      <span style="color:var(--t2);font-size:.9em">${relTime(a.ts)}</span>
    </div>`;
  }).join('');
}

// â•â•â•â• SETTINGS â•â•â•â•
function applySettings(){
  const s=FB_SETTINGS;
  const sets={
    'tog-maintenance':s.maintenance?.enabled,
    'tog-submissions':s.submissions_enabled!==false,
    'tog-approval':s.require_approval,
    'tog-ratings':s.ratings_enabled!==false,
    'tog-comments':s.comments_enabled!==false,
    'tog-share':s.share_enabled!==false,
  };
  Object.entries(sets).forEach(([id,v])=>{const el=document.getElementById(id);if(el)el.checked=!!v;});
  if(s.banner?.text) setEl('banStatus','âœ… Ø¥Ø¹Ù„Ø§Ù† Ù†Ø´Ø·: '+s.banner.text);
  if(s.ads_code) document.getElementById('adsCode').value=s.ads_code;
  if(s.tip_jar_url) document.getElementById('tipJarUrl').value=s.tip_jar_url;
  if(s.site_title) document.getElementById('siteTitle').value=s.site_title;
  if(s.footer_text) document.getElementById('footerText').value=s.footer_text;
  if(s.copyright) document.getElementById('copyText').value=s.copyright;
  if(s.maintenance?.message) document.getElementById('maintMsg').value=s.maintenance.message;
  if(s.featured_today) setEl('featTodayStatus','â­ ÙˆØµÙØ© Ø§Ù„ÙŠÙˆÙ… Ø§Ù„Ø­Ø§Ù„ÙŠØ©: '+s.featured_today);
  renderBrewTypes();
}

window.saveSetting=async function(path,val){
  if(!db){toast('Firebase ØºÙŠØ± Ù…ØªØµÙ„!','terr');return;}
  const parts=path.split('.');
  let obj={};
  if(parts.length===2) obj[parts[0]]={...((FB_SETTINGS||{})[parts[0]]||{}), [parts[1]]:val};
  else obj[path]=val;
  try{
    await update(ref(db,'settings'),obj);
    toast('ØªÙ… Ø§Ù„Ø­ÙØ¸ âœ…');
    await logActivity('setting','âš™ï¸ ØªØ¹Ø¯ÙŠÙ„ Ø¥Ø¹Ø¯Ø§Ø¯: '+path+' â†’ '+val);
  }catch(e){toast('Ø®Ø·Ø£: '+e.message,'terr');}
};

window.saveConstants=async function(){
  if(!db) return;
  const data={
    site_title:document.getElementById('siteTitle').value,
    footer_text:document.getElementById('footerText').value,
    copyright:document.getElementById('copyText').value,
    'maintenance.message':document.getElementById('maintMsg').value
  };
  try{
    await update(ref(db,'settings'),{
      site_title:data.site_title,
      footer_text:data.footer_text,
      copyright:data.copyright,
      maintenance:{...((FB_SETTINGS||{}).maintenance||{}),message:data['maintenance.message']}
    });
    toast('ØªÙ… Ø­ÙØ¸ Ø§Ù„Ø«ÙˆØ§Ø¨Øª âœ…');
    await logActivity('setting','âš™ï¸ ØªØ¹Ø¯ÙŠÙ„ Ø«ÙˆØ§Ø¨Øª Ø§Ù„Ù…ÙˆÙ‚Ø¹');
  }catch(e){toast('Ø®Ø·Ø£: '+e.message,'terr');}
};

// â•â•â•â• BREW TYPES â•â•â•â•
function renderBrewTypes(){
  const el=document.getElementById('brewTypesList'); if(!el) return;
  const types=FB_SETTINGS?.brew_types||{Omni:true,xPod:true,Other:true};
  el.innerHTML=Object.entries(types).map(([name,active])=>
    `<div style="display:flex;align-items:center;gap:8px;padding:8px 12px;background:var(--up);border-radius:8px;margin-bottom:6px">
      <span style="flex:1;font-weight:700">${esc(name)}</span>
      <label class="tog" style="scale:.8"><input type="checkbox" ${active?'checked':''} onchange="toggleBrewType('${name}',this.checked)"><span class="tog-slider"></span></label>
      ${!['Omni','xPod','Other'].includes(name)?`<button class="btn bsm bd" onclick="removeBrewType('${name}')">âœ•</button>`:'(Ø«Ø§Ø¨Øª)'}
    </div>`
  ).join('');
}

window.addBrewType=async function(){
  const n=document.getElementById('newBrewType').value.trim();
  if(!n){toast('Ø£Ø¯Ø®Ù„ Ø§Ø³Ù… Ø§Ù„Ù…Ø­Ø¶Ù‘Ø±','terr');return;}
  const types={...(FB_SETTINGS?.brew_types||{Omni:true,xPod:true,Other:true}),[n]:true};
  await update(ref(db,'settings'),{brew_types:types});
  document.getElementById('newBrewType').value='';
  toast('ØªÙ…Øª Ø§Ù„Ø¥Ø¶Ø§ÙØ© âœ…');
  // Also update the brewer select
  const sel=document.getElementById('rBr');
  if(sel&&!sel.querySelector(`option[value="${n}"]`)){
    const opt=document.createElement('option');opt.value=n;opt.textContent=n;sel.appendChild(opt);
  }
};
window.toggleBrewType=async function(name,val){
  const types={...(FB_SETTINGS?.brew_types||{}), [name]:val};
  await update(ref(db,'settings'),{brew_types:types});
};
window.removeBrewType=async function(name){
  const types={...(FB_SETTINGS?.brew_types||{})};
  delete types[name];
  await update(ref(db,'settings'),{brew_types:types});
  toast('ØªÙ… Ø§Ù„Ø­Ø°Ù');
};

// â•â•â•â• PENDING â•â•â•â•
function renderPending(){
  const el=document.getElementById('pendingList');
  if(!PENDING.length){el.innerHTML='<p style="color:var(--t2);text-align:center;padding:30px">Ù„Ø§ ØªÙˆØ¬Ø¯ ÙˆØµÙØ§Øª ÙÙŠ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø© ğŸ‰</p>';return;}
  el.innerHTML=`<div style="display:grid;grid-template-columns:repeat(auto-fill,minmax(280px,1fr));gap:12px">
    ${PENDING.map(r=>`
      <div style="background:var(--up);border-radius:12px;padding:16px;border:1px solid rgba(255,213,101,.3)">
        <div style="display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:10px">
          <div>
            <div style="font-weight:700;font-size:.95em">${esc(str(r.name))}</div>
            <div style="font-size:.78em;color:var(--ta)">Ø¨ÙˆØ§Ø³Ø·Ø© ${esc(str(r.author||'Ù…Ø¬Ù‡ÙˆÙ„'))}</div>
            <div style="font-size:.72em;color:var(--t2);margin-top:3px">${relTime(r.addedAt||0)}</div>
          </div>
          <span class="badge-pend">Ø§Ù†ØªØ¸Ø§Ø±</span>
        </div>
        <div style="display:flex;gap:6px;flex-wrap:wrap;margin-bottom:10px">
          <span style="font-size:.75em;padding:3px 8px;background:var(--card);border-radius:6px">${esc(str(r.brewer))}</span>
          <span style="font-size:.75em;padding:3px 8px;background:var(--card);border-radius:6px">${esc(str(r.dose))}</span>
          <span style="font-size:.75em;padding:3px 8px;background:var(--card);border-radius:6px">${r.category==='cold'?'ğŸ§Š':r.category==='server'?'âš™ï¸':'ğŸ”¥'}</span>
        </div>
        <div style="display:flex;gap:6px">
          <button class="btn bg bsm" style="flex:1" onclick="approvePending('${r._fbKey}')">âœ… Ù‚Ø¨ÙˆÙ„</button>
          <a href="${esc(str(r.link))}" target="_blank" class="btn bgray bsm">ğŸ”—</a>
          <button class="btn bd bsm" onclick="rejectPending('${r._fbKey}')">âœ•</button>
        </div>
      </div>
    `).join('')}
  </div>`;
}

window.approvePending=async function(key){
  const r=PENDING.find(p=>p._fbKey===key);
  if(!r) return;
  const {_fbKey,...data}=r;
  try{
    await push(ref(db,'recipes'),{...data,addedAt:r.addedAt||Date.now()});
    await remove(ref(db,'pending/'+key));
    toast('ØªÙ…Øª Ø§Ù„Ù…ÙˆØ§ÙÙ‚Ø© âœ…'); await logActivity('approve','âœ… Ù‚Ø¨ÙˆÙ„ ÙˆØµÙØ©: '+str(r.name));
  }catch(e){toast('Ø®Ø·Ø£: '+e.message,'terr');}
};

window.rejectPending=function(key){
  const r=PENDING.find(p=>p._fbKey===key);
  confirm2('Ø±ÙØ¶ Ø§Ù„ÙˆØµÙØ©','Ø±ÙØ¶ ÙˆØ­Ø°Ù: '+(r?str(r.name):'Ø§Ù„ÙˆØµÙØ©')+'ØŸ',async()=>{
    try{
      await remove(ref(db,'pending/'+key));
      toast('ØªÙ… Ø§Ù„Ø±ÙØ¶'); await logActivity('reject','âŒ Ø±ÙØ¶ ÙˆØµÙØ©: '+(r?str(r.name):''));
    }catch(e){toast('Ø®Ø·Ø£','terr');}
  });
};

window.approveAllPending=function(){
  if(!PENDING.length){toast('Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø´ÙŠØ¡','twin');return;}
  confirm2('Ù‚Ø¨ÙˆÙ„ Ø§Ù„ÙƒÙ„','Ù‚Ø¨ÙˆÙ„ Ø¬Ù…ÙŠØ¹ Ø§Ù„ÙˆØµÙØ§Øª Ø§Ù„Ù…Ø¹Ù„Ù‚Ø© ('+PENDING.length+')ØŸ',async()=>{
    for(const r of PENDING) await approvePending(r._fbKey);
  });
};

window.rejectAllPending=function(){
  if(!PENDING.length){toast('Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø´ÙŠØ¡','twin');return;}
  confirm2('Ø±ÙØ¶ Ø§Ù„ÙƒÙ„','Ø±ÙØ¶ ÙˆØ­Ø°Ù Ø¬Ù…ÙŠØ¹ Ø§Ù„ÙˆØµÙØ§Øª Ø§Ù„Ù…Ø¹Ù„Ù‚Ø©ØŸ',async()=>{
    for(const r of PENDING){
      try{await remove(ref(db,'pending/'+r._fbKey));}catch{}
    }
    await logActivity('reject','âŒ Ø±ÙØ¶ Ø¬Ù…ÙŠØ¹ Ø§Ù„ÙˆØµÙØ§Øª Ø§Ù„Ù…Ø¹Ù„Ù‚Ø©');
    toast('ØªÙ… Ø±ÙØ¶ Ø§Ù„ÙƒÙ„');
  });
};

// â•â•â•â• TABLE â•â•â•â•
window.renderTable=function(){
  const q=(document.getElementById('aQ')?.value||'').toLowerCase().trim();
  const br=document.getElementById('aBr')?.value||'all';
  const cat=document.getElementById('aCat')?.value||'all';
  const src=document.getElementById('aSrc')?.value||'all';
  const list=ALL_RECIPES.filter(r=>{
    if(br!=='all'&&r.brewer!==br) return false;
    if(cat!=='all'&&(r.category||'hot')!==cat) return false;
    if(src==='fb'&&r._src!=='fb') return false;
    if(src==='init'&&r._src!=='init') return false;
    if(q){const t=(str(r.name)+' '+str(r.author)).toLowerCase();if(!t.includes(q)) return false;}
    return true;
  });
  setEl('tableCount','Ø¹Ø±Ø¶ '+list.length+' ÙˆØµÙØ©');
  const tbody=document.getElementById('aTbody');
  tbody.innerHTML=list.map((r,i)=>{
    const cat2=r.category||'hot';
    const catLbl=cat2==='hot'?'ğŸ”¥':cat2==='cold'?'ğŸ§Š':'âš™ï¸';
    const srcBadge=r._src==='fb'?'<span class="badge-fb">â˜ï¸</span>':'<span class="badge-init">ğŸ“</span>';
    const featBadge=r.featured?'<span class="badge-feat">ğŸ“Œ</span>':'';
    const hidBadge=r.hidden?'<span class="badge-hidden">ğŸ™ˆ</span>':'';
    const spBadge=r.sponsored?'<span class="badge-sponsored">ğŸŒŸ</span>':'';
    const rKey=ratingKey(r.link);
    const rd=FB_RATINGS[rKey]||{total:0,count:0};
    const avg=rd.count>0?(rd.total/rd.count).toFixed(1):'â€”';
    const actions=r._src==='fb'?`
      <button class="btn bsm bw" onclick="editRec('${r._fbKey}')">âœï¸</button>
      <button class="btn bsm bgray" onclick="toggleFeatured('${r._fbKey}','${r.featured}')">${r.featured?'ğŸ“':'ğŸ“Œ'}</button>
      <button class="btn bsm bgray" onclick="toggleHidden('${r._fbKey}','${r.hidden}')">${r.hidden?'ğŸ‘':'ğŸ™ˆ'}</button>
      <button class="btn bsm bd" onclick="confirmDel('${r._fbKey}','${esc(str(r.name))}')">ğŸ—‘ï¸</button>`
      :'<span style="font-size:.72em;color:var(--t2)">Ù„Ù„Ù‚Ø±Ø§Ø¡Ø© ÙÙ‚Ø·</span>';
    const chk=r._src==='fb'?`<input type="checkbox" class="row-chk" value="${r._fbKey}" onchange="updateSelection()" style="width:14px;height:14px">`:' ';
    return `<tr>
      <td>${chk}</td>
      <td>${i+1}</td>
      <td style="max-width:150px"><a href="${esc(str(r.link))}" target="_blank" title="${esc(str(r.name))}">${esc(str(r.name)).slice(0,30)}</a> ${featBadge}${hidBadge}${spBadge}</td>
      <td style="font-size:.78em">${esc(str(r.author)).slice(0,20)}</td>
      <td><span style="font-size:.78em">${esc(str(r.brewer))}</span></td>
      <td>${catLbl}</td>
      <td>${srcBadge}</td>
      <td style="color:#ffd700;font-size:.82em">${avg!=='â€”'?avg+'â­':avg}</td>
      <td><div class="tblacts">${actions}</div></td>
    </tr>`;
  }).join('');
};

// SELECTION
window.updateSelection=function(){
  const checks=[...document.querySelectorAll('.row-chk:checked')];
  selectedKeys=new Set(checks.map(c=>c.value));
  const bar=document.getElementById('bulkBar');
  bar.classList.toggle('show',selectedKeys.size>0);
  setEl('bulkCount',selectedKeys.size+' Ù…Ø­Ø¯Ø¯Ø©');
};
window.toggleSelectAll=function(cb){
  document.querySelectorAll('.row-chk').forEach(c=>{c.checked=cb.checked;});
  updateSelection();
};
window.clearSelection=function(){
  selectedKeys.clear();
  document.querySelectorAll('.row-chk').forEach(c=>c.checked=false);
  document.getElementById('bulkBar').classList.remove('show');
  const sa=document.getElementById('selAll');if(sa)sa.checked=false;
};
window.bulkDelete=function(){
  if(!selectedKeys.size) return;
  confirm2('Ø­Ø°Ù Ø§Ù„Ù…Ø­Ø¯Ø¯','Ø­Ø°Ù '+selectedKeys.size+' ÙˆØµÙØ©ØŸ',async()=>{
    for(const k of selectedKeys){try{await remove(ref(db,'recipes/'+k));}catch{}}
    clearSelection(); toast('ØªÙ… Ø­Ø°Ù Ø§Ù„Ù…Ø­Ø¯Ø¯'); await logActivity('del','ğŸ—‘ï¸ Ø­Ø°Ù Ù…Ø¬Ù…Ù‘Ø¹: '+selectedKeys.size+' ÙˆØµÙØ©');
  });
};
window.bulkFeature=async function(val){
  for(const k of selectedKeys){
    try{await update(ref(db,'recipes/'+k),{featured:val});}catch{}
  }
  clearSelection(); toast(val?'ØªÙ… Ø§Ù„ØªÙ…ÙŠÙŠØ² âœ…':'ØªÙ… Ø¥Ù„ØºØ§Ø¡ Ø§Ù„ØªÙ…ÙŠÙŠØ²');
};

// TOGGLE ACTIONS
window.toggleFeatured=async function(key,current){
  const newVal=!current||current==='false'||current===false;
  await update(ref(db,'recipes/'+key),{featured:newVal});
  toast(newVal?'ğŸ“Œ ØªÙ… Ø§Ù„ØªØ«Ø¨ÙŠØª':'ğŸ“ ØªÙ… Ø§Ù„Ø¥Ù„ØºØ§Ø¡'); await logActivity('edit','ğŸ“Œ ØªØºÙŠÙŠØ± ØªÙ…ÙŠÙŠØ²: '+key);
};
window.toggleHidden=async function(key,current){
  const newVal=!current||current==='false'||current===false;
  await update(ref(db,'recipes/'+key),{hidden:newVal});
  toast(newVal?'ğŸ™ˆ ØªÙ… Ø§Ù„Ø¥Ø®ÙØ§Ø¡':'ğŸ‘ ØªÙ… Ø§Ù„Ø¥Ø¸Ù‡Ø§Ø±');
};

// â•â•â•â• RATINGS â•â•â•â•
function renderRatings(){
  const statsEl=document.getElementById('ratingsStats');
  const listEl=document.getElementById('ratingsList');
  const keys=Object.keys(FB_RATINGS);
  const totalVotes=Object.values(FB_RATINGS).reduce((a,v)=>a+(v.count||0),0);
  const totalSum=Object.values(FB_RATINGS).reduce((a,v)=>a+(v.total||0),0);
  const siteAvg=totalVotes>0?(totalSum/totalVotes).toFixed(2):0;
  if(statsEl) statsEl.innerHTML=`
    <div class="sc s-yellow"><div class="sv">${keys.length}</div><div class="sl">ÙˆØµÙØ§Øª Ù…Ù‚ÙŠÙ‘Ù…Ø©</div></div>
    <div class="sc s-green"><div class="sv">${totalVotes}</div><div class="sl">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„ØªÙ‚ÙŠÙŠÙ…Ø§Øª</div></div>
    <div class="sc s-teal"><div class="sv">${siteAvg}</div><div class="sl">Ù…ØªÙˆØ³Ø· Ø§Ù„Ù…ÙˆÙ‚Ø¹</div></div>
  `;
  if(!keys.length){listEl.innerHTML='<p style="color:var(--t2);text-align:center;padding:20px">Ù„Ø§ ØªÙˆØ¬Ø¯ ØªÙ‚ÙŠÙŠÙ…Ø§Øª</p>';return;}
  const sorted=keys.map(k=>{
    const v=FB_RATINGS[k];
    const avg=v.count>0?v.total/v.count:0;
    const r=ALL_RECIPES.find(r=>{try{return ratingKey(r.link)===k;}catch{return false;}});
    return {key:k,avg,count:v.count,name:r?str(r.name):'ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ'};
  }).sort((a,b)=>b.avg-a.avg);
  listEl.innerHTML=sorted.map((r,i)=>{
    const stars='â­'.repeat(Math.round(r.avg));
    const medal=i===0?'ğŸ¥‡ ':i===1?'ğŸ¥ˆ ':i===2?'ğŸ¥‰ ':'';
    return `<div class="rcard">
      <div class="rcard-name">${medal}${i+1}. ${esc(r.name)}</div>
      <div><div class="rcard-stars">${stars} <strong>${r.avg.toFixed(1)}</strong>/5</div><div class="rcard-info">${r.count} Ù…Ù‚ÙŠÙ‘Ù…</div></div>
      <button class="btn bsm bd" onclick="resetOneRating('${r.key}','${esc(r.name)}')">ğŸ—‘ï¸ ØªØµÙÙŠØ±</button>
    </div>`;
  }).join('');
}

window.resetAllRatings=function(){
  confirm2('ØªØµÙÙŠØ± ÙƒÙ„ Ø§Ù„ØªÙ‚ÙŠÙŠÙ…Ø§Øª','Ø³ÙŠØªÙ… Ø­Ø°Ù Ø¬Ù…ÙŠØ¹ Ø§Ù„ØªÙ‚ÙŠÙŠÙ…Ø§Øª. Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø§Ù„ØªØ±Ø§Ø¬Ø¹.',async()=>{
    await set(ref(db,'ratings'),null);
    toast('ØªÙ… ØªØµÙÙŠØ± Ø§Ù„ÙƒÙ„ âœ…'); await logActivity('del','ğŸ—‘ï¸ ØªØµÙÙŠØ± Ø¬Ù…ÙŠØ¹ Ø§Ù„ØªÙ‚ÙŠÙŠÙ…Ø§Øª');
  });
};
window.resetOneRating=function(key,name){
  confirm2('ØªØµÙÙŠØ± ØªÙ‚ÙŠÙŠÙ…','ØªØµÙÙŠØ±: '+name+'ØŸ',async()=>{
    await remove(ref(db,'ratings/'+key)); toast('ØªÙ… Ø§Ù„ØªØµÙÙŠØ± âœ…');
  });
};

// â•â•â•â• ANALYTICS â•â•â•â•
window.loadAnalytics=function(){renderAnalytics();};
function renderAnalytics(){
  const el=document.getElementById('analyticsChart');if(!el)return;
  const entries=Object.entries(ANALYTICS).sort((a,b)=>b[1]-a[1]);
  if(!entries.length){el.innerHTML='<p style="color:var(--t2);text-align:center;padding:20px">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª ØªØ­Ù„ÙŠÙ„ Ø¨Ø¹Ø¯</p>';return;}
  const max=entries[0]?.[1]||1;
  el.innerHTML=entries.slice(0,50).map(([k,count])=>{
    const recipe=ALL_RECIPES.find(r=>{try{return ratingKey(r.link)===k;}catch{return false;}});
    const name=recipe?str(recipe.name):'ÙˆØµÙØ©';
    return `<div class="brew-item">
      <span style="font-size:.82em;flex:0 0 150px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap" title="${esc(name)}">${esc(name)}</span>
      <div class="brew-bar-wrap"><div class="brew-bar" style="width:${(count/max*100).toFixed(1)}%"></div></div>
      <span class="brew-count">${count}</span>
    </div>`;
  }).join('');
}

// â•â•â•â• COMMENTS â•â•â•â•
function renderComments(){
  const el=document.getElementById('commentsList');if(!el)return;
  const filter=document.getElementById('cmtFilter')?.value||'pending';
  let list=ALL_COMMENTS;
  if(filter==='pending') list=list.filter(c=>!c.approved);
  else if(filter==='approved') list=list.filter(c=>c.approved);
  if(!list.length){el.innerHTML='<p style="color:var(--t2);text-align:center;padding:20px">Ù„Ø§ ØªÙˆØ¬Ø¯ ØªØ¹Ù„ÙŠÙ‚Ø§Øª</p>';return;}
  el.innerHTML=list.map(c=>{
    const recipe=ALL_RECIPES.find(r=>ratingKey(r.link)===c._recipeKey||r._fbKey===c._recipeKey);
    const recipeNm=recipe?str(recipe.name):'ÙˆØµÙØ© ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙØ©';
    return `<div class="cmt${c.pinned?' pinned':''}">
      <div class="cmt-head">
        <div>
          <div class="cmt-author">${esc(c.author||'Ù…Ø¬Ù‡ÙˆÙ„')} ${c.rating?'â­'.repeat(c.rating):''}</div>
          <div style="font-size:.75em;color:var(--ta)">Ø¹Ù„Ù‰: ${esc(recipeNm)}</div>
        </div>
        <div style="display:flex;gap:4px;align-items:center">
          ${c.approved?'<span class="badge-approved">âœ… Ù…Ù‚Ø¨ÙˆÙ„</span>':'<span class="badge-pend">â³ Ø§Ù†ØªØ¸Ø§Ø±</span>'}
          <span class="cmt-ts">${relTime(c.ts||0)}</span>
        </div>
      </div>
      <div class="cmt-body">${esc(c.text||'')}</div>
      ${c.adminReply?`<div class="cmt-reply"><div class="cmt-reply-lbl">â†©ï¸ Ø±Ø¯ Ø§Ù„Ù…Ø·ÙˆØ±</div>${esc(c.adminReply)}</div>`:''}
      <div class="cmt-acts">
                ${c.approved ? `<button class="btn bsm bgray" onclick="unapproveComment('${c.recipeKey}', '${c.key}')">â†©ï¸ Ø¥Ù„ØºØ§Ø¡ Ù‚Ø¨ÙˆÙ„</button>` : `<button class="btn bsm bg" onclick="approveComment('${c.recipeKey}', '${c.key}')">âœ… Ù‚Ø¨ÙˆÙ„</button>`}
                <button class="btn bsm bpu" onclick="openReply('${c.recipeKey}', '${c.key}')">â†©ï¸ Ø±Ø¯</button>
                <button class="btn bsm bw" onclick="pinComment('${c.recipeKey}', '${c.key}', ${c.pinned})">${c.pinned ? 'ğŸ“Œ Ù…Ø«Ø¨Øª' : 'ğŸ“Œ ØªØ«Ø¨ÙŠØª'}</button>
                <button class="btn bsm bd" onclick="deleteComment('${c.recipeKey}', '${c.key}')">ğŸ—‘ï¸</button>
            </div>
        </div>`;
  }).join('');
}

window.approveComment=async function(rKey,cKey){
  await update(ref(db,'comments/'+rKey+'/'+cKey),{approved:true});
  toast('ØªÙ… Ø§Ù„Ù‚Ø¨ÙˆÙ„ âœ…');
};
window.unapproveComment=async function(rKey,cKey){
  await update(ref(db,'comments/'+rKey+'/'+cKey),{approved:false});
  toast('ØªÙ… Ø¥Ù„ØºØ§Ø¡ Ø§Ù„Ù‚Ø¨ÙˆÙ„');
};
window.deleteComment=function(rKey,cKey){
  confirm2('Ø­Ø°Ù ØªØ¹Ù„ÙŠÙ‚','Ø­Ø°Ù Ù‡Ø°Ø§ Ø§Ù„ØªØ¹Ù„ÙŠÙ‚ØŸ',async()=>{
    await remove(ref(db,'comments/'+rKey+'/'+cKey)); toast('ØªÙ… Ø§Ù„Ø­Ø°Ù');
  });
};
window.pinComment=async function(rKey,cKey,pinned){
  const newVal=!pinned||pinned==='false';
  await update(ref(db,'comments/'+rKey+'/'+cKey),{pinned:newVal});
  toast(newVal?'ğŸ“Œ ØªÙ… Ø§Ù„ØªØ«Ø¨ÙŠØª':'ØªÙ… Ø¥Ù„ØºØ§Ø¡ Ø§Ù„ØªØ«Ø¨ÙŠØª');
};
window.openReply=function(rKey,cKey){
  document.getElementById('replyText').value='';
  document.getElementById('replyOv').classList.add('open');
  document.getElementById('replyOk').onclick=async()=>{
    const txt=document.getElementById('replyText').value.trim();
    if(!txt){toast('Ø£ÙƒØªØ¨ Ø±Ø¯Ùƒ','terr');return;}
    await update(ref(db,'comments/'+rKey+'/'+cKey),{adminReply:txt});
    document.getElementById('replyOv').classList.remove('open');
    toast('ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø±Ø¯ âœ…');
  };
};
window.approveAllComments=async function(){
  const pending=ALL_COMMENTS.filter(c=>!c.approved);
  if(!pending.length){toast('Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ù…Ø¹Ù„Ù‚','twin');return;}
  for(const c of pending){
    try{await update(ref(db,'comments/'+c._recipeKey+'/'+c._key),{approved:true});}catch{}
  }
  toast('ØªÙ… Ù‚Ø¨ÙˆÙ„ '+pending.length+' ØªØ¹Ù„ÙŠÙ‚ âœ…');
};

// â•â•â•â• BANNER â•â•â•â•
document.getElementById('banText').addEventListener('input',previewBanner);
document.getElementById('banType').addEventListener('change',previewBanner);
function previewBanner(){
  const txt=document.getElementById('banText').value;
  const type=document.getElementById('banType').value;
  const colors={info:'#4A90E2',warn:'#ffd565',success:'#43e97b',error:'#f5576c'};
  const el=document.getElementById('banPreview');
  if(txt) el.innerHTML=`<div style="padding:12px 16px;background:rgba(${type==='error'?'245,87,108':type==='warn'?'255,213,101':type==='success'?'67,233,123':'74,144,226'},.15);border:1px solid ${colors[type]};border-radius:8px;color:${colors[type]};font-size:.9em">${esc(txt)}</div>`;
  else el.innerHTML='';
}

window.publishBanner=async function(){
  const txt=document.getElementById('banText').value.trim();
  if(!txt){toast('Ø£ÙƒØªØ¨ Ù†Øµ Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†','terr');return;}
  await update(ref(db,'settings'),{banner:{enabled:true,text:txt,type:document.getElementById('banType').value}});
  toast('ØªÙ… Ù†Ø´Ø± Ø§Ù„Ø¥Ø¹Ù„Ø§Ù† ğŸ“¢'); await logActivity('setting','ğŸ“¢ Ù†Ø´Ø± Ø¥Ø¹Ù„Ø§Ù† Ø¬Ø¯ÙŠØ¯');
};
window.removeBanner=async function(){
  await update(ref(db,'settings'),{banner:{enabled:false,text:'',type:'info'}});
  setEl('banStatus',''); toast('ØªÙ… Ø¥Ù„ØºØ§Ø¡ Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†'); document.getElementById('banText').value='';
  document.getElementById('banPreview').innerHTML='';
};

// â•â•â•â• PROMO CODES â•â•â•â•
window.addPromo=async function(){
  const code=document.getElementById('promoCode').value.trim().toUpperCase();
  if(!code){toast('Ø£Ø¯Ø®Ù„ Ø§Ù„ÙƒÙˆØ¯','terr');return;}
  const data={code,roastery:document.getElementById('promoRoastery').value.trim(),
    desc:document.getElementById('promoDesc').value.trim(),
    expiry:document.getElementById('promoExpiry').value,active:true,ts:Date.now()};
  await push(ref(db,'promo_codes'),data);
  document.getElementById('promoCode').value='';document.getElementById('promoRoastery').value='';
  document.getElementById('promoDesc').value='';document.getElementById('promoExpiry').value='';
  toast('ØªÙ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„ÙƒÙˆØ¯ âœ…');
};
function renderPromos(){
  const el=document.getElementById('promoList');if(!el)return;
  const list=Object.entries(PROMO_CODES);
  if(!list.length){el.innerHTML='<p style="color:var(--t2);text-align:center;padding:16px">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø£ÙƒÙˆØ§Ø¯</p>';return;}
  el.innerHTML=list.map(([k,p])=>`
    <div class="promo-card">
      <div>
        <div class="promo-code">${esc(p.code)}</div>
        <div class="promo-info">${esc(p.roastery||'')} â€¢ ${esc(p.desc||'')}</div>
        ${p.expiry?`<div class="promo-info">ÙŠÙ†ØªÙ‡ÙŠ: ${p.expiry}</div>`:''}
      </div>
      <div style="display:flex;flex-direction:column;gap:6px;align-items:flex-end">
        <label class="tog" style="scale:.75"><input type="checkbox" ${p.active?'checked':''} onchange="togglePromo('${k}',this.checked)"><span class="tog-slider"></span></label>
        <button class="btn bsm bd" onclick="deletePromo('${k}')">ğŸ—‘ï¸</button>
      </div>
    </div>
  `).join('');
}
window.togglePromo=async function(k,val){await update(ref(db,'promo_codes/'+k),{active:val});};
window.deletePromo=function(k){confirm2('Ø­Ø°Ù ÙƒÙˆØ¯','Ø­Ø°Ù Ù‡Ø°Ø§ Ø§Ù„ÙƒÙˆØ¯ØŸ',async()=>{await remove(ref(db,'promo_codes/'+k));toast('ØªÙ… Ø§Ù„Ø­Ø°Ù');});};

// â•â•â•â• ADS â•â•â•â•
window.saveAdsCode=async function(){
  const code=document.getElementById('adsCode').value;
  await update(ref(db,'settings'),{ads_code:code});
  toast('ØªÙ… Ø­ÙØ¸ ÙƒÙˆØ¯ Ø§Ù„Ø¥Ø¹Ù„Ø§Ù† âœ…');
};
window.clearAdsCode=async function(){
  await update(ref(db,'settings'),{ads_code:''});
  document.getElementById('adsCode').value='';
  toast('ØªÙ… Ø­Ø°Ù Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†');
};

// â•â•â•â• TIP JAR â•â•â•â•
window.saveTipJar=async function(){
  const url=document.getElementById('tipJarUrl').value.trim();
  await update(ref(db,'settings'),{tip_jar_url:url});
  toast('ØªÙ… Ø­ÙØ¸ Ø§Ù„Ø±Ø§Ø¨Ø· âœ…');
};

// â•â•â•â• AFFILIATE â•â•â•â•
function populateSelects(){
  const recSel=document.getElementById('affRecipe');
  const featSel=document.getElementById('featTodaySelect');
  if(!recSel||!featSel) return;
  const fbOpts=FB_RECIPES.map(r=>`<option value="${r._fbKey}">${esc(str(r.name)).slice(0,40)}</option>`).join('');
  recSel.innerHTML='<option value="">Ø§Ø®ØªØ± Ø§Ù„ÙˆØµÙØ©</option>'+fbOpts;
  featSel.innerHTML='<option value="">Ø¨Ù„Ø§ Ø§Ø®ØªÙŠØ§Ø±</option>'+FB_RECIPES.map(r=>`<option value="${r.link}" ${FB_SETTINGS?.featured_today===r.link?'selected':''}>${esc(str(r.name)).slice(0,40)}</option>`).join('');
}

window.saveAffiliate=async function(){
  const key=document.getElementById('affRecipe').value;
  const title=document.getElementById('affTitle').value.trim();
  const url=document.getElementById('affUrl').value.trim();
  const price=document.getElementById('affPrice').value.trim();
  if(!key||!title||!url){toast('ÙŠØ±Ø¬Ù‰ Ù…Ù„Ø¡ Ø§Ù„Ø­Ù‚ÙˆÙ„ Ø§Ù„Ø¥Ù„Ø²Ø§Ù…ÙŠØ©','terr');return;}
  await set(ref(db,'affiliate/'+key),{title,url,price,ts:Date.now()});
  toast('ØªÙ… Ø­ÙØ¸ Ø§Ù„Ø±Ø§Ø¨Ø· Ø§Ù„ØªØ§Ø¨Ø¹ âœ…');
};
function renderAffiliates(){
  const el=document.getElementById('affiliateList');if(!el)return;
  const list=Object.entries(AFFILIATE);
  if(!list.length){el.innerHTML='<p style="color:var(--t2);text-align:center;padding:12px">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø±ÙˆØ§Ø¨Ø·</p>';return;}
  el.innerHTML=list.map(([k,a])=>{
    const recipe=FB_RECIPES.find(r=>r._fbKey===k);
    const nm=recipe?str(recipe.name):'ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ';
    return `<div class="aff-card">
      <div class="aff-title">${esc(a.title)} <span style="font-size:.75em;color:var(--t2)">â€” ${esc(nm)}</span></div>
      ${a.price?`<div class="aff-price">${esc(a.price)}</div>`:''}
      <div class="aff-url">${esc(a.url)}</div>
      <div style="margin-top:8px;display:flex;gap:6px">
        <a href="${esc(a.url)}" target="_blank" class="btn bsm bgray">ğŸ”— ÙØªØ­</a>
        <button class="btn bsm bd" onclick="deleteAffiliate('${k}')">ğŸ—‘ï¸</button>
      </div>
    </div>`;
  }).join('');
}
window.deleteAffiliate=function(k){confirm2('Ø­Ø°Ù Ø±Ø§Ø¨Ø·','Ø­Ø°Ù Ù‡Ø°Ø§ Ø§Ù„Ø±Ø§Ø¨Ø· Ø§Ù„ØªØ§Ø¨Ø¹ØŸ',async()=>{await remove(ref(db,'affiliate/'+k));toast('ØªÙ… Ø§Ù„Ø­Ø°Ù');});};

// â•â•â•â• FEATURED TODAY â•â•â•â•
window.setFeaturedToday=async function(){
  const link=document.getElementById('featTodaySelect').value;
  await update(ref(db,'settings'),{featured_today:link});
  const recipe=FB_RECIPES.find(r=>r.link===link);
  setEl('featTodayStatus',link?'â­ ÙˆØµÙØ© Ø§Ù„ÙŠÙˆÙ…: '+(recipe?str(recipe.name):link):'');
  toast('ØªÙ… ØªØ¹ÙŠÙŠÙ† ÙˆØµÙØ© Ø§Ù„ÙŠÙˆÙ… âœ…');
};
window.clearFeaturedToday=async function(){
  await update(ref(db,'settings'),{featured_today:''});
  setEl('featTodayStatus',''); toast('ØªÙ… Ø¥Ù„ØºØ§Ø¡ ÙˆØµÙØ© Ø§Ù„ÙŠÙˆÙ…');
};

// â•â•â•â• SECURITY â•â•â•â•
window.rotatePassword=async function(){
  const np=document.getElementById('newPass').value;
  const cp=document.getElementById('confPass').value;
  if(!np||!cp){toast('Ø£Ø¯Ø®Ù„ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±','terr');return;}
  if(np!==cp){toast('ÙƒÙ„Ù…ØªØ§ Ø§Ù„Ù…Ø±ÙˆØ± Ù„Ø§ ØªØªØ·Ø§Ø¨Ù‚Ø§Ù†','terr');return;}
  if(np.length<6){toast('ÙŠØ¬Ø¨ Ø£Ù† ØªÙƒÙˆÙ† 6 Ø£Ø­Ø±Ù Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„','terr');return;}
  const h=await sha256(np);
  await update(ref(db,'settings'),{authHash:h});
  document.getElementById('newPass').value=''; document.getElementById('confPass').value='';
  toast('ØªÙ… ØªØ­Ø¯ÙŠØ« ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± âœ…');
  await logActivity('setting','ğŸ” ØªØºÙŠÙŠØ± ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±');
};

function renderActivity(){
  const el=document.getElementById('activityLog');if(!el)return;
  if(!FA_ACTIVITY.length){el.innerHTML='<p style="color:var(--t2);text-align:center;padding:20px">Ø§Ù„Ø³Ø¬Ù„ ÙØ§Ø±Øº</p>';return;}
  const icons={add:'act-add',del:'act-del',edit:'act-edit',login:'act-login',setting:'act-setting',approve:'act-approve',reject:'act-del'};
  const emojis={add:'â•',del:'ğŸ—‘ï¸',edit:'âœï¸',login:'ğŸ”',setting:'âš™ï¸',approve:'âœ…',reject:'âŒ'};
  el.innerHTML=FA_ACTIVITY.slice(0,50).map(a=>{
    const cls=icons[a.type]||'act-edit';
    const emoji=emojis[a.type]||'â€¢';
    return `<div class="act-item">
      <div class="act-icon ${cls}">${emoji}</div>
      <div class="act-text">${esc(a.text||'')}</div>
      <div class="act-ts">${relTime(a.ts||0)}</div>
    </div>`;
  }).join('');
}

window.clearActivityLog=function(){
  confirm2('Ù…Ø³Ø­ Ø§Ù„Ø³Ø¬Ù„','Ù…Ø³Ø­ Ø¬Ù…ÙŠØ¹ Ø³Ø¬Ù„Ø§Øª Ø§Ù„Ù†Ø´Ø§Ø·ØŸ',async()=>{
    await set(ref(db,'activity'),null); FA_ACTIVITY=[]; renderActivity(); toast('ØªÙ… Ø§Ù„Ù…Ø³Ø­');
  });
};

// â•â•â•â• TOOLS â•â•â•â•
window.runLinkCheck=async function(){
  const statusEl=document.getElementById('linkCheckStatus');
  const resultsEl=document.getElementById('linkCheckResults');
  const fbLinks=FB_RECIPES.filter(r=>r.link);
  setEl('linkCheckStatus','â³ ÙØ­Øµ '+fbLinks.length+' Ø±Ø§Ø¨Ø·...');
  resultsEl.innerHTML='';
  let ok=0,failed=0;
  const results=[];
  for(const r of fbLinks.slice(0,20)){  // limit to 20 due to CORS
    try{
      const ctrl=new AbortController(); const tid=setTimeout(()=>ctrl.abort(),5000);
      const res=await fetch(r.link,{method:'HEAD',signal:ctrl.signal,mode:'no-cors'}).catch(()=>null);
      clearTimeout(tid);
      const status=res?'âœ…':'âš ï¸';
      if(res) ok++; else failed++;
      results.push(`<div class="lh-item lh-${res?'ok':'err'}">
        <span class="lh-status">${status}</span>
        <span style="flex:1;font-size:.8em;word-break:break-all">${esc(str(r.name))} â€” <a href="${esc(r.link)}" target="_blank" style="color:var(--ta)">ÙØªØ­</a></span>
      </div>`);
    }catch(e){failed++;}
  }
  setEl('linkCheckStatus','Ù†ØªÙŠØ¬Ø© Ø§Ù„ÙØ­Øµ: âœ… '+ok+' Ø³Ù„ÙŠÙ…ØŒ âš ï¸ '+failed+' Ù…Ø´Ø¨ÙˆÙ‡ (Ù…Ù„Ø§Ø­Ø¸Ø©: Ø¨Ø³Ø¨Ø¨ CORS Ø¨Ø¹Ø¶ Ø§Ù„Ù†ØªØ§Ø¦Ø¬ ØªÙ‚Ø¯ÙŠØ±ÙŠØ©)');
  resultsEl.innerHTML=results.join('');
};

window.runValidator=function(){
  const max=parseInt(document.getElementById('maxSize').value)||5000;
  const oversized=FB_RECIPES.filter(r=>JSON.stringify(r).length>max);
  const el=document.getElementById('validatorResults');
  if(!oversized.length){el.innerHTML='<div class="alert alert-info show">âœ… Ø¬Ù…ÙŠØ¹ Ø§Ù„ÙˆØµÙØ§Øª Ø¶Ù…Ù† Ø§Ù„Ø­Ø¬Ù… Ø§Ù„Ù…Ø³Ù…ÙˆØ­ ('+(FB_RECIPES.length)+' ÙˆØµÙØ©)</div>';return;}
  el.innerHTML=`<div class="alert alert-warn show">âš ï¸ ${oversized.length} ÙˆØµÙØ© ØªØªØ¬Ø§ÙˆØ² ${max} Ø¨Ø§ÙŠØª</div>
    ${oversized.map(r=>`<div style="padding:8px 12px;background:var(--up);border-radius:8px;margin-bottom:6px;font-size:.83em;border:1px solid rgba(255,213,101,.3)">
      <strong>${esc(str(r.name))}</strong> â€” ${JSON.stringify(r).length} Ø¨Ø§ÙŠØª
    </div>`).join('')}`;
};

window.cleanupOldPending=function(){
  const old=PENDING.filter(r=>(Date.now()-(r.addedAt||0))>30*86400000);
  if(!old.length){toast('Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ù‚Ø¯ÙŠÙ…');return;}
  confirm2('Ø­Ø°Ù Ø§Ù„Ù‚Ø¯ÙŠÙ…','Ø­Ø°Ù '+old.length+' ÙˆØµÙØ© Ù…Ø¹Ù„Ù‚Ø© Ù‚Ø¯ÙŠÙ…Ø© (Ø£ÙƒØ«Ø± Ù…Ù† 30 ÙŠÙˆÙ…)ØŸ',async()=>{
    for(const r of old){try{await remove(ref(db,'pending/'+r._fbKey));}catch{}}
    toast('ØªÙ… Ø§Ù„Ø­Ø°Ù');
  });
};

window.cleanupHiddenRecipes=function(){
  const hidden=FB_RECIPES.filter(r=>r.hidden);
  if(!hidden.length){toast('Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ù…Ø®ÙÙŠ');return;}
  confirm2('Ø­Ø°Ù Ø§Ù„Ù…Ø®ÙÙŠØ©','Ø­Ø°Ù '+hidden.length+' ÙˆØµÙØ© Ù…Ø®ÙÙŠØ©ØŸ',async()=>{
    for(const r of hidden){try{await remove(ref(db,'recipes/'+r._fbKey));}catch{}}
    toast('ØªÙ… Ø§Ù„Ø­Ø°Ù'); await logActivity('del','ğŸ—‘ï¸ Ø­Ø°Ù Ø§Ù„ÙˆØµÙØ§Øª Ø§Ù„Ù…Ø®ÙÙŠØ©: '+hidden.length);
  });
};

window.cleanupDuplicates=function(){
  const seen=new Map();
  const dups=[];
  FB_RECIPES.forEach(r=>{
    if(seen.has(r.link)) dups.push(r);
    else seen.set(r.link,r);
  });
  const el=document.getElementById('cleanupResults');
  if(!dups.length){el.innerHTML='<div class="alert alert-info show">âœ… Ù„Ø§ ØªÙˆØ¬Ø¯ ØªÙƒØ±Ø§Ø±Ø§Øª ÙÙŠ Firebase</div>';return;}
  el.innerHTML=`<div class="alert alert-warn show">âš ï¸ ${dups.length} ØªÙƒØ±Ø§Ø± Ù…Ø­ØªÙ…Ù„</div>
    ${dups.map(r=>`<div style="padding:8px 12px;background:var(--up);border-radius:8px;margin-bottom:6px;font-size:.83em">${esc(str(r.name))} <button class="btn bsm bd" onclick="confirmDel('${r._fbKey}','${esc(str(r.name))}')">ğŸ—‘ï¸</button></div>`).join('')}`;
};

// â•â•â•â• ADD / EDIT â•â•â•â•
window.resetForm=function(){
  document.getElementById('addForm').reset();
  document.getElementById('rFbKey').value='';
  editingKey=null;
  setEl('addFormTitle','â• Ø¥Ø¶Ø§ÙØ© ÙˆØµÙØ© Ø¬Ø¯ÙŠØ¯Ø©');
  setEl('saveBtn','ğŸ’¾ Ø­ÙØ¸');
};

window.editRec=function(fbKey){
  const r=FB_RECIPES.find(x=>x._fbKey===fbKey);if(!r) return;
  editingKey=fbKey;
  document.getElementById('rFbKey').value=fbKey;
  document.getElementById('rN').value=str(r.name);
  document.getElementById('rA').value=str(r.author);
  document.getElementById('rBr').value=str(r.brewer);
  document.getElementById('rD').value=str(r.dose);
  document.getElementById('rR').value=str(r.ratio);
  document.getElementById('rL').value=str(r.link);
  const cat=r.category||'hot';
  document.getElementById(cat==='cold'?'rCold':cat==='server'?'rSrv':'rHot').checked=true;
  document.getElementById('rFeat').checked=!!r.featured;
  document.getElementById('rSponsored').checked=!!r.sponsored;
  setEl('addFormTitle','âœï¸ ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„ÙˆØµÙØ©');
  setEl('saveBtn','ğŸ’¾ Ø­ÙØ¸ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„');
  switchTab(document.querySelector('[data-tab=tAdd]'),'tAdd');
  window.scrollTo({top:0,behavior:'smooth'});
};

window.saveRec=async function(e){
  e.preventDefault();
  if(!db){toast('Firebase ØºÙŠØ± Ù…ØªØµÙ„!','terr');return;}
  const catSel=document.querySelector('input[name="rc"]:checked');
  if(!catSel){toast('Ø§Ø®ØªØ± Ù†ÙˆØ¹ Ø§Ù„ØªØ­Ø¶ÙŠØ±','terr');return;}
  const r={
    name:document.getElementById('rN').value.trim(),
    author:document.getElementById('rA').value.trim(),
    brewer:document.getElementById('rBr').value,
    dose:document.getElementById('rD').value.trim(),
    ratio:document.getElementById('rR').value.trim(),
    link:document.getElementById('rL').value.trim(),
    category:catSel.value,
    featured:document.getElementById('rFeat').checked,
    sponsored:document.getElementById('rSponsored').checked
  };
  const btn=document.getElementById('saveBtn');
  btn.disabled=true;btn.textContent='â³...';
  try{
    if(editingKey) await set(ref(db,'recipes/'+editingKey),r);
    else {r.addedAt=Date.now();await push(ref(db,'recipes'),r);}
    toast(editingKey?'ØªÙ… Ø§Ù„ØªØ¹Ø¯ÙŠÙ„ âœ…':'ØªÙ…Øª Ø§Ù„Ø¥Ø¶Ø§ÙØ© âœ…');
    await logActivity(editingKey?'edit':'add',(editingKey?'âœï¸ ØªØ¹Ø¯ÙŠÙ„: ':'â• Ø¥Ø¶Ø§ÙØ©: ')+r.name);
    resetForm();
  }catch(err){toast('Ø®Ø·Ø£: '+err.message,'terr');}
  finally{btn.disabled=false;btn.textContent='ğŸ’¾ Ø­ÙØ¸';}
};

window.confirmDel=function(fbKey,name){
  confirm2('Ø­Ø°Ù ÙˆØµÙØ©','Ø­Ø°Ù: '+name+'ØŸ Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø§Ù„ØªØ±Ø§Ø¬Ø¹.',async()=>{
    await remove(ref(db,'recipes/'+fbKey));
    toast('ØªÙ… Ø§Ù„Ø­Ø°Ù âœ…'); await logActivity('del','ğŸ—‘ï¸ Ø­Ø°Ù: '+name);
  });
};

// â•â•â•â• DANGER â•â•â•â•
window.dangerDeleteAll=function(){
  confirm2('âš ï¸ Ø®Ø·Ø±!','Ø­Ø°Ù Ø¬Ù…ÙŠØ¹ ÙˆØµÙØ§Øª FirebaseØŸ Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø§Ù„ØªØ±Ø§Ø¬Ø¹!',async()=>{
    await set(ref(db,'recipes'),null); toast('ØªÙ… Ø§Ù„Ø­Ø°Ù'); await logActivity('del','âš ï¸ Ø­Ø°Ù Ø¬Ù…ÙŠØ¹ ÙˆØµÙØ§Øª Firebase');
  });
};
window.dangerClearPending=function(){
  confirm2('Ù…Ø³Ø­ Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©','Ù…Ø³Ø­ Ø¬Ù…ÙŠØ¹ Ø§Ù„ÙˆØµÙØ§Øª Ø§Ù„Ù…Ø¹Ù„Ù‚Ø©ØŸ',async()=>{
    await set(ref(db,'pending'),null); toast('ØªÙ… Ø§Ù„Ù…Ø³Ø­');
  });
};
window.dangerClearComments=function(){
  confirm2('Ø­Ø°Ù Ø§Ù„ØªØ¹Ù„ÙŠÙ‚Ø§Øª','Ø­Ø°Ù Ø¬Ù…ÙŠØ¹ Ø§Ù„ØªØ¹Ù„ÙŠÙ‚Ø§ØªØŸ',async()=>{
    await set(ref(db,'comments'),null); toast('ØªÙ… Ø§Ù„Ø­Ø°Ù');
  });
};

// â•â•â•â• IMPORT / EXPORT â•â•â•â•
window.doImport=function(event){
  if(!db){toast('Firebase ØºÙŠØ± Ù…ØªØµÙ„!','terr');return;}
  const file=event.target.files[0];if(!file)return;
  const reader=new FileReader();
  reader.onload=async e=>{
    try{
      const wb=XLSX.read(e.target.result,{type:'array'});
      const rows=XLSX.utils.sheet_to_json(wb.Sheets[wb.SheetNames[0]]);
      const valid=rows.filter(r=>r.name&&r.link);
      if(!valid.length){toast('Ù„Ø§ ØµÙÙˆÙ ØµØ§Ù„Ø­Ø©','terr');return;}
      const target=FB_SETTINGS?.require_approval?'pending':'recipes';
      await Promise.all(valid.map(row=>{
        const r={name:str(row.name),author:str(row.author||''),brewer:str(row.brewer||'Other'),
          dose:str(row.dose||''),ratio:str(row.ratio||''),link:str(row.link),category:str(row.category||'hot'),
          affiliate_url:str(row.affiliate_url||''),addedAt:Date.now()};
        ensureCat(r); return push(ref(db,target),r);
      }));
      toast('ØªÙ… Ø§Ø³ØªÙŠØ±Ø§Ø¯ '+valid.length+' ÙˆØµÙØ© âœ…');
      await logActivity('add','ğŸ“¥ Ø§Ø³ØªÙŠØ±Ø§Ø¯ '+valid.length+' ÙˆØµÙØ©');
    }catch(err){toast('Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ù…Ù„Ù','terr');}
    event.target.value='';
  };
  reader.readAsArrayBuffer(file);
};

window.dlTemplate=function(){
  const ws=XLSX.utils.aoa_to_sheet([
    ['name','author','brewer','dose','ratio','link','category','affiliate_url'],
    ['ÙˆØµÙØ© ØªØ¬Ø±ÙŠØ¨ÙŠØ©','Ù…Ø­Ù…Ø¯','Omni','15g','1:15','https://share-h5.xbloom.com/?id=xxx','hot','']
  ]);
  const wb=XLSX.utils.book_new();XLSX.utils.book_append_sheet(wb,ws,'Recipes');
  XLSX.writeFile(wb,'xbloom_template.xlsx');
};
window.expXLS=function(){
  const rows=FB_RECIPES.map(r=>{const {_fbKey,_src,...rest}=r;return rest;});
  const ws=XLSX.utils.json_to_sheet(rows);const wb=XLSX.utils.book_new();
  XLSX.utils.book_append_sheet(wb,ws,'Recipes');XLSX.writeFile(wb,'xbloom_fb_recipes.xlsx');
};
window.expAllXLS=function(){
  const rows=ALL_RECIPES.map(r=>{const {_fbKey,_src,...rest}=r;return rest;});
  const ws=XLSX.utils.json_to_sheet(rows);const wb=XLSX.utils.book_new();
  XLSX.utils.book_append_sheet(wb,ws,'All');XLSX.writeFile(wb,'xbloom_all_recipes.xlsx');
};
window.expJSON=function(){
  const a=document.createElement('a');
  a.href=URL.createObjectURL(new Blob([JSON.stringify(FB_RECIPES,null,2)],{type:'application/json'}));
  a.download='xbloom_recipes.json';a.click();
};
window.expBackup=function(){
  const data={
    timestamp:new Date().toISOString(),
    fb_recipes:FB_RECIPES,ratings:FB_RATINGS,settings:FB_SETTINGS,
    pending:PENDING,promo_codes:PROMO_CODES,affiliate:AFFILIATE
  };
  const a=document.createElement('a');
  a.href=URL.createObjectURL(new Blob([JSON.stringify(data,null,2)],{type:'application/json'}));
  a.download='xbloom_backup_'+new Date().toISOString().slice(0,10)+'.json';a.click();
  toast('ØªÙ… ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù†Ø³Ø®Ø© Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠØ©');
};
</script>
</body>
</html>