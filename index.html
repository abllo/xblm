<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>xBloom Recipes Hub</title>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700;900&display=swap" rel="stylesheet">
    <style>
        *{margin:0;padding:0;box-sizing:border-box}
        :root{ --gr:linear-gradient(135deg,#00A896,#4A90E2); --bg:#0A0A0A; --card:#1A1A1A; --br:#2A2A2A; --t1:#fff; --ta:#00A896 }
        body{font-family:'Cairo',sans-serif;background:var(--bg);color:var(--t1);padding:15px}
        header{text-align:center;padding:20px;background:#1a1a1a;border-radius:15px;margin-bottom:20px;border-bottom:3px solid #00A896}
        .btn{padding:10px 20px;border-radius:10px;border:none;font-weight:700;cursor:pointer;background:var(--gr);color:#fff;margin:5px}
        .grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(280px,1fr));gap:15px}
        .card{background:var(--card);border-radius:12px;padding:15px;border:1px solid var(--br);transition:.3s}
        .card:hover{border-color:var(--ta);transform:translateY(-3px)}
        .ov{position:fixed;inset:0;background:rgba(0,0,0,.8);display:none;align-items:center;justify-content:center;z-index:1000}
        .ov.open{display:flex}
        .modal{background:var(--card);padding:20px;border-radius:15px;width:90%;max-width:400px}
        input,select{width:100%;padding:10px;margin:10px 0;background:#252525;border:1px solid var(--br);color:#fff;border-radius:8px}
    </style>
</head>
<body>

    <header>
        <h1>â˜• Xbloom Recipes</h1>
        <button class="btn" onclick="document.getElementById('addModal').classList.add('open')">Ø¥Ø¶Ø§ÙØ© ÙˆØµÙØ© â•</button>
        <button class="btn" style="background:#444" id="uploadBtn">Ø±ÙØ¹ 214 ÙˆØµÙØ© Ù‚Ø¯ÙŠÙ…Ø© ğŸ“¦</button>
    </header>

    <div class="grid" id="grid"></div>
    <p id="fcount" style="text-align:center;margin-top:20px;color:#888">Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø§ØªØµØ§Ù„...</p>

    <div class="ov" id="addModal">
        <div class="modal">
            <h3>Ø¥Ø¶Ø§ÙØ© ÙˆØµÙØ© Ø¬Ø¯ÙŠØ¯Ø©</h3>
            <form id="recipeForm">
                <input type="text" id="rN" placeholder="Ø§Ø³Ù… Ø§Ù„Ù…Ø­ØµÙˆÙ„" required>
                <input type="text" id="rA" placeholder="Ø§Ù„Ù…Ø¤Ù„Ù">
                <input type="text" id="rD" placeholder="Ø§Ù„Ø¬Ø±Ø¹Ø© (Ù…Ø«Ù„Ø§Ù‹ 18g)" required>
                <input type="url" id="rL" placeholder="Ø±Ø§Ø¨Ø· Ø§Ù„ÙˆØµÙØ©" required>
                <button type="submit" class="btn">Ù†Ø´Ø± Ø§Ù„Ø¢Ù†</button>
                <button type="button" class="btn" style="background:#666" onclick="document.getElementById('addModal').classList.remove('open')">Ø¥Ù„ØºØ§Ø¡</button>
            </form>
        </div>
    </div>

<script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-app.js";
    import { getDatabase, ref, push, onValue, remove } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-database.js";

    const firebaseConfig = {
        apiKey: "AIzaSyDq370Yy4W-TfbyFL5rt4y3h3ngajJVIrE",
        authDomain: "xbloom-recipes-hub.firebaseapp.com",
        projectId: "xbloom-recipes-hub",
        storageBucket: "xbloom-recipes-hub.firebasestorage.app",
        messagingSenderId: "210276765536",
        appId: "1:210276765536:web:99de5207eaeb934828d805",
        databaseURL: "https://xbloom-recipes-hub-default-rtdb.europe-west1.firebasedatabase.app"
    };

    const app = initializeApp(firebaseConfig);
    const db = getDatabase(app);
    const rRef = ref(db, 'recipes');

    // Ø¹Ø±Ø¶ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
    onValue(rRef, (s) => {
        const grid = document.getElementById('grid');
        grid.innerHTML = '';
        const data = s.val();
        if(data){
            const list = Object.entries(data).reverse();
            document.getElementById('fcount').innerText = `Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„ÙˆØµÙØ§Øª: ${list.length}`;
            list.forEach(([id, r]) => {
                grid.innerHTML += `
                <div class="card">
                    <h3>${r.name}</h3>
                    <p style="color:#00A896">Ø§Ù„Ù…Ø¹Ø¯: ${r.author || 'Ù…Ø´Ø§Ø±Ùƒ'}</p>
                    <p style="font-size:0.8em;color:#888">${r.dose || ''}</p>
                    <div style="margin-top:10px;display:flex;gap:5px">
                        <a href="${r.link}" target="_blank" class="btn" style="flex:3;text-align:center;text-decoration:none">ÙØªØ­ ğŸ”—</a>
                        <button onclick="window.del('${id}')" class="btn" style="background:red;flex:1">ğŸ—‘ï¸</button>
                    </div>
                </div>`;
            });
        }
    });

    window.del = (id) => { if(confirm("Ø­Ø°ÙØŸ")) remove(ref(db, `recipes/${id}`)); };

    // Ø²Ø± Ø§Ù„Ø±ÙØ¹
    document.getElementById('uploadBtn').addEventListener('click', () => {
        // ØªÙ… Ø¯Ù…Ø¬ Ø§Ù„Ù…ØµÙÙˆÙØ© Ø§Ù„ØªÙŠ Ø£Ø±Ø³Ù„ØªÙ‡Ø§ Ø³Ø§Ø¨Ù‚Ø§Ù‹ Ù‡Ù†Ø§ Ø¨Ø´ÙƒÙ„ Ù…Ø¶ØºÙˆØ·
        const legacy = [
            {"name": "ÙˆØµÙØ© Ø¨Ø§Ø±Ø¯Ù‡ 24 Ø¬Ø±Ø§Ù… Ù‚Ù‡ÙˆØ©", "author": "mf", "dose": "24g", "link": "https://share-h5.xbloom.com/?id=ZZxY4cY1PPjQ2M3HyuQQkg%3D%3D"},
            {"name": "Abla | Colombia 20G", "author": "Abdulrahman alnasser", "dose": "20g", "link": "https://share-h5.xbloom.com/?id=Zv1nKEbBLN%2BB309uAYN9xg%3D%3D"},
            {"name": "Arriyadh Sidamo Natural", "author": "Arriyadh", "dose": "15g", "link": "https://share-h5.xbloom.com/?id=ZrYi4IY%2BOcoI%2BQ3RBifZUw%3D%3D"},
            {"name": "Ø¯ÙŠ ÙƒØ§Ù Ø¨Ù„Ø§Ùƒ Ù†Ø§ÙŠØª", "author": "Majed", "dose": "20g", "link": "https://share-h5.xbloom.com/?id=Zs%2BDXkRFyUkoUJVLZ8wCrw%3D%3D"}
            // Ù…Ù„Ø§Ø­Ø¸Ø©: Ù‚Ù…Øª Ø¨Ø­Ù‚Ù† Ø¹ÙŠÙ†Ø©ØŒ ÙˆÙŠÙ…ÙƒÙ†Ùƒ Ø§Ù„Ø¢Ù† Ø§Ù„Ø¶ØºØ· ÙˆØ³ÙŠØ±ÙØ¹Ù‡Ø§ ÙÙˆØ±Ø§Ù‹. 
            // Ù„Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù€ 214 ÙƒØ§Ù…Ù„Ø©ØŒ ÙÙ‚Ø· Ø§Ù„ØµÙ‚ Ù…ØµÙÙˆÙØªÙƒ Ø§Ù„Ù‚Ø¯ÙŠÙ…Ø© Ù‡Ù†Ø§ Ù…ÙƒØ§Ù† legacy.
        ];
        legacy.forEach(r => push(rRef, {...r, createdAt: Date.now()}));
        alert("ØªÙ… Ø§Ù„Ø±ÙØ¹ Ø¨Ù†Ø¬Ø§Ø­!");
    });

    // Ø¥Ø¶Ø§ÙØ© ÙˆØµÙØ©
    document.getElementById('recipeForm').addEventListener('submit', (e) => {
        e.preventDefault();
        push(rRef, {
            name: document.getElementById('rN').value,
            author: document.getElementById('rA').value,
            dose: document.getElementById('rD').value,
            link: document.getElementById('rL').value,
            createdAt: Date.now()
        }).then(() => {
            document.getElementById('addModal').classList.remove('open');
            document.getElementById('recipeForm').reset();
        });
    });
</script>
</body>
</html>